2022-05-23 05:20:11 - loading data from datasets/KMNIST_3000/train.json
  0%|          | 0/57000 [00:00<?, ?it/s]  1%|          | 297/57000 [00:00<00:19, 2968.59it/s]  1%|          | 596/57000 [00:00<00:18, 2977.06it/s]  2%|▏         | 895/57000 [00:00<00:18, 2981.24it/s]  2%|▏         | 1194/57000 [00:00<00:18, 2981.05it/s]  3%|▎         | 1494/57000 [00:00<00:18, 2984.68it/s]  3%|▎         | 1793/57000 [00:00<00:18, 2978.61it/s]  4%|▎         | 2092/57000 [00:00<00:18, 2981.48it/s]  4%|▍         | 2391/57000 [00:00<00:18, 2981.20it/s]  5%|▍         | 2691/57000 [00:00<00:18, 2984.70it/s]  5%|▌         | 2991/57000 [00:01<00:18, 2986.86it/s]  6%|▌         | 3290/57000 [00:01<00:17, 2985.20it/s]  6%|▋         | 3589/57000 [00:01<00:17, 2983.85it/s]  7%|▋         | 3888/57000 [00:01<00:17, 2985.65it/s]  7%|▋         | 4188/57000 [00:01<00:17, 2988.93it/s]  8%|▊         | 4487/57000 [00:01<00:17, 2987.69it/s]  8%|▊         | 4787/57000 [00:01<00:17, 2989.17it/s]  9%|▉         | 5086/57000 [00:01<00:17, 2988.27it/s]  9%|▉         | 5386/57000 [00:01<00:17, 2989.24it/s] 10%|▉         | 5686/57000 [00:01<00:17, 2989.61it/s] 10%|█         | 5985/57000 [00:02<00:17, 2987.69it/s] 11%|█         | 6284/57000 [00:02<00:16, 2988.07it/s] 12%|█▏        | 6583/57000 [00:02<00:16, 2988.45it/s] 12%|█▏        | 6882/57000 [00:02<00:16, 2987.49it/s] 13%|█▎        | 7182/57000 [00:02<00:16, 2990.40it/s] 13%|█▎        | 7482/57000 [00:02<00:16, 2985.85it/s] 14%|█▎        | 7782/57000 [00:02<00:16, 2987.74it/s] 14%|█▍        | 8081/57000 [00:02<00:16, 2985.99it/s] 15%|█▍        | 8381/57000 [00:02<00:16, 2987.42it/s] 15%|█▌        | 8680/57000 [00:02<00:16, 2987.63it/s] 16%|█▌        | 8979/57000 [00:03<00:16, 2987.07it/s] 16%|█▋        | 9278/57000 [00:03<00:15, 2987.65it/s] 17%|█▋        | 9577/57000 [00:03<00:15, 2986.22it/s] 17%|█▋        | 9877/57000 [00:03<00:15, 2987.40it/s] 18%|█▊        | 10177/57000 [00:03<00:15, 2989.41it/s] 18%|█▊        | 10477/57000 [00:03<00:15, 2990.39it/s] 19%|█▉        | 10777/57000 [00:03<00:15, 2990.80it/s] 19%|█▉        | 11077/57000 [00:03<00:15, 2990.27it/s] 20%|█▉        | 11377/57000 [00:03<00:15, 2990.59it/s] 20%|██        | 11677/57000 [00:03<00:15, 2992.54it/s] 21%|██        | 11977/57000 [00:04<00:15, 2988.13it/s] 22%|██▏       | 12278/57000 [00:04<00:14, 2991.72it/s] 22%|██▏       | 12578/57000 [00:04<00:14, 2988.90it/s] 23%|██▎       | 12879/57000 [00:04<00:14, 2993.55it/s] 23%|██▎       | 13179/57000 [00:04<00:14, 2995.35it/s] 24%|██▎       | 13479/57000 [00:04<00:14, 2994.83it/s] 24%|██▍       | 13779/57000 [00:04<00:14, 2995.71it/s] 25%|██▍       | 14079/57000 [00:04<00:14, 2992.16it/s] 25%|██▌       | 14379/57000 [00:04<00:14, 2994.41it/s] 26%|██▌       | 14679/57000 [00:04<00:14, 2995.11it/s] 26%|██▋       | 14979/57000 [00:05<00:14, 2994.05it/s] 27%|██▋       | 15279/57000 [00:05<00:13, 2994.69it/s] 27%|██▋       | 15579/57000 [00:05<00:13, 2994.29it/s] 28%|██▊       | 15879/57000 [00:05<00:13, 2990.13it/s] 28%|██▊       | 16179/57000 [00:05<00:13, 2989.78it/s] 29%|██▉       | 16478/57000 [00:05<00:13, 2984.78it/s] 29%|██▉       | 16777/57000 [00:05<00:13, 2985.79it/s] 30%|██▉       | 17076/57000 [00:05<00:13, 2982.69it/s] 30%|███       | 17375/57000 [00:05<00:13, 2983.59it/s] 31%|███       | 17674/57000 [00:05<00:13, 2979.51it/s] 32%|███▏      | 17974/57000 [00:06<00:13, 2983.50it/s] 32%|███▏      | 18273/57000 [00:06<00:12, 2984.01it/s] 33%|███▎      | 18572/57000 [00:06<00:12, 2984.29it/s] 33%|███▎      | 18871/57000 [00:06<00:12, 2984.12it/s] 34%|███▎      | 19170/57000 [00:06<00:12, 2984.61it/s] 34%|███▍      | 19469/57000 [00:06<00:12, 2985.43it/s] 35%|███▍      | 19768/57000 [00:06<00:12, 2981.51it/s] 35%|███▌      | 20067/57000 [00:06<00:12, 2982.28it/s] 36%|███▌      | 20367/57000 [00:06<00:12, 2984.83it/s] 36%|███▋      | 20666/57000 [00:06<00:12, 2982.89it/s] 37%|███▋      | 20966/57000 [00:07<00:12, 2985.20it/s] 37%|███▋      | 21266/57000 [00:07<00:11, 2986.56it/s] 38%|███▊      | 21565/57000 [00:07<00:11, 2986.71it/s] 38%|███▊      | 21865/57000 [00:07<00:11, 2988.39it/s] 39%|███▉      | 22164/57000 [00:07<00:11, 2985.83it/s] 39%|███▉      | 22463/57000 [00:07<00:11, 2984.17it/s] 40%|███▉      | 22762/57000 [00:07<00:11, 2984.98it/s] 40%|████      | 23061/57000 [00:07<00:11, 2984.12it/s] 41%|████      | 23360/57000 [00:07<00:11, 2983.58it/s] 42%|████▏     | 23659/57000 [00:07<00:11, 2984.44it/s] 42%|████▏     | 23958/57000 [00:08<00:11, 2984.38it/s] 43%|████▎     | 24257/57000 [00:08<00:10, 2984.57it/s] 43%|████▎     | 24556/57000 [00:08<00:10, 2984.69it/s] 44%|████▎     | 24855/57000 [00:08<00:10, 2985.94it/s] 44%|████▍     | 25154/57000 [00:08<00:10, 2975.64it/s] 45%|████▍     | 25454/57000 [00:08<00:10, 2981.29it/s] 45%|████▌     | 25753/57000 [00:08<00:10, 2982.84it/s] 46%|████▌     | 26052/57000 [00:08<00:10, 2984.02it/s] 46%|████▌     | 26351/57000 [00:08<00:10, 2985.57it/s] 47%|████▋     | 26650/57000 [00:08<00:10, 2984.81it/s] 47%|████▋     | 26949/57000 [00:09<00:10, 2985.25it/s] 48%|████▊     | 27248/57000 [00:09<00:09, 2983.31it/s] 48%|████▊     | 27547/57000 [00:09<00:09, 2983.76it/s] 49%|████▉     | 27846/57000 [00:09<00:09, 2984.16it/s] 49%|████▉     | 28145/57000 [00:09<00:09, 2983.99it/s] 50%|████▉     | 28444/57000 [00:09<00:09, 2981.17it/s] 50%|█████     | 28743/57000 [00:09<00:09, 2983.77it/s] 51%|█████     | 29042/57000 [00:09<00:09, 2983.63it/s] 51%|█████▏    | 29341/57000 [00:09<00:09, 2984.70it/s] 52%|█████▏    | 29640/57000 [00:09<00:09, 2980.82it/s] 53%|█████▎    | 29939/57000 [00:10<00:09, 2981.20it/s] 53%|█████▎    | 30238/57000 [00:10<00:08, 2982.31it/s] 54%|█████▎    | 30537/57000 [00:10<00:08, 2984.37it/s] 54%|█████▍    | 30836/57000 [00:10<00:08, 2981.51it/s] 55%|█████▍    | 31135/57000 [00:10<00:08, 2981.29it/s] 55%|█████▌    | 31434/57000 [00:10<00:08, 2982.92it/s] 56%|█████▌    | 31733/57000 [00:10<00:08, 2978.85it/s] 56%|█████▌    | 32032/57000 [00:10<00:08, 2981.60it/s] 57%|█████▋    | 32332/57000 [00:10<00:08, 2984.87it/s] 57%|█████▋    | 32631/57000 [00:10<00:08, 2985.22it/s] 58%|█████▊    | 32930/57000 [00:11<00:08, 2985.68it/s] 58%|█████▊    | 33229/57000 [00:11<00:07, 2981.44it/s] 59%|█████▉    | 33528/57000 [00:11<00:07, 2982.24it/s] 59%|█████▉    | 33827/57000 [00:11<00:07, 2981.13it/s] 60%|█████▉    | 34127/57000 [00:11<00:07, 2984.50it/s] 60%|██████    | 34426/57000 [00:11<00:07, 2984.47it/s] 61%|██████    | 34725/57000 [00:11<00:07, 2983.44it/s] 61%|██████▏   | 35024/57000 [00:11<00:07, 2982.46it/s] 62%|██████▏   | 35323/57000 [00:11<00:07, 2981.85it/s] 62%|██████▏   | 35622/57000 [00:11<00:07, 2982.74it/s] 63%|██████▎   | 35921/57000 [00:12<00:07, 2978.14it/s] 64%|██████▎   | 36220/57000 [00:12<00:06, 2979.67it/s] 64%|██████▍   | 36520/57000 [00:12<00:06, 2983.92it/s] 65%|██████▍   | 36819/57000 [00:12<00:06, 2982.39it/s] 65%|██████▌   | 37118/57000 [00:12<00:06, 2982.68it/s] 66%|██████▌   | 37418/57000 [00:12<00:06, 2985.36it/s] 66%|██████▌   | 37717/57000 [00:12<00:06, 2985.31it/s] 67%|██████▋   | 38016/57000 [00:12<00:06, 2984.82it/s] 67%|██████▋   | 38315/57000 [00:12<00:06, 2983.80it/s] 68%|██████▊   | 38614/57000 [00:12<00:06, 2983.48it/s] 68%|██████▊   | 38913/57000 [00:13<00:06, 2983.50it/s] 69%|██████▉   | 39213/57000 [00:13<00:05, 2985.52it/s] 69%|██████▉   | 39512/57000 [00:13<00:05, 2984.92it/s] 70%|██████▉   | 39811/57000 [00:13<00:05, 2985.43it/s] 70%|███████   | 40110/57000 [00:13<00:05, 2985.39it/s] 71%|███████   | 40409/57000 [00:13<00:05, 2980.53it/s] 71%|███████▏  | 40709/57000 [00:13<00:05, 2984.31it/s] 72%|███████▏  | 41009/57000 [00:13<00:05, 2986.29it/s] 72%|███████▏  | 41308/57000 [00:13<00:05, 2985.36it/s] 73%|███████▎  | 41608/57000 [00:13<00:05, 2987.40it/s] 74%|███████▎  | 41907/57000 [00:14<00:05, 2986.06it/s] 74%|███████▍  | 42206/57000 [00:14<00:04, 2986.95it/s] 75%|███████▍  | 42505/57000 [00:14<00:04, 2985.81it/s] 75%|███████▌  | 42804/57000 [00:14<00:04, 2980.69it/s] 76%|███████▌  | 43104/57000 [00:14<00:04, 2983.66it/s] 76%|███████▌  | 43403/57000 [00:14<00:04, 2983.45it/s] 77%|███████▋  | 43702/57000 [00:14<00:04, 2984.01it/s] 77%|███████▋  | 44001/57000 [00:14<00:04, 2983.23it/s] 78%|███████▊  | 44300/57000 [00:14<00:04, 2982.50it/s] 78%|███████▊  | 44599/57000 [00:14<00:04, 2982.73it/s] 79%|███████▉  | 44898/57000 [00:15<00:04, 2984.12it/s] 79%|███████▉  | 45197/57000 [00:15<00:03, 2976.30it/s] 80%|███████▉  | 45497/57000 [00:15<00:03, 2981.97it/s] 80%|████████  | 45797/57000 [00:15<00:03, 2985.28it/s] 81%|████████  | 46097/57000 [00:15<00:03, 2988.85it/s] 81%|████████▏ | 46396/57000 [00:15<00:03, 2987.47it/s] 82%|████████▏ | 46696/57000 [00:15<00:03, 2989.50it/s] 82%|████████▏ | 46995/57000 [00:15<00:03, 2985.93it/s] 83%|████████▎ | 47294/57000 [00:15<00:03, 2984.53it/s] 83%|████████▎ | 47593/57000 [00:15<00:03, 2984.34it/s] 84%|████████▍ | 47892/57000 [00:16<00:03, 2985.11it/s] 85%|████████▍ | 48191/57000 [00:16<00:02, 2985.88it/s] 85%|████████▌ | 48490/57000 [00:16<00:02, 2981.75it/s] 86%|████████▌ | 48789/57000 [00:16<00:02, 2983.26it/s] 86%|████████▌ | 49089/57000 [00:16<00:02, 2985.31it/s] 87%|████████▋ | 49388/57000 [00:16<00:02, 2983.83it/s] 87%|████████▋ | 49687/57000 [00:16<00:02, 2984.62it/s] 88%|████████▊ | 49986/57000 [00:16<00:02, 2982.49it/s] 88%|████████▊ | 50285/57000 [00:16<00:02, 2983.61it/s] 89%|████████▊ | 50585/57000 [00:16<00:02, 2985.54it/s] 89%|████████▉ | 50884/57000 [00:17<00:02, 2975.07it/s] 90%|████████▉ | 51184/57000 [00:17<00:01, 2980.38it/s] 90%|█████████ | 51483/57000 [00:17<00:01, 2982.58it/s] 91%|█████████ | 51784/57000 [00:17<00:01, 2988.14it/s] 91%|█████████▏| 52083/57000 [00:17<00:01, 2986.71it/s] 92%|█████████▏| 52383/57000 [00:17<00:01, 2987.74it/s] 92%|█████████▏| 52682/57000 [00:17<00:01, 2987.66it/s] 93%|█████████▎| 52981/57000 [00:17<00:01, 2985.07it/s] 93%|█████████▎| 53280/57000 [00:17<00:01, 2985.64it/s] 94%|█████████▍| 53579/57000 [00:17<00:01, 2986.23it/s] 95%|█████████▍| 53878/57000 [00:18<00:01, 2985.03it/s] 95%|█████████▌| 54177/57000 [00:18<00:00, 2985.93it/s] 96%|█████████▌| 54476/57000 [00:18<00:00, 2983.11it/s] 96%|█████████▌| 54776/57000 [00:18<00:00, 2985.15it/s] 97%|█████████▋| 55075/57000 [00:18<00:00, 2984.70it/s] 97%|█████████▋| 55374/57000 [00:18<00:00, 2984.53it/s] 98%|█████████▊| 55673/57000 [00:18<00:00, 2985.83it/s] 98%|█████████▊| 55972/57000 [00:18<00:00, 2985.21it/s] 99%|█████████▊| 56271/57000 [00:18<00:00, 2986.46it/s] 99%|█████████▉| 56570/57000 [00:18<00:00, 2984.71it/s]100%|█████████▉| 56869/57000 [00:19<00:00, 2984.83it/s]100%|██████████| 57000/57000 [00:19<00:00, 2985.17it/s]
2022-05-23 05:20:30 - loading data from datasets/KMNIST_3000/valid.json
  0%|          | 0/3000 [00:00<?, ?it/s] 10%|▉         | 298/3000 [00:00<00:00, 2975.04it/s] 20%|█▉        | 598/3000 [00:00<00:00, 2986.63it/s] 30%|██▉       | 898/3000 [00:00<00:00, 2989.61it/s] 40%|███▉      | 1197/3000 [00:00<00:00, 2980.14it/s] 50%|████▉     | 1497/3000 [00:00<00:00, 2984.91it/s] 60%|█████▉    | 1796/3000 [00:00<00:00, 2984.57it/s] 70%|██████▉   | 2095/3000 [00:00<00:00, 2982.77it/s] 80%|███████▉  | 2394/3000 [00:00<00:00, 2980.77it/s] 90%|████████▉ | 2693/3000 [00:00<00:00, 2978.33it/s]100%|█████████▉| 2991/3000 [00:01<00:00, 2975.10it/s]100%|██████████| 3000/3000 [00:01<00:00, 2979.64it/s]
2022-05-23 05:20:31 - loading data from datasets/KMNIST_3000/test.json
  0%|          | 0/10000 [00:00<?, ?it/s]  3%|▎         | 297/10000 [00:00<00:03, 2967.65it/s]  6%|▌         | 595/10000 [00:00<00:03, 2973.90it/s]  9%|▉         | 894/10000 [00:00<00:03, 2976.93it/s] 12%|█▏        | 1193/10000 [00:00<00:02, 2979.82it/s] 15%|█▍        | 1491/10000 [00:00<00:02, 2979.33it/s] 18%|█▊        | 1790/10000 [00:00<00:02, 2980.30it/s] 21%|██        | 2089/10000 [00:00<00:02, 2973.11it/s] 24%|██▍       | 2387/10000 [00:00<00:02, 2973.71it/s] 27%|██▋       | 2685/10000 [00:00<00:02, 2975.17it/s] 30%|██▉       | 2983/10000 [00:01<00:02, 2973.96it/s] 33%|███▎      | 3281/10000 [00:01<00:02, 2972.38it/s] 36%|███▌      | 3579/10000 [00:01<00:02, 2972.41it/s] 39%|███▉      | 3877/10000 [00:01<00:02, 2971.83it/s] 42%|████▏     | 4175/10000 [00:01<00:01, 2969.32it/s] 45%|████▍     | 4472/10000 [00:01<00:01, 2965.64it/s] 48%|████▊     | 4770/10000 [00:01<00:01, 2966.01it/s] 51%|█████     | 5067/10000 [00:01<00:01, 2965.51it/s] 54%|█████▎    | 5365/10000 [00:01<00:01, 2966.98it/s] 57%|█████▋    | 5664/10000 [00:01<00:01, 2971.23it/s] 60%|█████▉    | 5962/10000 [00:02<00:01, 2973.05it/s] 63%|██████▎   | 6260/10000 [00:02<00:01, 2975.09it/s] 66%|██████▌   | 6558/10000 [00:02<00:01, 2975.28it/s] 69%|██████▊   | 6856/10000 [00:02<00:01, 2975.08it/s] 72%|███████▏  | 7154/10000 [00:02<00:00, 2976.13it/s] 75%|███████▍  | 7453/10000 [00:02<00:00, 2977.83it/s] 78%|███████▊  | 7751/10000 [00:02<00:00, 2976.65it/s] 80%|████████  | 8049/10000 [00:02<00:00, 2970.09it/s] 83%|████████▎ | 8348/10000 [00:02<00:00, 2973.40it/s] 86%|████████▋ | 8646/10000 [00:02<00:00, 2974.39it/s] 89%|████████▉ | 8944/10000 [00:03<00:00, 2976.03it/s] 92%|█████████▏| 9242/10000 [00:03<00:00, 2976.57it/s] 95%|█████████▌| 9541/10000 [00:03<00:00, 2978.04it/s] 98%|█████████▊| 9840/10000 [00:03<00:00, 2979.25it/s]100%|██████████| 10000/10000 [00:03<00:00, 2974.10it/s]
2022-05-23 05:21:35 - Using LF classes: [functools.partial(<class 'sklearn.tree._classes.DecisionTreeClassifier'>, max_depth=1), <class 'sklearn.linear_model._logistic.LogisticRegression'>]
Fitting MulticlassAdaptor... Class 0
  0%|          | 0/23 [00:00<?, ?it/s]  0%|          | 0/23 [59:10<?, ?it/s]
Traceback (most recent call last):
  File "fwrench/applications/kmnist.py", line 213, in <module>
    fire.Fire(main)
  File "/home/ubuntu/anaconda3/envs/FWRENCH/lib/python3.7/site-packages/fire/core.py", line 141, in Fire
    component_trace = _Fire(component, args, parsed_flag_args, context, name)
  File "/home/ubuntu/anaconda3/envs/FWRENCH/lib/python3.7/site-packages/fire/core.py", line 471, in _Fire
    target=component.__name__)
  File "/home/ubuntu/anaconda3/envs/FWRENCH/lib/python3.7/site-packages/fire/core.py", line 681, in _CallAndUpdateTrace
    component = fn(*varargs, **kwargs)
  File "fwrench/applications/kmnist.py", line 157, in main
    selector.fit(valid_data_embed, train_data_embed)
  File "/home/ubuntu/FWRENCH/fwrench/utils/utils.py", line 132, in fit
    self.lf_selectors[i].fit(labeled_data_i, unlabeled_data_i)
  File "/home/ubuntu/FWRENCH/fwrench/lf_selectors/snuba_lf_selector.py", line 57, in fit
    model=self.lf_generator, scoring_fn=self.scoring_fn)
  File "/home/ubuntu/FWRENCH/fwrench/lf_selectors/snuba/heuristic_generator.py", line 152, in run_synthesizer
    scoring_fn=scoring_fn)
  File "/home/ubuntu/FWRENCH/fwrench/lf_selectors/snuba/heuristic_generator.py", line 81, in prune_heuristics
    L_temp_train = self.apply_heuristics(heuristics[i], self.train_primitive_matrix, feat_combos[i], beta_opt_temp) 
  File "/home/ubuntu/FWRENCH/fwrench/lf_selectors/snuba/heuristic_generator.py", line 53, in apply_heuristics
    L = np.zeros((np.shape(primitive_matrix)[0],len(heuristics)))
numpy.core._exceptions.MemoryError: Unable to allocate 111. GiB for an array with shape (57000, 261632) and data type float64
