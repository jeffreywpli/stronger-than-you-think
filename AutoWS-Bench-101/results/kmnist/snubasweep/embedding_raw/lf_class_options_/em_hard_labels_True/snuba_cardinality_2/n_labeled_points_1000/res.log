2022-05-22 10:18:05 - loading data from datasets/KMNIST_3000/train.json
  0%|          | 0/57000 [00:00<?, ?it/s]  1%|          | 291/57000 [00:00<00:19, 2904.41it/s]  1%|          | 582/57000 [00:00<00:19, 2907.18it/s]  2%|▏         | 875/57000 [00:00<00:19, 2913.13it/s]  2%|▏         | 1167/57000 [00:00<00:19, 2913.52it/s]  3%|▎         | 1460/57000 [00:00<00:19, 2919.18it/s]  3%|▎         | 1753/57000 [00:00<00:18, 2919.52it/s]  4%|▎         | 2047/57000 [00:00<00:18, 2922.97it/s]  4%|▍         | 2340/57000 [00:00<00:18, 2923.39it/s]  5%|▍         | 2633/57000 [00:00<00:18, 2925.20it/s]  5%|▌         | 2927/57000 [00:01<00:18, 2927.64it/s]  6%|▌         | 3220/57000 [00:01<00:18, 2922.54it/s]  6%|▌         | 3513/57000 [00:01<00:18, 2921.55it/s]  7%|▋         | 3806/57000 [00:01<00:18, 2914.84it/s]  7%|▋         | 4098/57000 [00:01<00:18, 2907.52it/s]  8%|▊         | 4390/57000 [00:01<00:18, 2908.30it/s]  8%|▊         | 4681/57000 [00:01<00:17, 2906.64it/s]  9%|▊         | 4974/57000 [00:01<00:17, 2911.30it/s]  9%|▉         | 5266/57000 [00:01<00:17, 2911.03it/s] 10%|▉         | 5558/57000 [00:01<00:17, 2913.16it/s] 10%|█         | 5850/57000 [00:02<00:17, 2914.46it/s] 11%|█         | 6142/57000 [00:02<00:17, 2911.75it/s] 11%|█▏        | 6434/57000 [00:02<00:17, 2913.31it/s] 12%|█▏        | 6726/57000 [00:02<00:17, 2915.01it/s] 12%|█▏        | 7018/57000 [00:02<00:17, 2914.11it/s] 13%|█▎        | 7310/57000 [00:02<00:17, 2911.50it/s] 13%|█▎        | 7602/57000 [00:02<00:17, 2902.97it/s] 14%|█▍        | 7894/57000 [00:02<00:16, 2905.45it/s] 14%|█▍        | 8185/57000 [00:02<00:16, 2906.37it/s] 15%|█▍        | 8477/57000 [00:02<00:16, 2908.51it/s] 15%|█▌        | 8770/57000 [00:03<00:16, 2913.86it/s] 16%|█▌        | 9062/57000 [00:03<00:16, 2912.55it/s] 16%|█▋        | 9355/57000 [00:03<00:16, 2915.96it/s] 17%|█▋        | 9647/57000 [00:03<00:16, 2908.38it/s] 17%|█▋        | 9938/57000 [00:03<00:16, 2904.61it/s] 18%|█▊        | 10229/57000 [00:03<00:16, 2905.29it/s] 18%|█▊        | 10521/57000 [00:03<00:15, 2907.20it/s] 19%|█▉        | 10814/57000 [00:03<00:15, 2911.09it/s] 19%|█▉        | 11106/57000 [00:03<00:15, 2912.16it/s] 20%|█▉        | 11399/57000 [00:03<00:15, 2914.63it/s] 21%|██        | 11692/57000 [00:04<00:15, 2919.09it/s] 21%|██        | 11984/57000 [00:04<00:15, 2917.47it/s] 22%|██▏       | 12277/57000 [00:04<00:15, 2921.00it/s] 22%|██▏       | 12570/57000 [00:04<00:15, 2916.96it/s] 23%|██▎       | 12862/57000 [00:04<00:15, 2914.95it/s] 23%|██▎       | 13154/57000 [00:04<00:15, 2914.77it/s] 24%|██▎       | 13446/57000 [00:04<00:14, 2914.14it/s] 24%|██▍       | 13739/57000 [00:04<00:14, 2915.90it/s] 25%|██▍       | 14031/57000 [00:04<00:14, 2914.04it/s] 25%|██▌       | 14325/57000 [00:04<00:14, 2919.77it/s] 26%|██▌       | 14618/57000 [00:05<00:14, 2922.63it/s] 26%|██▌       | 14911/57000 [00:05<00:14, 2920.07it/s] 27%|██▋       | 15206/57000 [00:05<00:14, 2928.96it/s] 27%|██▋       | 15505/57000 [00:05<00:14, 2944.37it/s] 28%|██▊       | 15804/57000 [00:05<00:13, 2956.27it/s] 28%|██▊       | 16104/57000 [00:05<00:13, 2966.52it/s] 29%|██▉       | 16403/57000 [00:05<00:13, 2971.68it/s] 29%|██▉       | 16702/57000 [00:05<00:13, 2974.84it/s] 30%|██▉       | 17001/57000 [00:05<00:13, 2978.10it/s] 30%|███       | 17301/57000 [00:05<00:13, 2984.24it/s] 31%|███       | 17600/57000 [00:06<00:13, 2984.44it/s] 31%|███▏      | 17899/57000 [00:06<00:13, 2985.90it/s] 32%|███▏      | 18199/57000 [00:06<00:12, 2987.66it/s] 32%|███▏      | 18498/57000 [00:06<00:12, 2987.73it/s] 33%|███▎      | 18797/57000 [00:06<00:12, 2983.88it/s] 34%|███▎      | 19096/57000 [00:06<00:12, 2982.77it/s] 34%|███▍      | 19395/57000 [00:06<00:12, 2983.96it/s] 35%|███▍      | 19695/57000 [00:06<00:12, 2985.96it/s] 35%|███▌      | 19994/57000 [00:06<00:12, 2982.65it/s] 36%|███▌      | 20294/57000 [00:06<00:12, 2986.62it/s] 36%|███▌      | 20594/57000 [00:07<00:12, 2989.91it/s] 37%|███▋      | 20894/57000 [00:07<00:12, 2990.19it/s] 37%|███▋      | 21194/57000 [00:07<00:11, 2987.12it/s] 38%|███▊      | 21493/57000 [00:07<00:11, 2986.76it/s] 38%|███▊      | 21792/57000 [00:07<00:11, 2986.48it/s] 39%|███▉      | 22091/57000 [00:07<00:11, 2986.31it/s] 39%|███▉      | 22390/57000 [00:07<00:11, 2984.55it/s] 40%|███▉      | 22690/57000 [00:07<00:11, 2989.04it/s] 40%|████      | 22990/57000 [00:07<00:11, 2989.32it/s] 41%|████      | 23290/57000 [00:07<00:11, 2990.75it/s] 41%|████▏     | 23590/57000 [00:08<00:11, 2992.94it/s] 42%|████▏     | 23890/57000 [00:08<00:11, 2993.90it/s] 42%|████▏     | 24191/57000 [00:08<00:10, 2996.12it/s] 43%|████▎     | 24491/57000 [00:08<00:10, 2994.72it/s] 43%|████▎     | 24791/57000 [00:08<00:10, 2995.74it/s] 44%|████▍     | 25091/57000 [00:08<00:10, 2986.20it/s] 45%|████▍     | 25391/57000 [00:08<00:10, 2987.76it/s] 45%|████▌     | 25690/57000 [00:08<00:10, 2986.47it/s] 46%|████▌     | 25990/57000 [00:08<00:10, 2988.31it/s] 46%|████▌     | 26290/57000 [00:08<00:10, 2991.31it/s] 47%|████▋     | 26590/57000 [00:09<00:10, 2990.37it/s] 47%|████▋     | 26890/57000 [00:09<00:10, 2991.53it/s] 48%|████▊     | 27190/57000 [00:09<00:09, 2991.27it/s] 48%|████▊     | 27490/57000 [00:09<00:09, 2992.16it/s] 49%|████▉     | 27790/57000 [00:09<00:09, 2993.13it/s] 49%|████▉     | 28090/57000 [00:09<00:09, 2994.98it/s] 50%|████▉     | 28390/57000 [00:09<00:09, 2991.26it/s] 50%|█████     | 28690/57000 [00:09<00:09, 2993.19it/s] 51%|█████     | 28990/57000 [00:09<00:09, 2995.14it/s] 51%|█████▏    | 29291/57000 [00:09<00:09, 2997.01it/s] 52%|█████▏    | 29591/57000 [00:10<00:09, 2986.58it/s] 52%|█████▏    | 29890/57000 [00:10<00:09, 2987.00it/s] 53%|█████▎    | 30190/57000 [00:10<00:08, 2989.28it/s] 53%|█████▎    | 30490/57000 [00:10<00:08, 2990.76it/s] 54%|█████▍    | 30790/57000 [00:10<00:08, 2993.09it/s] 55%|█████▍    | 31090/57000 [00:10<00:08, 2986.77it/s] 55%|█████▌    | 31390/57000 [00:10<00:08, 2989.02it/s] 56%|█████▌    | 31690/57000 [00:10<00:08, 2990.97it/s] 56%|█████▌    | 31990/57000 [00:10<00:08, 2987.78it/s] 57%|█████▋    | 32289/57000 [00:10<00:08, 2981.77it/s] 57%|█████▋    | 32588/57000 [00:11<00:08, 2983.44it/s] 58%|█████▊    | 32888/57000 [00:11<00:08, 2986.68it/s] 58%|█████▊    | 33187/57000 [00:11<00:07, 2984.63it/s] 59%|█████▉    | 33488/57000 [00:11<00:07, 2989.39it/s] 59%|█████▉    | 33788/57000 [00:11<00:07, 2990.91it/s] 60%|█████▉    | 34089/57000 [00:11<00:07, 2993.69it/s] 60%|██████    | 34389/57000 [00:11<00:07, 2994.78it/s] 61%|██████    | 34689/57000 [00:11<00:07, 2993.36it/s] 61%|██████▏   | 34989/57000 [00:11<00:07, 2991.14it/s] 62%|██████▏   | 35289/57000 [00:11<00:07, 2982.49it/s] 62%|██████▏   | 35589/57000 [00:12<00:07, 2985.85it/s] 63%|██████▎   | 35888/57000 [00:12<00:07, 2984.10it/s] 63%|██████▎   | 36188/57000 [00:12<00:06, 2987.47it/s] 64%|██████▍   | 36489/57000 [00:12<00:06, 2992.34it/s] 65%|██████▍   | 36789/57000 [00:12<00:06, 2987.60it/s] 65%|██████▌   | 37090/57000 [00:12<00:06, 2991.66it/s] 66%|██████▌   | 37390/57000 [00:12<00:06, 2992.90it/s] 66%|██████▌   | 37690/57000 [00:12<00:06, 2994.61it/s] 67%|██████▋   | 37991/57000 [00:12<00:06, 2996.60it/s] 67%|██████▋   | 38291/57000 [00:12<00:06, 2995.57it/s] 68%|██████▊   | 38591/57000 [00:13<00:06, 2996.76it/s] 68%|██████▊   | 38891/57000 [00:13<00:06, 2993.77it/s] 69%|██████▉   | 39191/57000 [00:13<00:05, 2989.99it/s] 69%|██████▉   | 39491/57000 [00:13<00:05, 2991.12it/s] 70%|██████▉   | 39791/57000 [00:13<00:05, 2992.09it/s] 70%|███████   | 40092/57000 [00:13<00:05, 2994.41it/s] 71%|███████   | 40392/57000 [00:13<00:05, 2987.40it/s] 71%|███████▏  | 40692/57000 [00:13<00:05, 2990.62it/s] 72%|███████▏  | 40993/57000 [00:13<00:05, 2995.15it/s] 72%|███████▏  | 41293/57000 [00:13<00:05, 2993.84it/s] 73%|███████▎  | 41593/57000 [00:14<00:05, 2995.19it/s] 73%|███████▎  | 41893/57000 [00:14<00:05, 2988.65it/s] 74%|███████▍  | 42193/57000 [00:14<00:04, 2991.39it/s] 75%|███████▍  | 42493/57000 [00:14<00:04, 2991.13it/s] 75%|███████▌  | 42793/57000 [00:14<00:04, 2985.46it/s] 76%|███████▌  | 43093/57000 [00:14<00:04, 2988.53it/s] 76%|███████▌  | 43392/57000 [00:14<00:04, 2987.89it/s] 77%|███████▋  | 43692/57000 [00:14<00:04, 2990.57it/s] 77%|███████▋  | 43993/57000 [00:14<00:04, 2994.27it/s] 78%|███████▊  | 44293/57000 [00:14<00:04, 2992.97it/s] 78%|███████▊  | 44594/57000 [00:15<00:04, 2996.17it/s] 79%|███████▉  | 44894/57000 [00:15<00:04, 2996.33it/s] 79%|███████▉  | 45194/57000 [00:15<00:03, 2984.40it/s] 80%|███████▉  | 45494/57000 [00:15<00:03, 2987.10it/s] 80%|████████  | 45793/57000 [00:15<00:03, 2987.12it/s] 81%|████████  | 46094/57000 [00:15<00:03, 2991.80it/s] 81%|████████▏ | 46394/57000 [00:15<00:03, 2987.79it/s] 82%|████████▏ | 46695/57000 [00:15<00:03, 2992.00it/s] 82%|████████▏ | 46995/57000 [00:15<00:03, 2990.72it/s] 83%|████████▎ | 47295/57000 [00:15<00:03, 2991.26it/s] 84%|████████▎ | 47595/57000 [00:16<00:03, 2993.06it/s] 84%|████████▍ | 47895/57000 [00:16<00:03, 2994.19it/s] 85%|████████▍ | 48195/57000 [00:16<00:02, 2992.04it/s] 85%|████████▌ | 48495/57000 [00:16<00:02, 2979.56it/s] 86%|████████▌ | 48795/57000 [00:16<00:02, 2983.45it/s] 86%|████████▌ | 49096/57000 [00:16<00:02, 2988.63it/s] 87%|████████▋ | 49396/57000 [00:16<00:02, 2989.21it/s] 87%|████████▋ | 49696/57000 [00:16<00:02, 2991.16it/s] 88%|████████▊ | 49996/57000 [00:16<00:02, 2991.68it/s] 88%|████████▊ | 50296/57000 [00:16<00:02, 2993.67it/s] 89%|████████▉ | 50597/57000 [00:17<00:02, 2996.61it/s] 89%|████████▉ | 50897/57000 [00:17<00:02, 2983.41it/s] 90%|████████▉ | 51198/57000 [00:17<00:01, 2989.93it/s] 90%|█████████ | 51499/57000 [00:17<00:01, 2993.55it/s] 91%|█████████ | 51800/57000 [00:17<00:01, 2996.49it/s] 91%|█████████▏| 52101/57000 [00:17<00:01, 2997.76it/s] 92%|█████████▏| 52401/57000 [00:17<00:01, 2997.42it/s] 92%|█████████▏| 52702/57000 [00:17<00:01, 2999.32it/s] 93%|█████████▎| 53002/57000 [00:17<00:01, 2998.42it/s] 94%|█████████▎| 53303/57000 [00:17<00:01, 2999.13it/s] 94%|█████████▍| 53603/57000 [00:18<00:01, 2998.72it/s] 95%|█████████▍| 53903/57000 [00:18<00:01, 2998.20it/s] 95%|█████████▌| 54203/57000 [00:18<00:00, 2997.55it/s] 96%|█████████▌| 54503/57000 [00:18<00:00, 2988.61it/s] 96%|█████████▌| 54803/57000 [00:18<00:00, 2990.10it/s] 97%|█████████▋| 55103/57000 [00:18<00:00, 2992.44it/s] 97%|█████████▋| 55403/57000 [00:18<00:00, 2990.73it/s] 98%|█████████▊| 55704/57000 [00:18<00:00, 2993.93it/s] 98%|█████████▊| 56004/57000 [00:18<00:00, 2993.15it/s] 99%|█████████▉| 56305/57000 [00:18<00:00, 2995.58it/s] 99%|█████████▉| 56605/57000 [00:19<00:00, 2993.50it/s]100%|█████████▉| 56905/57000 [00:19<00:00, 2995.22it/s]100%|██████████| 57000/57000 [00:19<00:00, 2970.03it/s]
2022-05-22 10:18:25 - loading data from datasets/KMNIST_3000/valid.json
  0%|          | 0/3000 [00:00<?, ?it/s] 10%|▉         | 296/3000 [00:00<00:00, 2955.39it/s] 20%|█▉        | 595/3000 [00:00<00:00, 2973.63it/s] 30%|██▉       | 895/3000 [00:00<00:00, 2981.22it/s] 40%|███▉      | 1194/3000 [00:00<00:00, 2984.18it/s] 50%|████▉     | 1494/3000 [00:00<00:00, 2988.67it/s] 60%|█████▉    | 1794/3000 [00:00<00:00, 2992.14it/s] 70%|██████▉   | 2095/3000 [00:00<00:00, 2995.59it/s] 80%|███████▉  | 2395/3000 [00:00<00:00, 2994.15it/s] 90%|████████▉ | 2695/3000 [00:00<00:00, 2990.53it/s]100%|█████████▉| 2995/3000 [00:01<00:00, 2989.83it/s]100%|██████████| 3000/3000 [00:01<00:00, 2987.27it/s]
2022-05-22 10:18:26 - loading data from datasets/KMNIST_3000/test.json
  0%|          | 0/10000 [00:00<?, ?it/s]  3%|▎         | 299/10000 [00:00<00:03, 2983.48it/s]  6%|▌         | 599/10000 [00:00<00:03, 2990.09it/s]  9%|▉         | 900/10000 [00:00<00:03, 2995.54it/s] 12%|█▏        | 1200/10000 [00:00<00:02, 2995.65it/s] 15%|█▌        | 1501/10000 [00:00<00:02, 2998.12it/s] 18%|█▊        | 1801/10000 [00:00<00:02, 2995.00it/s] 21%|██        | 2101/10000 [00:00<00:02, 2996.52it/s] 24%|██▍       | 2401/10000 [00:00<00:02, 2995.06it/s] 27%|██▋       | 2701/10000 [00:00<00:02, 2989.64it/s] 30%|███       | 3000/10000 [00:01<00:02, 2979.91it/s] 33%|███▎      | 3298/10000 [00:01<00:02, 2976.57it/s] 36%|███▌      | 3597/10000 [00:01<00:02, 2980.02it/s] 39%|███▉      | 3897/10000 [00:01<00:02, 2985.16it/s] 42%|████▏     | 4196/10000 [00:01<00:01, 2985.93it/s] 45%|████▍     | 4496/10000 [00:01<00:01, 2989.06it/s] 48%|████▊     | 4796/10000 [00:01<00:01, 2990.94it/s] 51%|█████     | 5096/10000 [00:01<00:01, 2989.58it/s] 54%|█████▍    | 5395/10000 [00:01<00:01, 2986.44it/s] 57%|█████▋    | 5695/10000 [00:01<00:01, 2987.62it/s] 60%|█████▉    | 5995/10000 [00:02<00:01, 2988.92it/s] 63%|██████▎   | 6294/10000 [00:02<00:01, 2988.51it/s] 66%|██████▌   | 6593/10000 [00:02<00:01, 2987.82it/s] 69%|██████▉   | 6893/10000 [00:02<00:01, 2989.45it/s] 72%|███████▏  | 7192/10000 [00:02<00:00, 2988.77it/s] 75%|███████▍  | 7491/10000 [00:02<00:00, 2985.36it/s] 78%|███████▊  | 7790/10000 [00:02<00:00, 2984.99it/s] 81%|████████  | 8089/10000 [00:02<00:00, 2985.73it/s] 84%|████████▍ | 8389/10000 [00:02<00:00, 2987.20it/s] 87%|████████▋ | 8688/10000 [00:02<00:00, 2987.36it/s] 90%|████████▉ | 8988/10000 [00:03<00:00, 2990.68it/s] 93%|█████████▎| 9288/10000 [00:03<00:00, 2992.35it/s] 96%|█████████▌| 9588/10000 [00:03<00:00, 2993.21it/s] 99%|█████████▉| 9888/10000 [00:03<00:00, 2994.07it/s]100%|██████████| 10000/10000 [00:03<00:00, 2989.04it/s]
2022-05-22 10:18:35 - Using LF classes: [functools.partial(<class 'sklearn.tree._classes.DecisionTreeClassifier'>, max_depth=1), <class 'sklearn.linear_model._logistic.LogisticRegression'>]
Fitting MulticlassAdaptor... Class 0
  0%|          | 0/23 [00:00<?, ?it/s]  0%|          | 0/23 [3:09:55<?, ?it/s]
Traceback (most recent call last):
  File "fwrench/applications/kmnist.py", line 213, in <module>
    fire.Fire(main)
  File "/home/ubuntu/anaconda3/envs/FWRENCH/lib/python3.7/site-packages/fire/core.py", line 141, in Fire
    component_trace = _Fire(component, args, parsed_flag_args, context, name)
  File "/home/ubuntu/anaconda3/envs/FWRENCH/lib/python3.7/site-packages/fire/core.py", line 471, in _Fire
    target=component.__name__)
  File "/home/ubuntu/anaconda3/envs/FWRENCH/lib/python3.7/site-packages/fire/core.py", line 681, in _CallAndUpdateTrace
    component = fn(*varargs, **kwargs)
  File "fwrench/applications/kmnist.py", line 157, in main
    selector.fit(valid_data_embed, train_data_embed)
  File "/home/ubuntu/FWRENCH/fwrench/utils/utils.py", line 132, in fit
    self.lf_selectors[i].fit(labeled_data_i, unlabeled_data_i)
  File "/home/ubuntu/FWRENCH/fwrench/lf_selectors/snuba_lf_selector.py", line 57, in fit
    model=self.lf_generator, scoring_fn=self.scoring_fn)
  File "/home/ubuntu/FWRENCH/fwrench/lf_selectors/snuba/heuristic_generator.py", line 152, in run_synthesizer
    scoring_fn=scoring_fn)
  File "/home/ubuntu/FWRENCH/fwrench/lf_selectors/snuba/heuristic_generator.py", line 81, in prune_heuristics
    L_temp_train = self.apply_heuristics(heuristics[i], self.train_primitive_matrix, feat_combos[i], beta_opt_temp) 
  File "/home/ubuntu/FWRENCH/fwrench/lf_selectors/snuba/heuristic_generator.py", line 53, in apply_heuristics
    L = np.zeros((np.shape(primitive_matrix)[0],len(heuristics)))
numpy.core._exceptions.MemoryError: Unable to allocate 261. GiB for an array with shape (57000, 613872) and data type float64
