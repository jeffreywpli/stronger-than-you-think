2022-05-22 21:10:27 - loading data from datasets/FashionMNIST_3000/train.json
  0%|          | 0/57000 [00:00<?, ?it/s]  1%|          | 290/57000 [00:00<00:19, 2897.95it/s]  1%|          | 581/57000 [00:00<00:19, 2903.74it/s]  2%|▏         | 872/57000 [00:00<00:19, 2901.11it/s]  2%|▏         | 1164/57000 [00:00<00:19, 2906.23it/s]  3%|▎         | 1457/57000 [00:00<00:19, 2914.52it/s]  3%|▎         | 1749/57000 [00:00<00:18, 2915.53it/s]  4%|▎         | 2042/57000 [00:00<00:18, 2917.56it/s]  4%|▍         | 2334/57000 [00:00<00:18, 2917.50it/s]  5%|▍         | 2626/57000 [00:00<00:18, 2916.41it/s]  5%|▌         | 2919/57000 [00:01<00:18, 2918.93it/s]  6%|▌         | 3211/57000 [00:01<00:18, 2913.95it/s]  6%|▌         | 3504/57000 [00:01<00:18, 2916.71it/s]  7%|▋         | 3797/57000 [00:01<00:18, 2917.75it/s]  7%|▋         | 4091/57000 [00:01<00:18, 2921.48it/s]  8%|▊         | 4384/57000 [00:01<00:17, 2923.96it/s]  8%|▊         | 4677/57000 [00:01<00:17, 2920.99it/s]  9%|▊         | 4971/57000 [00:01<00:17, 2923.91it/s]  9%|▉         | 5264/57000 [00:01<00:17, 2920.66it/s] 10%|▉         | 5557/57000 [00:01<00:17, 2922.29it/s] 10%|█         | 5850/57000 [00:02<00:17, 2923.86it/s] 11%|█         | 6143/57000 [00:02<00:17, 2920.87it/s] 11%|█▏        | 6436/57000 [00:02<00:17, 2921.57it/s] 12%|█▏        | 6729/57000 [00:02<00:17, 2921.80it/s] 12%|█▏        | 7022/57000 [00:02<00:17, 2922.22it/s] 13%|█▎        | 7315/57000 [00:02<00:16, 2922.91it/s] 13%|█▎        | 7608/57000 [00:02<00:16, 2916.70it/s] 14%|█▍        | 7901/57000 [00:02<00:16, 2918.43it/s] 14%|█▍        | 8194/57000 [00:02<00:16, 2918.86it/s] 15%|█▍        | 8486/57000 [00:02<00:16, 2918.31it/s] 15%|█▌        | 8779/57000 [00:03<00:16, 2919.40it/s] 16%|█▌        | 9071/57000 [00:03<00:16, 2916.40it/s] 16%|█▋        | 9364/57000 [00:03<00:16, 2919.26it/s] 17%|█▋        | 9656/57000 [00:03<00:16, 2916.61it/s] 17%|█▋        | 9949/57000 [00:03<00:16, 2917.71it/s] 18%|█▊        | 10242/57000 [00:03<00:16, 2919.56it/s] 18%|█▊        | 10534/57000 [00:03<00:15, 2914.24it/s] 19%|█▉        | 10827/57000 [00:03<00:15, 2917.32it/s] 20%|█▉        | 11119/57000 [00:03<00:15, 2915.22it/s] 20%|██        | 11412/57000 [00:03<00:15, 2916.80it/s] 21%|██        | 11705/57000 [00:04<00:15, 2918.35it/s] 21%|██        | 11997/57000 [00:04<00:15, 2910.89it/s] 22%|██▏       | 12290/57000 [00:04<00:15, 2914.96it/s] 22%|██▏       | 12582/57000 [00:04<00:15, 2914.11it/s] 23%|██▎       | 12875/57000 [00:04<00:15, 2916.06it/s] 23%|██▎       | 13167/57000 [00:04<00:15, 2917.05it/s] 24%|██▎       | 13459/57000 [00:04<00:14, 2915.20it/s] 24%|██▍       | 13751/57000 [00:04<00:14, 2915.25it/s] 25%|██▍       | 14043/57000 [00:04<00:14, 2911.96it/s] 25%|██▌       | 14336/57000 [00:04<00:14, 2914.44it/s] 26%|██▌       | 14628/57000 [00:05<00:14, 2914.31it/s] 26%|██▌       | 14920/57000 [00:05<00:14, 2914.47it/s] 27%|██▋       | 15213/57000 [00:05<00:14, 2916.15it/s] 27%|██▋       | 15505/57000 [00:05<00:14, 2915.05it/s] 28%|██▊       | 15797/57000 [00:05<00:14, 2914.95it/s] 28%|██▊       | 16090/57000 [00:05<00:14, 2917.82it/s] 29%|██▊       | 16382/57000 [00:05<00:13, 2913.12it/s] 29%|██▉       | 16675/57000 [00:05<00:13, 2916.49it/s] 30%|██▉       | 16967/57000 [00:05<00:13, 2912.88it/s] 30%|███       | 17259/57000 [00:05<00:13, 2912.86it/s] 31%|███       | 17551/57000 [00:06<00:13, 2914.40it/s] 31%|███▏      | 17843/57000 [00:06<00:13, 2913.48it/s] 32%|███▏      | 18136/57000 [00:06<00:13, 2916.12it/s] 32%|███▏      | 18428/57000 [00:06<00:13, 2915.32it/s] 33%|███▎      | 18721/57000 [00:06<00:13, 2918.19it/s] 33%|███▎      | 19013/57000 [00:06<00:13, 2916.31it/s] 34%|███▍      | 19305/57000 [00:06<00:12, 2914.46it/s] 34%|███▍      | 19597/57000 [00:06<00:12, 2915.05it/s] 35%|███▍      | 19889/57000 [00:06<00:12, 2907.33it/s] 35%|███▌      | 20182/57000 [00:06<00:12, 2912.61it/s] 36%|███▌      | 20474/57000 [00:07<00:12, 2914.04it/s] 36%|███▋      | 20766/57000 [00:07<00:12, 2911.12it/s] 37%|███▋      | 21058/57000 [00:07<00:12, 2911.74it/s] 37%|███▋      | 21350/57000 [00:07<00:12, 2911.99it/s] 38%|███▊      | 21643/57000 [00:07<00:12, 2915.60it/s] 38%|███▊      | 21935/57000 [00:07<00:12, 2915.36it/s] 39%|███▉      | 22227/57000 [00:07<00:11, 2914.77it/s] 40%|███▉      | 22519/57000 [00:07<00:11, 2912.61it/s] 40%|████      | 22811/57000 [00:07<00:11, 2913.14it/s] 41%|████      | 23103/57000 [00:07<00:11, 2912.16it/s] 41%|████      | 23395/57000 [00:08<00:11, 2912.62it/s] 42%|████▏     | 23687/57000 [00:08<00:11, 2911.61it/s] 42%|████▏     | 23979/57000 [00:08<00:11, 2912.07it/s] 43%|████▎     | 24271/57000 [00:08<00:11, 2910.94it/s] 43%|████▎     | 24563/57000 [00:08<00:11, 2913.22it/s] 44%|████▎     | 24855/57000 [00:08<00:11, 2914.02it/s] 44%|████▍     | 25147/57000 [00:08<00:10, 2901.56it/s] 45%|████▍     | 25440/57000 [00:08<00:10, 2908.80it/s] 45%|████▌     | 25732/57000 [00:08<00:10, 2910.33it/s] 46%|████▌     | 26024/57000 [00:08<00:10, 2911.28it/s] 46%|████▌     | 26316/57000 [00:09<00:10, 2912.57it/s] 47%|████▋     | 26608/57000 [00:09<00:10, 2911.01it/s] 47%|████▋     | 26900/57000 [00:09<00:10, 2912.62it/s] 48%|████▊     | 27192/57000 [00:09<00:10, 2909.44it/s] 48%|████▊     | 27484/57000 [00:09<00:10, 2911.99it/s] 49%|████▊     | 27776/57000 [00:09<00:10, 2913.74it/s] 49%|████▉     | 28068/57000 [00:09<00:09, 2912.81it/s] 50%|████▉     | 28360/57000 [00:09<00:09, 2909.29it/s] 50%|█████     | 28651/57000 [00:09<00:09, 2909.28it/s] 51%|█████     | 28944/57000 [00:09<00:09, 2913.55it/s] 51%|█████▏    | 29236/57000 [00:10<00:09, 2911.07it/s] 52%|█████▏    | 29528/57000 [00:10<00:09, 2910.74it/s] 52%|█████▏    | 29820/57000 [00:10<00:09, 2912.07it/s] 53%|█████▎    | 30112/57000 [00:10<00:09, 2913.93it/s] 53%|█████▎    | 30404/57000 [00:10<00:09, 2911.66it/s] 54%|█████▍    | 30697/57000 [00:10<00:09, 2916.00it/s] 54%|█████▍    | 30989/57000 [00:10<00:08, 2913.35it/s] 55%|█████▍    | 31281/57000 [00:10<00:08, 2914.96it/s] 55%|█████▌    | 31573/57000 [00:10<00:08, 2914.86it/s] 56%|█████▌    | 31865/57000 [00:10<00:08, 2911.25it/s] 56%|█████▋    | 32159/57000 [00:11<00:08, 2916.93it/s] 57%|█████▋    | 32451/57000 [00:11<00:08, 2913.65it/s] 57%|█████▋    | 32744/57000 [00:11<00:08, 2917.18it/s] 58%|█████▊    | 33036/57000 [00:11<00:08, 2914.84it/s] 58%|█████▊    | 33328/57000 [00:11<00:08, 2913.09it/s] 59%|█████▉    | 33620/57000 [00:11<00:08, 2912.57it/s] 59%|█████▉    | 33912/57000 [00:11<00:07, 2907.18it/s] 60%|██████    | 34204/57000 [00:11<00:07, 2910.86it/s] 61%|██████    | 34496/57000 [00:11<00:07, 2910.18it/s] 61%|██████    | 34788/57000 [00:11<00:07, 2910.35it/s] 62%|██████▏   | 35080/57000 [00:12<00:07, 2911.64it/s] 62%|██████▏   | 35372/57000 [00:12<00:07, 2908.67it/s] 63%|██████▎   | 35664/57000 [00:12<00:07, 2911.23it/s] 63%|██████▎   | 35956/57000 [00:12<00:07, 2909.58it/s] 64%|██████▎   | 36248/57000 [00:12<00:07, 2912.47it/s] 64%|██████▍   | 36540/57000 [00:12<00:07, 2913.53it/s] 65%|██████▍   | 36832/57000 [00:12<00:06, 2909.31it/s] 65%|██████▌   | 37124/57000 [00:12<00:06, 2911.46it/s] 66%|██████▌   | 37416/57000 [00:12<00:06, 2912.52it/s] 66%|██████▌   | 37708/57000 [00:12<00:06, 2913.15it/s] 67%|██████▋   | 38000/57000 [00:13<00:06, 2912.77it/s] 67%|██████▋   | 38292/57000 [00:13<00:06, 2906.92it/s] 68%|██████▊   | 38584/57000 [00:13<00:06, 2908.78it/s] 68%|██████▊   | 38876/57000 [00:13<00:06, 2910.74it/s] 69%|██████▊   | 39168/57000 [00:13<00:06, 2909.67it/s] 69%|██████▉   | 39460/57000 [00:13<00:06, 2910.81it/s] 70%|██████▉   | 39752/57000 [00:13<00:05, 2906.46it/s] 70%|███████   | 40044/57000 [00:13<00:05, 2909.96it/s] 71%|███████   | 40335/57000 [00:13<00:05, 2905.10it/s] 71%|███████▏  | 40628/57000 [00:13<00:05, 2911.10it/s] 72%|███████▏  | 40921/57000 [00:14<00:05, 2915.54it/s] 72%|███████▏  | 41213/57000 [00:14<00:05, 2911.86it/s] 73%|███████▎  | 41505/57000 [00:14<00:05, 2914.03it/s] 73%|███████▎  | 41797/57000 [00:14<00:05, 2912.72it/s] 74%|███████▍  | 42089/57000 [00:14<00:05, 2912.25it/s] 74%|███████▍  | 42381/57000 [00:14<00:05, 2914.44it/s] 75%|███████▍  | 42673/57000 [00:14<00:04, 2912.51it/s] 75%|███████▌  | 42965/57000 [00:14<00:04, 2913.69it/s] 76%|███████▌  | 43257/57000 [00:14<00:04, 2913.36it/s] 76%|███████▋  | 43549/57000 [00:14<00:04, 2913.37it/s] 77%|███████▋  | 43841/57000 [00:15<00:04, 2913.81it/s] 77%|███████▋  | 44133/57000 [00:15<00:04, 2909.18it/s] 78%|███████▊  | 44425/57000 [00:15<00:04, 2911.28it/s] 78%|███████▊  | 44717/57000 [00:15<00:04, 2913.18it/s] 79%|███████▉  | 45009/57000 [00:15<00:04, 2913.56it/s] 79%|███████▉  | 45301/57000 [00:15<00:04, 2907.70it/s] 80%|███████▉  | 45593/57000 [00:15<00:03, 2908.73it/s] 80%|████████  | 45885/57000 [00:15<00:03, 2911.68it/s] 81%|████████  | 46177/57000 [00:15<00:03, 2914.05it/s] 82%|████████▏ | 46469/57000 [00:15<00:03, 2907.55it/s] 82%|████████▏ | 46761/57000 [00:16<00:03, 2910.13it/s] 83%|████████▎ | 47053/57000 [00:16<00:03, 2908.08it/s] 83%|████████▎ | 47345/57000 [00:16<00:03, 2908.40it/s] 84%|████████▎ | 47637/57000 [00:16<00:03, 2910.80it/s] 84%|████████▍ | 47929/57000 [00:16<00:03, 2911.19it/s] 85%|████████▍ | 48221/57000 [00:16<00:03, 2911.06it/s] 85%|████████▌ | 48513/57000 [00:16<00:02, 2905.14it/s] 86%|████████▌ | 48805/57000 [00:16<00:02, 2906.80it/s] 86%|████████▌ | 49096/57000 [00:16<00:02, 2907.71it/s] 87%|████████▋ | 49387/57000 [00:16<00:02, 2907.74it/s] 87%|████████▋ | 49679/57000 [00:17<00:02, 2909.58it/s] 88%|████████▊ | 49970/57000 [00:17<00:02, 2907.09it/s] 88%|████████▊ | 50262/57000 [00:17<00:02, 2910.80it/s] 89%|████████▊ | 50554/57000 [00:17<00:02, 2911.70it/s] 89%|████████▉ | 50846/57000 [00:17<00:02, 2899.56it/s] 90%|████████▉ | 51138/57000 [00:17<00:02, 2904.14it/s] 90%|█████████ | 51429/57000 [00:17<00:01, 2904.91it/s] 91%|█████████ | 51722/57000 [00:17<00:01, 2910.20it/s] 91%|█████████▏| 52014/57000 [00:17<00:01, 2910.89it/s] 92%|█████████▏| 52306/57000 [00:17<00:01, 2908.94it/s] 92%|█████████▏| 52598/57000 [00:18<00:01, 2911.28it/s] 93%|█████████▎| 52890/57000 [00:18<00:01, 2907.99it/s] 93%|█████████▎| 53182/57000 [00:18<00:01, 2910.36it/s] 94%|█████████▍| 53474/57000 [00:18<00:01, 2912.34it/s] 94%|█████████▍| 53766/57000 [00:18<00:01, 2910.87it/s] 95%|█████████▍| 54058/57000 [00:18<00:01, 2912.07it/s] 95%|█████████▌| 54350/57000 [00:18<00:00, 2907.99it/s] 96%|█████████▌| 54642/57000 [00:18<00:00, 2909.43it/s] 96%|█████████▋| 54934/57000 [00:18<00:00, 2911.10it/s] 97%|█████████▋| 55226/57000 [00:18<00:00, 2912.02it/s] 97%|█████████▋| 55519/57000 [00:19<00:00, 2914.87it/s] 98%|█████████▊| 55811/57000 [00:19<00:00, 2909.93it/s] 98%|█████████▊| 56103/57000 [00:19<00:00, 2910.46it/s] 99%|█████████▉| 56395/57000 [00:19<00:00, 2913.24it/s] 99%|█████████▉| 56687/57000 [00:19<00:00, 2910.68it/s]100%|█████████▉| 56979/57000 [00:19<00:00, 2913.11it/s]100%|██████████| 57000/57000 [00:19<00:00, 2912.87it/s]
2022-05-22 21:10:47 - loading data from datasets/FashionMNIST_3000/valid.json
  0%|          | 0/3000 [00:00<?, ?it/s] 10%|▉         | 292/3000 [00:00<00:00, 2913.15it/s] 20%|█▉        | 585/3000 [00:00<00:00, 2919.72it/s] 29%|██▉       | 878/3000 [00:00<00:00, 2920.02it/s] 39%|███▉      | 1171/3000 [00:00<00:00, 2922.33it/s] 49%|████▉     | 1464/3000 [00:00<00:00, 2917.56it/s] 59%|█████▊    | 1757/3000 [00:00<00:00, 2920.52it/s] 68%|██████▊   | 2050/3000 [00:00<00:00, 2920.42it/s] 78%|███████▊  | 2343/3000 [00:00<00:00, 2920.00it/s] 88%|████████▊ | 2636/3000 [00:00<00:00, 2920.34it/s] 98%|█████████▊| 2929/3000 [00:01<00:00, 2916.98it/s]100%|██████████| 3000/3000 [00:01<00:00, 2917.79it/s]
2022-05-22 21:10:48 - loading data from datasets/FashionMNIST_3000/test.json
  0%|          | 0/10000 [00:00<?, ?it/s]  3%|▎         | 292/10000 [00:00<00:03, 2910.85it/s]  6%|▌         | 584/10000 [00:00<00:03, 2913.25it/s]  9%|▉         | 876/10000 [00:00<00:03, 2915.90it/s] 12%|█▏        | 1169/10000 [00:00<00:03, 2918.82it/s] 15%|█▍        | 1461/10000 [00:00<00:02, 2918.40it/s] 18%|█▊        | 1754/10000 [00:00<00:02, 2921.45it/s] 20%|██        | 2047/10000 [00:00<00:02, 2919.82it/s] 23%|██▎       | 2339/10000 [00:00<00:02, 2919.25it/s] 26%|██▋       | 2631/10000 [00:00<00:02, 2917.06it/s] 29%|██▉       | 2923/10000 [00:01<00:02, 2915.40it/s] 32%|███▏      | 3215/10000 [00:01<00:02, 2915.64it/s] 35%|███▌      | 3507/10000 [00:01<00:02, 2915.28it/s] 38%|███▊      | 3799/10000 [00:01<00:02, 2914.99it/s] 41%|████      | 4091/10000 [00:01<00:02, 2915.48it/s] 44%|████▍     | 4383/10000 [00:01<00:01, 2914.27it/s] 47%|████▋     | 4675/10000 [00:01<00:01, 2915.11it/s] 50%|████▉     | 4967/10000 [00:01<00:01, 2915.14it/s] 53%|█████▎    | 5259/10000 [00:01<00:01, 2915.57it/s] 56%|█████▌    | 5551/10000 [00:01<00:01, 2915.79it/s] 58%|█████▊    | 5843/10000 [00:02<00:01, 2913.91it/s] 61%|██████▏   | 6135/10000 [00:02<00:01, 2913.56it/s] 64%|██████▍   | 6427/10000 [00:02<00:01, 2913.19it/s] 67%|██████▋   | 6719/10000 [00:02<00:01, 2912.27it/s] 70%|███████   | 7011/10000 [00:02<00:01, 2912.64it/s] 73%|███████▎  | 7303/10000 [00:02<00:00, 2911.99it/s] 76%|███████▌  | 7596/10000 [00:02<00:00, 2915.28it/s] 79%|███████▉  | 7888/10000 [00:02<00:00, 2915.91it/s] 82%|████████▏ | 8180/10000 [00:02<00:00, 2916.33it/s] 85%|████████▍ | 8472/10000 [00:02<00:00, 2917.18it/s] 88%|████████▊ | 8764/10000 [00:03<00:00, 2913.21it/s] 91%|█████████ | 9056/10000 [00:03<00:00, 2913.19it/s] 93%|█████████▎| 9348/10000 [00:03<00:00, 2914.20it/s] 96%|█████████▋| 9640/10000 [00:03<00:00, 2912.18it/s] 99%|█████████▉| 9932/10000 [00:03<00:00, 2913.80it/s]100%|██████████| 10000/10000 [00:03<00:00, 2914.93it/s]
2022-05-22 21:10:57 - Using LF classes: [functools.partial(<class 'sklearn.tree._classes.DecisionTreeClassifier'>, max_depth=1), <class 'sklearn.linear_model._logistic.LogisticRegression'>]
Fitting MulticlassAdaptor... Class 0
  0%|          | 0/23 [00:00<?, ?it/s]  0%|          | 0/23 [3:21:46<?, ?it/s]
Traceback (most recent call last):
  File "fwrench/applications/fashion_mnist.py", line 213, in <module>
    fire.Fire(main)
  File "/home/ubuntu/anaconda3/envs/FWRENCH/lib/python3.7/site-packages/fire/core.py", line 141, in Fire
    component_trace = _Fire(component, args, parsed_flag_args, context, name)
  File "/home/ubuntu/anaconda3/envs/FWRENCH/lib/python3.7/site-packages/fire/core.py", line 471, in _Fire
    target=component.__name__)
  File "/home/ubuntu/anaconda3/envs/FWRENCH/lib/python3.7/site-packages/fire/core.py", line 681, in _CallAndUpdateTrace
    component = fn(*varargs, **kwargs)
  File "fwrench/applications/fashion_mnist.py", line 157, in main
    selector.fit(valid_data_embed, train_data_embed)
  File "/home/ubuntu/FWRENCH/fwrench/utils/utils.py", line 132, in fit
    self.lf_selectors[i].fit(labeled_data_i, unlabeled_data_i)
  File "/home/ubuntu/FWRENCH/fwrench/lf_selectors/snuba_lf_selector.py", line 57, in fit
    model=self.lf_generator, scoring_fn=self.scoring_fn)
  File "/home/ubuntu/FWRENCH/fwrench/lf_selectors/snuba/heuristic_generator.py", line 152, in run_synthesizer
    scoring_fn=scoring_fn)
  File "/home/ubuntu/FWRENCH/fwrench/lf_selectors/snuba/heuristic_generator.py", line 81, in prune_heuristics
    L_temp_train = self.apply_heuristics(heuristics[i], self.train_primitive_matrix, feat_combos[i], beta_opt_temp) 
  File "/home/ubuntu/FWRENCH/fwrench/lf_selectors/snuba/heuristic_generator.py", line 53, in apply_heuristics
    L = np.zeros((np.shape(primitive_matrix)[0],len(heuristics)))
numpy.core._exceptions.MemoryError: Unable to allocate 261. GiB for an array with shape (57000, 613872) and data type float64
