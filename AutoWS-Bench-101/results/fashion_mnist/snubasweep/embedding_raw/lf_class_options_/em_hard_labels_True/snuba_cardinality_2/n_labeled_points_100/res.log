2022-05-22 04:52:59 - loading data from datasets/FashionMNIST_3000/train.json
  0%|          | 0/57000 [00:00<?, ?it/s]  0%|          | 285/57000 [00:00<00:19, 2846.72it/s]  1%|          | 570/57000 [00:00<00:19, 2841.81it/s]  2%|▏         | 858/57000 [00:00<00:19, 2856.03it/s]  2%|▏         | 1145/57000 [00:00<00:19, 2860.12it/s]  3%|▎         | 1433/57000 [00:00<00:19, 2865.13it/s]  3%|▎         | 1720/57000 [00:00<00:19, 2865.86it/s]  4%|▎         | 2008/57000 [00:00<00:19, 2869.50it/s]  4%|▍         | 2295/57000 [00:00<00:19, 2866.93it/s]  5%|▍         | 2583/57000 [00:00<00:18, 2870.52it/s]  5%|▌         | 2871/57000 [00:01<00:18, 2872.06it/s]  6%|▌         | 3159/57000 [00:01<00:18, 2869.44it/s]  6%|▌         | 3447/57000 [00:01<00:18, 2871.56it/s]  7%|▋         | 3735/57000 [00:01<00:18, 2867.52it/s]  7%|▋         | 4023/57000 [00:01<00:18, 2869.84it/s]  8%|▊         | 4311/57000 [00:01<00:18, 2870.42it/s]  8%|▊         | 4599/57000 [00:01<00:18, 2869.30it/s]  9%|▊         | 4887/57000 [00:01<00:18, 2870.03it/s]  9%|▉         | 5175/57000 [00:01<00:18, 2867.27it/s] 10%|▉         | 5462/57000 [00:01<00:17, 2867.72it/s] 10%|█         | 5750/57000 [00:02<00:17, 2870.19it/s] 11%|█         | 6038/57000 [00:02<00:17, 2868.69it/s] 11%|█         | 6326/57000 [00:02<00:17, 2870.70it/s] 12%|█▏        | 6614/57000 [00:02<00:17, 2870.89it/s] 12%|█▏        | 6902/57000 [00:02<00:17, 2867.93it/s] 13%|█▎        | 7190/57000 [00:02<00:17, 2868.73it/s] 13%|█▎        | 7477/57000 [00:02<00:17, 2863.59it/s] 14%|█▎        | 7766/57000 [00:02<00:17, 2868.98it/s] 14%|█▍        | 8054/57000 [00:02<00:17, 2870.20it/s] 15%|█▍        | 8342/57000 [00:02<00:16, 2868.98it/s] 15%|█▌        | 8630/57000 [00:03<00:16, 2871.19it/s] 16%|█▌        | 8918/57000 [00:03<00:16, 2867.90it/s] 16%|█▌        | 9206/57000 [00:03<00:16, 2871.13it/s] 17%|█▋        | 9494/57000 [00:03<00:16, 2870.18it/s] 17%|█▋        | 9782/57000 [00:03<00:16, 2868.21it/s] 18%|█▊        | 10070/57000 [00:03<00:16, 2871.16it/s] 18%|█▊        | 10358/57000 [00:03<00:16, 2870.89it/s] 19%|█▊        | 10646/57000 [00:03<00:16, 2873.31it/s] 19%|█▉        | 10934/57000 [00:03<00:16, 2874.36it/s] 20%|█▉        | 11222/57000 [00:03<00:15, 2867.99it/s] 20%|██        | 11510/57000 [00:04<00:15, 2870.38it/s] 21%|██        | 11798/57000 [00:04<00:15, 2868.40it/s] 21%|██        | 12085/57000 [00:04<00:15, 2865.19it/s] 22%|██▏       | 12372/57000 [00:04<00:15, 2865.67it/s] 22%|██▏       | 12659/57000 [00:04<00:15, 2861.58it/s] 23%|██▎       | 12948/57000 [00:04<00:15, 2867.29it/s] 23%|██▎       | 13235/57000 [00:04<00:15, 2865.98it/s] 24%|██▎       | 13523/57000 [00:04<00:15, 2867.58it/s] 24%|██▍       | 13811/57000 [00:04<00:15, 2868.30it/s] 25%|██▍       | 14098/57000 [00:04<00:14, 2865.45it/s] 25%|██▌       | 14386/57000 [00:05<00:14, 2867.16it/s] 26%|██▌       | 14674/57000 [00:05<00:14, 2868.17it/s] 26%|██▌       | 14962/57000 [00:05<00:14, 2870.16it/s] 27%|██▋       | 15250/57000 [00:05<00:14, 2871.02it/s] 27%|██▋       | 15538/57000 [00:05<00:14, 2864.72it/s] 28%|██▊       | 15826/57000 [00:05<00:14, 2866.77it/s] 28%|██▊       | 16114/57000 [00:05<00:14, 2868.72it/s] 29%|██▉       | 16401/57000 [00:05<00:14, 2868.10it/s] 29%|██▉       | 16690/57000 [00:05<00:14, 2871.73it/s] 30%|██▉       | 16978/57000 [00:05<00:13, 2868.05it/s] 30%|███       | 17266/57000 [00:06<00:13, 2870.93it/s] 31%|███       | 17554/57000 [00:06<00:13, 2873.51it/s] 31%|███▏      | 17842/57000 [00:06<00:13, 2870.18it/s] 32%|███▏      | 18130/57000 [00:06<00:13, 2871.78it/s] 32%|███▏      | 18418/57000 [00:06<00:13, 2870.64it/s] 33%|███▎      | 18706/57000 [00:06<00:13, 2871.75it/s] 33%|███▎      | 18994/57000 [00:06<00:13, 2870.44it/s] 34%|███▍      | 19282/57000 [00:06<00:13, 2865.86it/s] 34%|███▍      | 19570/57000 [00:06<00:13, 2867.97it/s] 35%|███▍      | 19857/57000 [00:06<00:12, 2860.01it/s] 35%|███▌      | 20144/57000 [00:07<00:12, 2862.71it/s] 36%|███▌      | 20432/57000 [00:07<00:12, 2865.37it/s] 36%|███▋      | 20719/57000 [00:07<00:12, 2861.36it/s] 37%|███▋      | 21007/57000 [00:07<00:12, 2864.17it/s] 37%|███▋      | 21294/57000 [00:07<00:12, 2865.02it/s] 38%|███▊      | 21581/57000 [00:07<00:12, 2864.15it/s] 38%|███▊      | 21869/57000 [00:07<00:12, 2868.48it/s] 39%|███▉      | 22156/57000 [00:07<00:12, 2868.74it/s] 39%|███▉      | 22443/57000 [00:07<00:12, 2866.79it/s] 40%|███▉      | 22731/57000 [00:07<00:11, 2869.13it/s] 40%|████      | 23018/57000 [00:08<00:11, 2864.88it/s] 41%|████      | 23306/57000 [00:08<00:11, 2867.29it/s] 41%|████▏     | 23593/57000 [00:08<00:11, 2865.43it/s] 42%|████▏     | 23880/57000 [00:08<00:11, 2864.12it/s] 42%|████▏     | 24168/57000 [00:08<00:11, 2867.58it/s] 43%|████▎     | 24455/57000 [00:08<00:11, 2864.13it/s] 43%|████▎     | 24743/57000 [00:08<00:11, 2867.20it/s] 44%|████▍     | 25030/57000 [00:08<00:11, 2862.47it/s] 44%|████▍     | 25317/57000 [00:08<00:11, 2862.43it/s] 45%|████▍     | 25605/57000 [00:08<00:10, 2865.21it/s] 45%|████▌     | 25892/57000 [00:09<00:10, 2862.91it/s] 46%|████▌     | 26179/57000 [00:09<00:10, 2864.22it/s] 46%|████▋     | 26466/57000 [00:09<00:10, 2863.02it/s] 47%|████▋     | 26753/57000 [00:09<00:10, 2862.96it/s] 47%|████▋     | 27041/57000 [00:09<00:10, 2865.43it/s] 48%|████▊     | 27328/57000 [00:09<00:10, 2857.87it/s] 48%|████▊     | 27615/57000 [00:09<00:10, 2859.70it/s] 49%|████▉     | 27903/57000 [00:09<00:10, 2862.97it/s] 49%|████▉     | 28190/57000 [00:09<00:10, 2859.10it/s] 50%|████▉     | 28478/57000 [00:09<00:09, 2864.05it/s] 50%|█████     | 28765/57000 [00:10<00:09, 2860.84it/s] 51%|█████     | 29052/57000 [00:10<00:09, 2863.01it/s] 51%|█████▏    | 29340/57000 [00:10<00:09, 2865.76it/s] 52%|█████▏    | 29627/57000 [00:10<00:09, 2863.40it/s] 52%|█████▏    | 29914/57000 [00:10<00:09, 2864.49it/s] 53%|█████▎    | 30201/57000 [00:10<00:09, 2862.49it/s] 53%|█████▎    | 30488/57000 [00:10<00:09, 2863.02it/s] 54%|█████▍    | 30776/57000 [00:10<00:09, 2866.64it/s] 54%|█████▍    | 31063/57000 [00:10<00:09, 2863.24it/s] 55%|█████▌    | 31350/57000 [00:10<00:08, 2864.40it/s] 56%|█████▌    | 31637/57000 [00:11<00:08, 2864.31it/s] 56%|█████▌    | 31924/57000 [00:11<00:08, 2862.23it/s] 57%|█████▋    | 32211/57000 [00:11<00:08, 2864.20it/s] 57%|█████▋    | 32498/57000 [00:11<00:08, 2858.75it/s] 58%|█████▊    | 32785/57000 [00:11<00:08, 2861.98it/s] 58%|█████▊    | 33072/57000 [00:11<00:08, 2854.90it/s] 59%|█████▊    | 33358/57000 [00:11<00:08, 2854.41it/s] 59%|█████▉    | 33645/57000 [00:11<00:08, 2858.27it/s] 60%|█████▉    | 33932/57000 [00:11<00:08, 2859.66it/s] 60%|██████    | 34219/57000 [00:11<00:07, 2862.29it/s] 61%|██████    | 34506/57000 [00:12<00:07, 2860.37it/s] 61%|██████    | 34794/57000 [00:12<00:07, 2863.70it/s] 62%|██████▏   | 35081/57000 [00:12<00:07, 2864.57it/s] 62%|██████▏   | 35368/57000 [00:12<00:07, 2861.79it/s] 63%|██████▎   | 35655/57000 [00:12<00:07, 2863.83it/s] 63%|██████▎   | 35942/57000 [00:12<00:07, 2860.17it/s] 64%|██████▎   | 36230/57000 [00:12<00:07, 2863.59it/s] 64%|██████▍   | 36518/57000 [00:12<00:07, 2867.86it/s] 65%|██████▍   | 36805/57000 [00:12<00:07, 2860.38it/s] 65%|██████▌   | 37093/57000 [00:12<00:06, 2863.76it/s] 66%|██████▌   | 37380/57000 [00:13<00:06, 2864.45it/s] 66%|██████▌   | 37667/57000 [00:13<00:06, 2864.54it/s] 67%|██████▋   | 37955/57000 [00:13<00:06, 2868.69it/s] 67%|██████▋   | 38242/57000 [00:13<00:06, 2864.05it/s] 68%|██████▊   | 38530/57000 [00:13<00:06, 2867.08it/s] 68%|██████▊   | 38817/57000 [00:13<00:06, 2866.78it/s] 69%|██████▊   | 39104/57000 [00:13<00:06, 2864.56it/s] 69%|██████▉   | 39392/57000 [00:13<00:06, 2868.50it/s] 70%|██████▉   | 39679/57000 [00:13<00:06, 2864.73it/s] 70%|███████   | 39966/57000 [00:13<00:05, 2866.24it/s] 71%|███████   | 40253/57000 [00:14<00:05, 2860.34it/s] 71%|███████   | 40540/57000 [00:14<00:05, 2861.56it/s] 72%|███████▏  | 40828/57000 [00:14<00:05, 2864.37it/s] 72%|███████▏  | 41115/57000 [00:14<00:05, 2860.86it/s] 73%|███████▎  | 41403/57000 [00:14<00:05, 2864.01it/s] 73%|███████▎  | 41690/57000 [00:14<00:05, 2865.36it/s] 74%|███████▎  | 41977/57000 [00:14<00:05, 2858.39it/s] 74%|███████▍  | 42264/57000 [00:14<00:05, 2861.07it/s] 75%|███████▍  | 42551/57000 [00:14<00:05, 2860.32it/s] 75%|███████▌  | 42838/57000 [00:14<00:04, 2858.89it/s] 76%|███████▌  | 43125/57000 [00:15<00:04, 2860.95it/s] 76%|███████▌  | 43412/57000 [00:15<00:04, 2861.12it/s] 77%|███████▋  | 43700/57000 [00:15<00:04, 2866.20it/s] 77%|███████▋  | 43987/57000 [00:15<00:04, 2865.32it/s] 78%|███████▊  | 44274/57000 [00:15<00:04, 2861.18it/s] 78%|███████▊  | 44562/57000 [00:15<00:04, 2863.97it/s] 79%|███████▊  | 44849/57000 [00:15<00:04, 2860.21it/s] 79%|███████▉  | 45136/57000 [00:15<00:04, 2862.66it/s] 80%|███████▉  | 45423/57000 [00:15<00:04, 2858.49it/s] 80%|████████  | 45710/57000 [00:15<00:03, 2859.67it/s] 81%|████████  | 45998/57000 [00:16<00:03, 2863.26it/s] 81%|████████  | 46285/57000 [00:16<00:03, 2858.71it/s] 82%|████████▏ | 46572/57000 [00:16<00:03, 2860.84it/s] 82%|████████▏ | 46859/57000 [00:16<00:03, 2862.97it/s] 83%|████████▎ | 47146/57000 [00:16<00:03, 2863.51it/s] 83%|████████▎ | 47433/57000 [00:16<00:03, 2864.85it/s] 84%|████████▎ | 47720/57000 [00:16<00:03, 2864.07it/s] 84%|████████▍ | 48008/57000 [00:16<00:03, 2866.03it/s] 85%|████████▍ | 48297/57000 [00:16<00:03, 2871.08it/s] 85%|████████▌ | 48585/57000 [00:16<00:02, 2864.56it/s] 86%|████████▌ | 48873/57000 [00:17<00:02, 2867.96it/s] 86%|████████▌ | 49161/57000 [00:17<00:02, 2869.53it/s] 87%|████████▋ | 49448/57000 [00:17<00:02, 2868.56it/s] 87%|████████▋ | 49735/57000 [00:17<00:02, 2867.99it/s] 88%|████████▊ | 50022/57000 [00:17<00:02, 2861.57it/s] 88%|████████▊ | 50310/57000 [00:17<00:02, 2864.44it/s] 89%|████████▉ | 50598/57000 [00:17<00:02, 2867.56it/s] 89%|████████▉ | 50885/57000 [00:17<00:02, 2847.49it/s] 90%|████████▉ | 51173/57000 [00:17<00:02, 2856.30it/s] 90%|█████████ | 51461/57000 [00:17<00:01, 2860.42it/s] 91%|█████████ | 51749/57000 [00:18<00:01, 2863.70it/s] 91%|█████████▏| 52037/57000 [00:18<00:01, 2867.90it/s] 92%|█████████▏| 52324/57000 [00:18<00:01, 2862.21it/s] 92%|█████████▏| 52611/57000 [00:18<00:01, 2861.96it/s] 93%|█████████▎| 52898/57000 [00:18<00:01, 2860.69it/s] 93%|█████████▎| 53185/57000 [00:18<00:01, 2860.93it/s] 94%|█████████▍| 53472/57000 [00:18<00:01, 2863.51it/s] 94%|█████████▍| 53759/57000 [00:18<00:01, 2861.12it/s] 95%|█████████▍| 54046/57000 [00:18<00:01, 2861.87it/s] 95%|█████████▌| 54333/57000 [00:18<00:00, 2856.59it/s] 96%|█████████▌| 54620/57000 [00:19<00:00, 2860.44it/s] 96%|█████████▋| 54907/57000 [00:19<00:00, 2862.16it/s] 97%|█████████▋| 55194/57000 [00:19<00:00, 2863.38it/s] 97%|█████████▋| 55481/57000 [00:19<00:00, 2864.33it/s] 98%|█████████▊| 55768/57000 [00:19<00:00, 2864.16it/s] 98%|█████████▊| 56055/57000 [00:19<00:00, 2863.47it/s] 99%|█████████▉| 56342/57000 [00:19<00:00, 2863.10it/s] 99%|█████████▉| 56629/57000 [00:19<00:00, 2859.94it/s]100%|█████████▉| 56917/57000 [00:19<00:00, 2863.52it/s]100%|██████████| 57000/57000 [00:19<00:00, 2864.81it/s]
2022-05-22 04:53:19 - loading data from datasets/FashionMNIST_3000/valid.json
  0%|          | 0/3000 [00:00<?, ?it/s] 10%|▉         | 286/3000 [00:00<00:00, 2853.04it/s] 19%|█▉        | 574/3000 [00:00<00:00, 2868.56it/s] 29%|██▊       | 862/3000 [00:00<00:00, 2870.28it/s] 38%|███▊      | 1150/3000 [00:00<00:00, 2868.57it/s] 48%|████▊     | 1438/3000 [00:00<00:00, 2870.98it/s] 58%|█████▊    | 1726/3000 [00:00<00:00, 2869.99it/s] 67%|██████▋   | 2014/3000 [00:00<00:00, 2872.55it/s] 77%|███████▋  | 2302/3000 [00:00<00:00, 2871.27it/s] 86%|████████▋ | 2590/3000 [00:00<00:00, 2872.35it/s] 96%|█████████▌| 2878/3000 [00:01<00:00, 2870.78it/s]100%|██████████| 3000/3000 [00:01<00:00, 2869.56it/s]
2022-05-22 04:53:20 - loading data from datasets/FashionMNIST_3000/test.json
  0%|          | 0/10000 [00:00<?, ?it/s]  3%|▎         | 286/10000 [00:00<00:03, 2857.97it/s]  6%|▌         | 572/10000 [00:00<00:03, 2859.05it/s]  9%|▊         | 860/10000 [00:00<00:03, 2864.69it/s] 11%|█▏        | 1147/10000 [00:00<00:03, 2865.30it/s] 14%|█▍        | 1435/10000 [00:00<00:02, 2867.07it/s] 17%|█▋        | 1722/10000 [00:00<00:02, 2867.11it/s] 20%|██        | 2010/10000 [00:00<00:02, 2868.23it/s] 23%|██▎       | 2297/10000 [00:00<00:02, 2867.07it/s] 26%|██▌       | 2584/10000 [00:00<00:02, 2864.59it/s] 29%|██▊       | 2871/10000 [00:01<00:02, 2862.45it/s] 32%|███▏      | 3158/10000 [00:01<00:02, 2860.87it/s] 34%|███▍      | 3445/10000 [00:01<00:02, 2861.11it/s] 37%|███▋      | 3732/10000 [00:01<00:02, 2860.00it/s] 40%|████      | 4019/10000 [00:01<00:02, 2860.41it/s] 43%|████▎     | 4306/10000 [00:01<00:01, 2861.55it/s] 46%|████▌     | 4593/10000 [00:01<00:01, 2862.88it/s] 49%|████▉     | 4880/10000 [00:01<00:01, 2861.81it/s] 52%|█████▏    | 5167/10000 [00:01<00:01, 2863.12it/s] 55%|█████▍    | 5454/10000 [00:01<00:01, 2860.63it/s] 57%|█████▋    | 5741/10000 [00:02<00:01, 2860.13it/s] 60%|██████    | 6028/10000 [00:02<00:01, 2859.89it/s] 63%|██████▎   | 6314/10000 [00:02<00:01, 2859.31it/s] 66%|██████▌   | 6600/10000 [00:02<00:01, 2859.14it/s] 69%|██████▉   | 6886/10000 [00:02<00:01, 2857.34it/s] 72%|███████▏  | 7172/10000 [00:02<00:00, 2858.03it/s] 75%|███████▍  | 7459/10000 [00:02<00:00, 2859.87it/s] 77%|███████▋  | 7745/10000 [00:02<00:00, 2859.76it/s] 80%|████████  | 8032/10000 [00:02<00:00, 2860.26it/s] 83%|████████▎ | 8319/10000 [00:02<00:00, 2860.32it/s] 86%|████████▌ | 8606/10000 [00:03<00:00, 2860.54it/s] 89%|████████▉ | 8893/10000 [00:03<00:00, 2859.84it/s] 92%|█████████▏| 9180/10000 [00:03<00:00, 2860.45it/s] 95%|█████████▍| 9467/10000 [00:03<00:00, 2860.10it/s] 98%|█████████▊| 9754/10000 [00:03<00:00, 2860.62it/s]100%|██████████| 10000/10000 [00:03<00:00, 2861.43it/s]
2022-05-22 04:53:30 - Using LF classes: [functools.partial(<class 'sklearn.tree._classes.DecisionTreeClassifier'>, max_depth=1), <class 'sklearn.linear_model._logistic.LogisticRegression'>]
Fitting MulticlassAdaptor... Class 0
  0%|          | 0/23 [00:00<?, ?it/s]  0%|          | 0/23 [2:28:10<?, ?it/s]
Traceback (most recent call last):
  File "fwrench/applications/fashion_mnist.py", line 213, in <module>
    fire.Fire(main)
  File "/home/ubuntu/anaconda3/envs/FWRENCH/lib/python3.7/site-packages/fire/core.py", line 141, in Fire
    component_trace = _Fire(component, args, parsed_flag_args, context, name)
  File "/home/ubuntu/anaconda3/envs/FWRENCH/lib/python3.7/site-packages/fire/core.py", line 471, in _Fire
    target=component.__name__)
  File "/home/ubuntu/anaconda3/envs/FWRENCH/lib/python3.7/site-packages/fire/core.py", line 681, in _CallAndUpdateTrace
    component = fn(*varargs, **kwargs)
  File "fwrench/applications/fashion_mnist.py", line 157, in main
    selector.fit(valid_data_embed, train_data_embed)
  File "/home/ubuntu/FWRENCH/fwrench/utils/utils.py", line 132, in fit
    self.lf_selectors[i].fit(labeled_data_i, unlabeled_data_i)
  File "/home/ubuntu/FWRENCH/fwrench/lf_selectors/snuba_lf_selector.py", line 57, in fit
    model=self.lf_generator, scoring_fn=self.scoring_fn)
  File "/home/ubuntu/FWRENCH/fwrench/lf_selectors/snuba/heuristic_generator.py", line 152, in run_synthesizer
    scoring_fn=scoring_fn)
  File "/home/ubuntu/FWRENCH/fwrench/lf_selectors/snuba/heuristic_generator.py", line 81, in prune_heuristics
    L_temp_train = self.apply_heuristics(heuristics[i], self.train_primitive_matrix, feat_combos[i], beta_opt_temp) 
  File "/home/ubuntu/FWRENCH/fwrench/lf_selectors/snuba/heuristic_generator.py", line 53, in apply_heuristics
    L = np.zeros((np.shape(primitive_matrix)[0],len(heuristics)))
numpy.core._exceptions.MemoryError: Unable to allocate 261. GiB for an array with shape (57000, 613872) and data type float64
