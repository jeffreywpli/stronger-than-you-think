2022-05-22 17:54:59 - loading data from datasets/KMNIST_3000/train.json
  0%|          | 0/57000 [00:00<?, ?it/s]  1%|          | 302/57000 [00:00<00:18, 3010.43it/s]  1%|          | 605/57000 [00:00<00:18, 3018.90it/s]  2%|▏         | 909/57000 [00:00<00:18, 3024.19it/s]  2%|▏         | 1213/57000 [00:00<00:18, 3027.14it/s]  3%|▎         | 1517/57000 [00:00<00:18, 3030.23it/s]  3%|▎         | 1821/57000 [00:00<00:18, 3033.03it/s]  4%|▎         | 2125/57000 [00:00<00:18, 3032.30it/s]  4%|▍         | 2429/57000 [00:00<00:18, 3029.54it/s]  5%|▍         | 2733/57000 [00:00<00:17, 3031.93it/s]  5%|▌         | 3037/57000 [00:01<00:17, 3026.30it/s]  6%|▌         | 3340/57000 [00:01<00:17, 3024.09it/s]  6%|▋         | 3643/57000 [00:01<00:17, 3025.50it/s]  7%|▋         | 3946/57000 [00:01<00:17, 3018.29it/s]  7%|▋         | 4249/57000 [00:01<00:17, 3018.81it/s]  8%|▊         | 4553/57000 [00:01<00:17, 3022.66it/s]  9%|▊         | 4857/57000 [00:01<00:17, 3026.77it/s]  9%|▉         | 5160/57000 [00:01<00:17, 3018.04it/s] 10%|▉         | 5464/57000 [00:01<00:17, 3024.06it/s] 10%|█         | 5768/57000 [00:01<00:16, 3028.27it/s] 11%|█         | 6071/57000 [00:02<00:16, 3026.22it/s] 11%|█         | 6374/57000 [00:02<00:16, 3023.97it/s] 12%|█▏        | 6677/57000 [00:02<00:16, 3023.05it/s] 12%|█▏        | 6980/57000 [00:02<00:16, 3024.67it/s] 13%|█▎        | 7283/57000 [00:02<00:16, 3022.79it/s] 13%|█▎        | 7586/57000 [00:02<00:16, 3018.63it/s] 14%|█▍        | 7890/57000 [00:02<00:16, 3022.02it/s] 14%|█▍        | 8193/57000 [00:02<00:16, 3024.15it/s] 15%|█▍        | 8497/57000 [00:02<00:16, 3026.51it/s] 15%|█▌        | 8801/57000 [00:02<00:15, 3029.31it/s] 16%|█▌        | 9105/57000 [00:03<00:15, 3030.34it/s] 17%|█▋        | 9409/57000 [00:03<00:15, 3029.86it/s] 17%|█▋        | 9712/57000 [00:03<00:15, 3026.18it/s] 18%|█▊        | 10016/57000 [00:03<00:15, 3028.62it/s] 18%|█▊        | 10320/57000 [00:03<00:15, 3031.80it/s] 19%|█▊        | 10624/57000 [00:03<00:15, 3030.15it/s] 19%|█▉        | 10928/57000 [00:03<00:15, 3028.65it/s] 20%|█▉        | 11231/57000 [00:03<00:15, 3027.97it/s] 20%|██        | 11535/57000 [00:03<00:15, 3030.30it/s] 21%|██        | 11839/57000 [00:03<00:14, 3024.06it/s] 21%|██▏       | 12142/57000 [00:04<00:14, 3021.75it/s] 22%|██▏       | 12445/57000 [00:04<00:14, 3023.19it/s] 22%|██▏       | 12748/57000 [00:04<00:14, 3024.06it/s] 23%|██▎       | 13052/57000 [00:04<00:14, 3028.01it/s] 23%|██▎       | 13355/57000 [00:04<00:14, 3027.12it/s] 24%|██▍       | 13658/57000 [00:04<00:14, 3026.86it/s] 24%|██▍       | 13962/57000 [00:04<00:14, 3029.00it/s] 25%|██▌       | 14265/57000 [00:04<00:14, 3028.99it/s] 26%|██▌       | 14569/57000 [00:04<00:14, 3029.79it/s] 26%|██▌       | 14872/57000 [00:04<00:13, 3025.66it/s] 27%|██▋       | 15176/57000 [00:05<00:13, 3027.00it/s] 27%|██▋       | 15479/57000 [00:05<00:13, 3024.50it/s] 28%|██▊       | 15782/57000 [00:05<00:13, 3024.18it/s] 28%|██▊       | 16085/57000 [00:05<00:13, 3023.74it/s] 29%|██▉       | 16388/57000 [00:05<00:13, 3024.95it/s] 29%|██▉       | 16692/57000 [00:05<00:13, 3029.05it/s] 30%|██▉       | 16995/57000 [00:05<00:13, 3028.51it/s] 30%|███       | 17299/57000 [00:05<00:13, 3031.29it/s] 31%|███       | 17603/57000 [00:05<00:12, 3031.60it/s] 31%|███▏      | 17907/57000 [00:05<00:12, 3029.15it/s] 32%|███▏      | 18211/57000 [00:06<00:12, 3030.68it/s] 32%|███▏      | 18515/57000 [00:06<00:12, 3030.59it/s] 33%|███▎      | 18819/57000 [00:06<00:12, 3030.37it/s] 34%|███▎      | 19123/57000 [00:06<00:12, 3028.64it/s] 34%|███▍      | 19426/57000 [00:06<00:12, 3027.35it/s] 35%|███▍      | 19729/57000 [00:06<00:12, 3024.04it/s] 35%|███▌      | 20032/57000 [00:06<00:12, 3019.26it/s] 36%|███▌      | 20336/57000 [00:06<00:12, 3024.47it/s] 36%|███▌      | 20639/57000 [00:06<00:12, 3023.41it/s] 37%|███▋      | 20943/57000 [00:06<00:11, 3025.71it/s] 37%|███▋      | 21246/57000 [00:07<00:11, 3025.09it/s] 38%|███▊      | 21550/57000 [00:07<00:11, 3027.05it/s] 38%|███▊      | 21854/57000 [00:07<00:11, 3028.37it/s] 39%|███▉      | 22157/57000 [00:07<00:11, 3027.52it/s] 39%|███▉      | 22460/57000 [00:07<00:11, 3027.09it/s] 40%|███▉      | 22763/57000 [00:07<00:11, 3025.63it/s] 40%|████      | 23066/57000 [00:07<00:11, 3026.74it/s] 41%|████      | 23370/57000 [00:07<00:11, 3028.57it/s] 42%|████▏     | 23673/57000 [00:07<00:11, 3027.92it/s] 42%|████▏     | 23976/57000 [00:07<00:10, 3023.40it/s] 43%|████▎     | 24279/57000 [00:08<00:10, 3020.92it/s] 43%|████▎     | 24582/57000 [00:08<00:10, 3023.60it/s] 44%|████▎     | 24885/57000 [00:08<00:10, 3024.86it/s] 44%|████▍     | 25188/57000 [00:08<00:10, 3019.02it/s] 45%|████▍     | 25492/57000 [00:08<00:10, 3024.68it/s] 45%|████▌     | 25796/57000 [00:08<00:10, 3026.77it/s] 46%|████▌     | 26100/57000 [00:08<00:10, 3028.56it/s] 46%|████▋     | 26404/57000 [00:08<00:10, 3030.49it/s] 47%|████▋     | 26708/57000 [00:08<00:10, 3028.72it/s] 47%|████▋     | 27011/57000 [00:08<00:09, 3026.46it/s] 48%|████▊     | 27314/57000 [00:09<00:09, 3020.15it/s] 48%|████▊     | 27617/57000 [00:09<00:09, 3022.09it/s] 49%|████▉     | 27920/57000 [00:09<00:09, 3024.39it/s] 50%|████▉     | 28223/57000 [00:09<00:09, 3020.82it/s] 50%|█████     | 28527/57000 [00:09<00:09, 3023.70it/s] 51%|█████     | 28830/57000 [00:09<00:09, 3024.16it/s] 51%|█████     | 29133/57000 [00:09<00:09, 3024.21it/s] 52%|█████▏    | 29436/57000 [00:09<00:09, 3019.81it/s] 52%|█████▏    | 29739/57000 [00:09<00:09, 3020.57it/s] 53%|█████▎    | 30042/57000 [00:09<00:08, 3020.40it/s] 53%|█████▎    | 30345/57000 [00:10<00:08, 3015.01it/s] 54%|█████▍    | 30647/57000 [00:10<00:08, 3016.32it/s] 54%|█████▍    | 30949/57000 [00:10<00:08, 3011.68it/s] 55%|█████▍    | 31252/57000 [00:10<00:08, 3015.62it/s] 55%|█████▌    | 31556/57000 [00:10<00:08, 3020.14it/s] 56%|█████▌    | 31859/57000 [00:10<00:08, 3013.54it/s] 56%|█████▋    | 32163/57000 [00:10<00:08, 3020.11it/s] 57%|█████▋    | 32466/57000 [00:10<00:08, 3022.21it/s] 57%|█████▋    | 32769/57000 [00:10<00:08, 3022.44it/s] 58%|█████▊    | 33072/57000 [00:10<00:07, 3016.20it/s] 59%|█████▊    | 33374/57000 [00:11<00:07, 3010.15it/s] 59%|█████▉    | 33676/57000 [00:11<00:07, 3011.33it/s] 60%|█████▉    | 33978/57000 [00:11<00:07, 3009.80it/s] 60%|██████    | 34281/57000 [00:11<00:07, 3013.95it/s] 61%|██████    | 34583/57000 [00:11<00:07, 3012.63it/s] 61%|██████    | 34886/57000 [00:11<00:07, 3016.44it/s] 62%|██████▏   | 35189/57000 [00:11<00:07, 3018.10it/s] 62%|██████▏   | 35492/57000 [00:11<00:07, 3018.37it/s] 63%|██████▎   | 35794/57000 [00:11<00:07, 3015.71it/s] 63%|██████▎   | 36097/57000 [00:11<00:06, 3018.37it/s] 64%|██████▍   | 36401/57000 [00:12<00:06, 3023.47it/s] 64%|██████▍   | 36704/57000 [00:12<00:06, 3022.76it/s] 65%|██████▍   | 37008/57000 [00:12<00:06, 3025.47it/s] 65%|██████▌   | 37311/57000 [00:12<00:06, 3025.79it/s] 66%|██████▌   | 37614/57000 [00:12<00:06, 3022.25it/s] 67%|██████▋   | 37917/57000 [00:12<00:06, 3024.16it/s] 67%|██████▋   | 38220/57000 [00:12<00:06, 3021.98it/s] 68%|██████▊   | 38523/57000 [00:12<00:06, 3022.91it/s] 68%|██████▊   | 38826/57000 [00:12<00:06, 3024.72it/s] 69%|██████▊   | 39129/57000 [00:12<00:05, 3023.13it/s] 69%|██████▉   | 39432/57000 [00:13<00:05, 3024.54it/s] 70%|██████▉   | 39735/57000 [00:13<00:05, 3024.98it/s] 70%|███████   | 40038/57000 [00:13<00:05, 3025.58it/s] 71%|███████   | 40341/57000 [00:13<00:05, 3015.86it/s] 71%|███████▏  | 40643/57000 [00:13<00:05, 3015.58it/s] 72%|███████▏  | 40946/57000 [00:13<00:05, 3019.39it/s] 72%|███████▏  | 41248/57000 [00:13<00:05, 3018.40it/s] 73%|███████▎  | 41551/57000 [00:13<00:05, 3021.42it/s] 73%|███████▎  | 41855/57000 [00:13<00:05, 3024.55it/s] 74%|███████▍  | 42158/57000 [00:13<00:04, 3023.73it/s] 74%|███████▍  | 42461/57000 [00:14<00:04, 3022.87it/s] 75%|███████▌  | 42764/57000 [00:14<00:04, 3023.02it/s] 76%|███████▌  | 43067/57000 [00:14<00:04, 3018.61it/s] 76%|███████▌  | 43369/57000 [00:14<00:04, 3015.95it/s] 77%|███████▋  | 43672/57000 [00:14<00:04, 3018.94it/s] 77%|███████▋  | 43975/57000 [00:14<00:04, 3019.45it/s] 78%|███████▊  | 44278/57000 [00:14<00:04, 3020.20it/s] 78%|███████▊  | 44582/57000 [00:14<00:04, 3023.17it/s] 79%|███████▊  | 44885/57000 [00:14<00:04, 3024.16it/s] 79%|███████▉  | 45188/57000 [00:14<00:03, 3019.99it/s] 80%|███████▉  | 45492/57000 [00:15<00:03, 3023.55it/s] 80%|████████  | 45795/57000 [00:15<00:03, 3025.06it/s] 81%|████████  | 46099/57000 [00:15<00:03, 3028.27it/s] 81%|████████▏ | 46402/57000 [00:15<00:03, 3024.68it/s] 82%|████████▏ | 46706/57000 [00:15<00:03, 3027.23it/s] 82%|████████▏ | 47009/57000 [00:15<00:03, 3026.70it/s] 83%|████████▎ | 47312/57000 [00:15<00:03, 3027.47it/s] 84%|████████▎ | 47615/57000 [00:15<00:03, 3027.97it/s] 84%|████████▍ | 47918/57000 [00:15<00:03, 3026.45it/s] 85%|████████▍ | 48221/57000 [00:15<00:02, 3025.13it/s] 85%|████████▌ | 48524/57000 [00:16<00:02, 3019.73it/s] 86%|████████▌ | 48828/57000 [00:16<00:02, 3024.50it/s] 86%|████████▌ | 49131/57000 [00:16<00:02, 3023.40it/s] 87%|████████▋ | 49434/57000 [00:16<00:02, 3020.56it/s] 87%|████████▋ | 49737/57000 [00:16<00:02, 3022.78it/s] 88%|████████▊ | 50040/57000 [00:16<00:02, 3021.25it/s] 88%|████████▊ | 50343/57000 [00:16<00:02, 3023.26it/s] 89%|████████▉ | 50646/57000 [00:16<00:02, 3021.61it/s] 89%|████████▉ | 50949/57000 [00:16<00:02, 3012.84it/s] 90%|████████▉ | 51252/57000 [00:16<00:01, 3017.50it/s] 90%|█████████ | 51554/57000 [00:17<00:01, 3017.63it/s] 91%|█████████ | 51857/57000 [00:17<00:01, 3020.82it/s] 92%|█████████▏| 52160/57000 [00:17<00:01, 3021.41it/s] 92%|█████████▏| 52463/57000 [00:17<00:01, 3022.23it/s] 93%|█████████▎| 52766/57000 [00:17<00:01, 3023.48it/s] 93%|█████████▎| 53069/57000 [00:17<00:01, 3021.16it/s] 94%|█████████▎| 53372/57000 [00:17<00:01, 3022.20it/s] 94%|█████████▍| 53675/57000 [00:17<00:01, 3023.68it/s] 95%|█████████▍| 53978/57000 [00:17<00:00, 3025.44it/s] 95%|█████████▌| 54281/57000 [00:17<00:00, 3019.57it/s] 96%|█████████▌| 54583/57000 [00:18<00:00, 3013.28it/s] 96%|█████████▋| 54886/57000 [00:18<00:00, 3016.28it/s] 97%|█████████▋| 55189/57000 [00:18<00:00, 3019.53it/s] 97%|█████████▋| 55492/57000 [00:18<00:00, 3021.14it/s] 98%|█████████▊| 55795/57000 [00:18<00:00, 3021.71it/s] 98%|█████████▊| 56098/57000 [00:18<00:00, 3022.18it/s] 99%|█████████▉| 56402/57000 [00:18<00:00, 3024.85it/s] 99%|█████████▉| 56705/57000 [00:18<00:00, 3021.03it/s]100%|██████████| 57000/57000 [00:18<00:00, 3023.31it/s]
2022-05-22 17:55:18 - loading data from datasets/KMNIST_3000/valid.json
  0%|          | 0/3000 [00:00<?, ?it/s] 10%|█         | 303/3000 [00:00<00:00, 3020.00it/s] 20%|██        | 607/3000 [00:00<00:00, 3025.96it/s] 30%|███       | 910/3000 [00:00<00:00, 3027.38it/s] 40%|████      | 1213/3000 [00:00<00:00, 3027.51it/s] 51%|█████     | 1517/3000 [00:00<00:00, 3030.28it/s] 61%|██████    | 1821/3000 [00:00<00:00, 3031.03it/s] 71%|███████   | 2125/3000 [00:00<00:00, 3031.21it/s] 81%|████████  | 2429/3000 [00:00<00:00, 3029.90it/s] 91%|█████████ | 2733/3000 [00:00<00:00, 3031.12it/s]100%|██████████| 3000/3000 [00:00<00:00, 3028.95it/s]
2022-05-22 17:55:19 - loading data from datasets/KMNIST_3000/test.json
  0%|          | 0/10000 [00:00<?, ?it/s]  3%|▎         | 303/10000 [00:00<00:03, 3020.95it/s]  6%|▌         | 606/10000 [00:00<00:03, 3018.89it/s]  9%|▉         | 910/10000 [00:00<00:03, 3027.68it/s] 12%|█▏        | 1214/10000 [00:00<00:02, 3030.98it/s] 15%|█▌        | 1518/10000 [00:00<00:02, 3030.69it/s] 18%|█▊        | 1822/10000 [00:00<00:02, 3030.71it/s] 21%|██▏       | 2126/10000 [00:00<00:02, 3028.25it/s] 24%|██▍       | 2429/10000 [00:00<00:02, 3027.38it/s] 27%|██▋       | 2732/10000 [00:00<00:02, 3026.21it/s] 30%|███       | 3035/10000 [00:01<00:02, 3025.82it/s] 33%|███▎      | 3338/10000 [00:01<00:02, 3024.48it/s] 36%|███▋      | 3641/10000 [00:01<00:02, 3023.75it/s] 39%|███▉      | 3944/10000 [00:01<00:02, 3023.11it/s] 42%|████▏     | 4247/10000 [00:01<00:01, 3023.70it/s] 46%|████▌     | 4550/10000 [00:01<00:01, 3023.93it/s] 49%|████▊     | 4853/10000 [00:01<00:01, 3025.62it/s] 52%|█████▏    | 5156/10000 [00:01<00:01, 3024.91it/s] 55%|█████▍    | 5459/10000 [00:01<00:01, 3023.77it/s] 58%|█████▊    | 5762/10000 [00:01<00:01, 3023.79it/s] 61%|██████    | 6065/10000 [00:02<00:01, 3021.39it/s] 64%|██████▎   | 6368/10000 [00:02<00:01, 3023.93it/s] 67%|██████▋   | 6671/10000 [00:02<00:01, 3023.86it/s] 70%|██████▉   | 6975/10000 [00:02<00:00, 3026.05it/s] 73%|███████▎  | 7278/10000 [00:02<00:00, 3025.27it/s] 76%|███████▌  | 7581/10000 [00:02<00:00, 3025.64it/s] 79%|███████▉  | 7884/10000 [00:02<00:00, 3025.50it/s] 82%|████████▏ | 8187/10000 [00:02<00:00, 3025.13it/s] 85%|████████▍ | 8490/10000 [00:02<00:00, 3024.71it/s] 88%|████████▊ | 8793/10000 [00:02<00:00, 3023.72it/s] 91%|█████████ | 9096/10000 [00:03<00:00, 3023.93it/s] 94%|█████████▍| 9399/10000 [00:03<00:00, 3022.67it/s] 97%|█████████▋| 9702/10000 [00:03<00:00, 3021.30it/s]100%|██████████| 10000/10000 [00:03<00:00, 3024.68it/s]
2022-05-22 17:55:28 - Using LF classes: [functools.partial(<class 'sklearn.tree._classes.DecisionTreeClassifier'>, max_depth=1), <class 'sklearn.linear_model._logistic.LogisticRegression'>]
Fitting MulticlassAdaptor... Class 0
  0%|          | 0/23 [00:00<?, ?it/s]  0%|          | 0/23 [2:47:55<?, ?it/s]
Traceback (most recent call last):
  File "fwrench/applications/kmnist.py", line 213, in <module>
    fire.Fire(main)
  File "/home/ubuntu/anaconda3/envs/FWRENCH/lib/python3.7/site-packages/fire/core.py", line 141, in Fire
    component_trace = _Fire(component, args, parsed_flag_args, context, name)
  File "/home/ubuntu/anaconda3/envs/FWRENCH/lib/python3.7/site-packages/fire/core.py", line 471, in _Fire
    target=component.__name__)
  File "/home/ubuntu/anaconda3/envs/FWRENCH/lib/python3.7/site-packages/fire/core.py", line 681, in _CallAndUpdateTrace
    component = fn(*varargs, **kwargs)
  File "fwrench/applications/kmnist.py", line 157, in main
    selector.fit(valid_data_embed, train_data_embed)
  File "/home/ubuntu/FWRENCH/fwrench/utils/utils.py", line 132, in fit
    self.lf_selectors[i].fit(labeled_data_i, unlabeled_data_i)
  File "/home/ubuntu/FWRENCH/fwrench/lf_selectors/snuba_lf_selector.py", line 57, in fit
    model=self.lf_generator, scoring_fn=self.scoring_fn)
  File "/home/ubuntu/FWRENCH/fwrench/lf_selectors/snuba/heuristic_generator.py", line 152, in run_synthesizer
    scoring_fn=scoring_fn)
  File "/home/ubuntu/FWRENCH/fwrench/lf_selectors/snuba/heuristic_generator.py", line 81, in prune_heuristics
    L_temp_train = self.apply_heuristics(heuristics[i], self.train_primitive_matrix, feat_combos[i], beta_opt_temp) 
  File "/home/ubuntu/FWRENCH/fwrench/lf_selectors/snuba/heuristic_generator.py", line 53, in apply_heuristics
    L = np.zeros((np.shape(primitive_matrix)[0],len(heuristics)))
numpy.core._exceptions.MemoryError: Unable to allocate 261. GiB for an array with shape (57000, 613872) and data type float64
