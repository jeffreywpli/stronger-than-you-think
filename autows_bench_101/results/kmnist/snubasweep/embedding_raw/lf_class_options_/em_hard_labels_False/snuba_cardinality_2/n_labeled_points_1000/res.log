2022-05-22 20:45:29 - loading data from datasets/KMNIST_3000/train.json
  0%|          | 0/57000 [00:00<?, ?it/s]  1%|          | 298/57000 [00:00<00:19, 2976.43it/s]  1%|          | 597/57000 [00:00<00:18, 2980.53it/s]  2%|▏         | 897/57000 [00:00<00:18, 2989.31it/s]  2%|▏         | 1198/57000 [00:00<00:18, 2993.66it/s]  3%|▎         | 1499/57000 [00:00<00:18, 2998.30it/s]  3%|▎         | 1799/57000 [00:00<00:18, 2997.28it/s]  4%|▎         | 2099/57000 [00:00<00:18, 2996.56it/s]  4%|▍         | 2399/57000 [00:00<00:18, 2995.11it/s]  5%|▍         | 2699/57000 [00:00<00:18, 2995.92it/s]  5%|▌         | 3000/57000 [00:01<00:18, 2997.54it/s]  6%|▌         | 3301/57000 [00:01<00:17, 2998.98it/s]  6%|▋         | 3601/57000 [00:01<00:17, 2998.71it/s]  7%|▋         | 3901/57000 [00:01<00:17, 2996.50it/s]  7%|▋         | 4201/57000 [00:01<00:17, 2996.98it/s]  8%|▊         | 4501/57000 [00:01<00:17, 2994.09it/s]  8%|▊         | 4801/57000 [00:01<00:17, 2995.52it/s]  9%|▉         | 5101/57000 [00:01<00:17, 2996.59it/s]  9%|▉         | 5401/57000 [00:01<00:17, 2996.50it/s] 10%|█         | 5702/57000 [00:01<00:17, 2997.43it/s] 11%|█         | 6002/57000 [00:02<00:17, 2990.61it/s] 11%|█         | 6302/57000 [00:02<00:16, 2988.40it/s] 12%|█▏        | 6602/57000 [00:02<00:16, 2991.60it/s] 12%|█▏        | 6903/57000 [00:02<00:16, 2994.33it/s] 13%|█▎        | 7204/57000 [00:02<00:16, 2997.49it/s] 13%|█▎        | 7504/57000 [00:02<00:16, 2994.42it/s] 14%|█▎        | 7805/57000 [00:02<00:16, 2996.15it/s] 14%|█▍        | 8106/57000 [00:02<00:16, 2997.70it/s] 15%|█▍        | 8406/57000 [00:02<00:16, 2996.47it/s] 15%|█▌        | 8707/57000 [00:02<00:16, 2999.59it/s] 16%|█▌        | 9008/57000 [00:03<00:15, 3001.31it/s] 16%|█▋        | 9310/57000 [00:03<00:15, 3004.27it/s] 17%|█▋        | 9611/57000 [00:03<00:15, 3000.36it/s] 17%|█▋        | 9912/57000 [00:03<00:15, 2998.94it/s] 18%|█▊        | 10213/57000 [00:03<00:15, 3001.10it/s] 18%|█▊        | 10514/57000 [00:03<00:15, 2999.76it/s] 19%|█▉        | 10814/57000 [00:03<00:15, 2990.94it/s] 19%|█▉        | 11114/57000 [00:03<00:15, 2989.90it/s] 20%|██        | 11415/57000 [00:03<00:15, 2995.80it/s] 21%|██        | 11717/57000 [00:03<00:15, 3001.69it/s] 21%|██        | 12018/57000 [00:04<00:15, 2998.31it/s] 22%|██▏       | 12319/57000 [00:04<00:14, 3000.91it/s] 22%|██▏       | 12620/57000 [00:04<00:14, 2999.97it/s] 23%|██▎       | 12921/57000 [00:04<00:14, 3002.87it/s] 23%|██▎       | 13223/57000 [00:04<00:14, 3005.71it/s] 24%|██▎       | 13524/57000 [00:04<00:14, 3005.88it/s] 24%|██▍       | 13826/57000 [00:04<00:14, 3008.33it/s] 25%|██▍       | 14127/57000 [00:04<00:14, 3004.57it/s] 25%|██▌       | 14429/57000 [00:04<00:14, 3006.97it/s] 26%|██▌       | 14731/57000 [00:04<00:14, 3009.62it/s] 26%|██▋       | 15033/57000 [00:05<00:13, 3010.83it/s] 27%|██▋       | 15335/57000 [00:05<00:13, 3012.40it/s] 27%|██▋       | 15637/57000 [00:05<00:13, 3006.70it/s] 28%|██▊       | 15939/57000 [00:05<00:13, 3008.58it/s] 28%|██▊       | 16240/57000 [00:05<00:13, 3005.19it/s] 29%|██▉       | 16541/57000 [00:05<00:13, 3006.25it/s] 30%|██▉       | 16842/57000 [00:05<00:13, 3003.16it/s] 30%|███       | 17143/57000 [00:05<00:13, 3000.67it/s] 31%|███       | 17444/57000 [00:05<00:13, 3001.94it/s] 31%|███       | 17745/57000 [00:05<00:13, 2997.68it/s] 32%|███▏      | 18046/57000 [00:06<00:12, 3000.52it/s] 32%|███▏      | 18347/57000 [00:06<00:12, 3001.84it/s] 33%|███▎      | 18648/57000 [00:06<00:12, 2995.64it/s] 33%|███▎      | 18948/57000 [00:06<00:12, 2994.17it/s] 34%|███▍      | 19248/57000 [00:06<00:12, 2995.43it/s] 34%|███▍      | 19549/57000 [00:06<00:12, 2997.43it/s] 35%|███▍      | 19849/57000 [00:06<00:12, 2995.73it/s] 35%|███▌      | 20151/57000 [00:06<00:12, 3000.43it/s] 36%|███▌      | 20452/57000 [00:06<00:12, 3002.48it/s] 36%|███▋      | 20753/57000 [00:06<00:12, 3002.43it/s] 37%|███▋      | 21054/57000 [00:07<00:11, 3003.57it/s] 37%|███▋      | 21356/57000 [00:07<00:11, 3006.05it/s] 38%|███▊      | 21657/57000 [00:07<00:11, 3004.80it/s] 39%|███▊      | 21959/57000 [00:07<00:11, 3006.49it/s] 39%|███▉      | 22260/57000 [00:07<00:11, 2999.55it/s] 40%|███▉      | 22562/57000 [00:07<00:11, 3003.46it/s] 40%|████      | 22863/57000 [00:07<00:11, 3002.31it/s] 41%|████      | 23164/57000 [00:07<00:11, 3003.39it/s] 41%|████      | 23465/57000 [00:07<00:11, 3002.48it/s] 42%|████▏     | 23766/57000 [00:07<00:11, 3002.94it/s] 42%|████▏     | 24067/57000 [00:08<00:10, 3003.16it/s] 43%|████▎     | 24368/57000 [00:08<00:10, 3001.45it/s] 43%|████▎     | 24669/57000 [00:08<00:10, 3002.08it/s] 44%|████▍     | 24970/57000 [00:08<00:10, 2999.50it/s] 44%|████▍     | 25270/57000 [00:08<00:10, 2989.41it/s] 45%|████▍     | 25571/57000 [00:08<00:10, 2994.59it/s] 45%|████▌     | 25872/57000 [00:08<00:10, 2997.94it/s] 46%|████▌     | 26173/57000 [00:08<00:10, 2999.40it/s] 46%|████▋     | 26473/57000 [00:08<00:10, 2999.17it/s] 47%|████▋     | 26774/57000 [00:08<00:10, 3000.29it/s] 48%|████▊     | 27075/57000 [00:09<00:09, 3002.01it/s] 48%|████▊     | 27376/57000 [00:09<00:09, 2999.36it/s] 49%|████▊     | 27677/57000 [00:09<00:09, 3000.69it/s] 49%|████▉     | 27978/57000 [00:09<00:09, 2998.63it/s] 50%|████▉     | 28278/57000 [00:09<00:09, 2993.70it/s] 50%|█████     | 28580/57000 [00:09<00:09, 2998.77it/s] 51%|█████     | 28880/57000 [00:09<00:09, 2997.41it/s] 51%|█████     | 29181/57000 [00:09<00:09, 2999.74it/s] 52%|█████▏    | 29481/57000 [00:09<00:09, 2994.05it/s] 52%|█████▏    | 29782/57000 [00:09<00:09, 2998.05it/s] 53%|█████▎    | 30082/57000 [00:10<00:08, 2998.21it/s] 53%|█████▎    | 30382/57000 [00:10<00:08, 2998.66it/s] 54%|█████▍    | 30682/57000 [00:10<00:08, 2998.75it/s] 54%|█████▍    | 30982/57000 [00:10<00:08, 2993.72it/s] 55%|█████▍    | 31282/57000 [00:10<00:08, 2993.37it/s] 55%|█████▌    | 31582/57000 [00:10<00:08, 2994.84it/s] 56%|█████▌    | 31882/57000 [00:10<00:08, 2992.07it/s] 56%|█████▋    | 32184/57000 [00:10<00:08, 2997.56it/s] 57%|█████▋    | 32484/57000 [00:10<00:08, 2998.00it/s] 58%|█████▊    | 32785/57000 [00:10<00:08, 2998.65it/s] 58%|█████▊    | 33085/57000 [00:11<00:07, 2994.98it/s] 59%|█████▊    | 33385/57000 [00:11<00:07, 2996.44it/s] 59%|█████▉    | 33686/57000 [00:11<00:07, 2998.24it/s] 60%|█████▉    | 33986/57000 [00:11<00:07, 2998.68it/s] 60%|██████    | 34286/57000 [00:11<00:07, 2998.07it/s] 61%|██████    | 34586/57000 [00:11<00:07, 2990.65it/s] 61%|██████    | 34887/57000 [00:11<00:07, 2994.76it/s] 62%|██████▏   | 35188/57000 [00:11<00:07, 2996.93it/s] 62%|██████▏   | 35488/57000 [00:11<00:07, 2996.29it/s] 63%|██████▎   | 35788/57000 [00:11<00:07, 2992.46it/s] 63%|██████▎   | 36089/57000 [00:12<00:06, 2997.62it/s] 64%|██████▍   | 36390/57000 [00:12<00:06, 3000.58it/s] 64%|██████▍   | 36691/57000 [00:12<00:06, 2999.79it/s] 65%|██████▍   | 36992/57000 [00:12<00:06, 3001.17it/s] 65%|██████▌   | 37293/57000 [00:12<00:06, 3001.02it/s] 66%|██████▌   | 37594/57000 [00:12<00:06, 3000.99it/s] 66%|██████▋   | 37895/57000 [00:12<00:06, 2993.88it/s] 67%|██████▋   | 38195/57000 [00:12<00:06, 2990.13it/s] 68%|██████▊   | 38495/57000 [00:12<00:06, 2990.33it/s] 68%|██████▊   | 38796/57000 [00:12<00:06, 2993.84it/s] 69%|██████▊   | 39096/57000 [00:13<00:05, 2989.83it/s] 69%|██████▉   | 39397/57000 [00:13<00:05, 2992.89it/s] 70%|██████▉   | 39698/57000 [00:13<00:05, 2995.89it/s] 70%|███████   | 39999/57000 [00:13<00:05, 3000.05it/s] 71%|███████   | 40300/57000 [00:13<00:05, 2995.45it/s] 71%|███████   | 40601/57000 [00:13<00:05, 2998.74it/s] 72%|███████▏  | 40902/57000 [00:13<00:05, 3000.35it/s] 72%|███████▏  | 41203/57000 [00:13<00:05, 2999.77it/s] 73%|███████▎  | 41504/57000 [00:13<00:05, 3002.47it/s] 73%|███████▎  | 41805/57000 [00:13<00:05, 3004.68it/s] 74%|███████▍  | 42106/57000 [00:14<00:04, 3004.80it/s] 74%|███████▍  | 42407/57000 [00:14<00:04, 3005.83it/s] 75%|███████▍  | 42708/57000 [00:14<00:04, 3006.26it/s] 75%|███████▌  | 43010/57000 [00:14<00:04, 3007.76it/s] 76%|███████▌  | 43311/57000 [00:14<00:04, 3006.98it/s] 77%|███████▋  | 43612/57000 [00:14<00:04, 3006.70it/s] 77%|███████▋  | 43913/57000 [00:14<00:04, 3004.05it/s] 78%|███████▊  | 44214/57000 [00:14<00:04, 3003.19it/s] 78%|███████▊  | 44516/57000 [00:14<00:04, 3005.79it/s] 79%|███████▊  | 44818/57000 [00:14<00:04, 3006.94it/s] 79%|███████▉  | 45120/57000 [00:15<00:03, 3008.27it/s] 80%|███████▉  | 45421/57000 [00:15<00:03, 3002.12it/s] 80%|████████  | 45722/57000 [00:15<00:03, 3004.01it/s] 81%|████████  | 46024/57000 [00:15<00:03, 3008.68it/s] 81%|████████▏ | 46325/57000 [00:15<00:03, 2995.12it/s] 82%|████████▏ | 46625/57000 [00:15<00:03, 2994.13it/s] 82%|████████▏ | 46926/57000 [00:15<00:03, 2997.89it/s] 83%|████████▎ | 47227/57000 [00:15<00:03, 3001.37it/s] 83%|████████▎ | 47529/57000 [00:15<00:03, 3004.17it/s] 84%|████████▍ | 47831/57000 [00:15<00:03, 3006.03it/s] 84%|████████▍ | 48133/57000 [00:16<00:02, 3007.26it/s] 85%|████████▍ | 48434/57000 [00:16<00:02, 3004.94it/s] 86%|████████▌ | 48735/57000 [00:16<00:02, 3004.48it/s] 86%|████████▌ | 49036/57000 [00:16<00:02, 3001.95it/s] 87%|████████▋ | 49337/57000 [00:16<00:02, 2999.70it/s] 87%|████████▋ | 49638/57000 [00:16<00:02, 3001.54it/s] 88%|████████▊ | 49939/57000 [00:16<00:02, 3002.83it/s] 88%|████████▊ | 50241/57000 [00:16<00:02, 3005.34it/s] 89%|████████▊ | 50543/57000 [00:16<00:02, 3006.90it/s] 89%|████████▉ | 50844/57000 [00:16<00:02, 2995.73it/s] 90%|████████▉ | 51146/57000 [00:17<00:01, 3001.55it/s] 90%|█████████ | 51449/57000 [00:17<00:01, 3007.04it/s] 91%|█████████ | 51751/57000 [00:17<00:01, 3008.82it/s] 91%|█████████▏| 52054/57000 [00:17<00:01, 3012.13it/s] 92%|█████████▏| 52356/57000 [00:17<00:01, 3008.22it/s] 92%|█████████▏| 52658/57000 [00:17<00:01, 3008.70it/s] 93%|█████████▎| 52959/57000 [00:17<00:01, 2997.31it/s] 93%|█████████▎| 53260/57000 [00:17<00:01, 2998.19it/s] 94%|█████████▍| 53561/57000 [00:17<00:01, 2999.86it/s] 94%|█████████▍| 53862/57000 [00:17<00:01, 3001.16it/s] 95%|█████████▌| 54164/57000 [00:18<00:00, 3004.17it/s] 96%|█████████▌| 54465/57000 [00:18<00:00, 3001.89it/s] 96%|█████████▌| 54766/57000 [00:18<00:00, 3003.79it/s] 97%|█████████▋| 55067/57000 [00:18<00:00, 3005.51it/s] 97%|█████████▋| 55368/57000 [00:18<00:00, 3003.49it/s] 98%|█████████▊| 55669/57000 [00:18<00:00, 3000.82it/s] 98%|█████████▊| 55970/57000 [00:18<00:00, 3001.88it/s] 99%|█████████▊| 56272/57000 [00:18<00:00, 3004.75it/s] 99%|█████████▉| 56573/57000 [00:18<00:00, 3004.41it/s]100%|█████████▉| 56874/57000 [00:18<00:00, 3005.53it/s]100%|██████████| 57000/57000 [00:18<00:00, 3000.05it/s]
2022-05-22 20:45:49 - loading data from datasets/KMNIST_3000/valid.json
  0%|          | 0/3000 [00:00<?, ?it/s] 10%|█         | 300/3000 [00:00<00:00, 2997.51it/s] 20%|██        | 602/3000 [00:00<00:00, 3005.02it/s] 30%|███       | 904/3000 [00:00<00:00, 3007.96it/s] 40%|████      | 1205/3000 [00:00<00:00, 3005.05it/s] 50%|█████     | 1507/3000 [00:00<00:00, 3007.00it/s] 60%|██████    | 1808/3000 [00:00<00:00, 3006.22it/s] 70%|███████   | 2109/3000 [00:00<00:00, 3003.44it/s] 80%|████████  | 2410/3000 [00:00<00:00, 2997.17it/s] 90%|█████████ | 2711/3000 [00:00<00:00, 2999.06it/s]100%|██████████| 3000/3000 [00:00<00:00, 3000.32it/s]
2022-05-22 20:45:50 - loading data from datasets/KMNIST_3000/test.json
  0%|          | 0/10000 [00:00<?, ?it/s]  3%|▎         | 299/10000 [00:00<00:03, 2984.22it/s]  6%|▌         | 599/10000 [00:00<00:03, 2986.93it/s]  9%|▉         | 899/10000 [00:00<00:03, 2991.61it/s] 12%|█▏        | 1200/10000 [00:00<00:02, 2994.27it/s] 15%|█▌        | 1500/10000 [00:00<00:02, 2994.84it/s] 18%|█▊        | 1800/10000 [00:00<00:02, 2987.28it/s] 21%|██        | 2099/10000 [00:00<00:02, 2979.56it/s] 24%|██▍       | 2397/10000 [00:00<00:02, 2978.45it/s] 27%|██▋       | 2697/10000 [00:00<00:02, 2982.69it/s] 30%|██▉       | 2997/10000 [00:01<00:02, 2986.15it/s] 33%|███▎      | 3297/10000 [00:01<00:02, 2989.73it/s] 36%|███▌      | 3597/10000 [00:01<00:02, 2992.69it/s] 39%|███▉      | 3897/10000 [00:01<00:02, 2994.18it/s] 42%|████▏     | 4197/10000 [00:01<00:01, 2988.95it/s] 45%|████▍     | 4496/10000 [00:01<00:01, 2981.75it/s] 48%|████▊     | 4795/10000 [00:01<00:01, 2983.05it/s] 51%|█████     | 5095/10000 [00:01<00:01, 2987.74it/s] 54%|█████▍    | 5395/10000 [00:01<00:01, 2989.05it/s] 57%|█████▋    | 5696/10000 [00:01<00:01, 2992.31it/s] 60%|█████▉    | 5996/10000 [00:02<00:01, 2993.55it/s] 63%|██████▎   | 6297/10000 [00:02<00:01, 2995.59it/s] 66%|██████▌   | 6597/10000 [00:02<00:01, 2994.67it/s] 69%|██████▉   | 6897/10000 [00:02<00:01, 2994.12it/s] 72%|███████▏  | 7197/10000 [00:02<00:00, 2994.60it/s] 75%|███████▍  | 7497/10000 [00:02<00:00, 2988.10it/s] 78%|███████▊  | 7797/10000 [00:02<00:00, 2989.45it/s] 81%|████████  | 8097/10000 [00:02<00:00, 2990.66it/s] 84%|████████▍ | 8398/10000 [00:02<00:00, 2994.73it/s] 87%|████████▋ | 8698/10000 [00:02<00:00, 2994.16it/s] 90%|████████▉ | 8999/10000 [00:03<00:00, 2996.97it/s] 93%|█████████▎| 9299/10000 [00:03<00:00, 2996.57it/s] 96%|█████████▌| 9599/10000 [00:03<00:00, 2996.43it/s] 99%|█████████▉| 9899/10000 [00:03<00:00, 2994.32it/s]100%|██████████| 10000/10000 [00:03<00:00, 2990.27it/s]
2022-05-22 20:45:59 - Using LF classes: [functools.partial(<class 'sklearn.tree._classes.DecisionTreeClassifier'>, max_depth=1), <class 'sklearn.linear_model._logistic.LogisticRegression'>]
Fitting MulticlassAdaptor... Class 0
  0%|          | 0/23 [00:00<?, ?it/s]  0%|          | 0/23 [3:05:06<?, ?it/s]
Traceback (most recent call last):
  File "fwrench/applications/kmnist.py", line 213, in <module>
    fire.Fire(main)
  File "/home/ubuntu/anaconda3/envs/FWRENCH/lib/python3.7/site-packages/fire/core.py", line 141, in Fire
    component_trace = _Fire(component, args, parsed_flag_args, context, name)
  File "/home/ubuntu/anaconda3/envs/FWRENCH/lib/python3.7/site-packages/fire/core.py", line 471, in _Fire
    target=component.__name__)
  File "/home/ubuntu/anaconda3/envs/FWRENCH/lib/python3.7/site-packages/fire/core.py", line 681, in _CallAndUpdateTrace
    component = fn(*varargs, **kwargs)
  File "fwrench/applications/kmnist.py", line 157, in main
    selector.fit(valid_data_embed, train_data_embed)
  File "/home/ubuntu/FWRENCH/fwrench/utils/utils.py", line 132, in fit
    self.lf_selectors[i].fit(labeled_data_i, unlabeled_data_i)
  File "/home/ubuntu/FWRENCH/fwrench/lf_selectors/snuba_lf_selector.py", line 57, in fit
    model=self.lf_generator, scoring_fn=self.scoring_fn)
  File "/home/ubuntu/FWRENCH/fwrench/lf_selectors/snuba/heuristic_generator.py", line 152, in run_synthesizer
    scoring_fn=scoring_fn)
  File "/home/ubuntu/FWRENCH/fwrench/lf_selectors/snuba/heuristic_generator.py", line 81, in prune_heuristics
    L_temp_train = self.apply_heuristics(heuristics[i], self.train_primitive_matrix, feat_combos[i], beta_opt_temp) 
  File "/home/ubuntu/FWRENCH/fwrench/lf_selectors/snuba/heuristic_generator.py", line 53, in apply_heuristics
    L = np.zeros((np.shape(primitive_matrix)[0],len(heuristics)))
numpy.core._exceptions.MemoryError: Unable to allocate 261. GiB for an array with shape (57000, 613872) and data type float64
