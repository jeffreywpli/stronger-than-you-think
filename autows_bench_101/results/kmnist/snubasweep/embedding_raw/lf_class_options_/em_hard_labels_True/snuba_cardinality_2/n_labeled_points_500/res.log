2022-05-22 07:36:01 - loading data from datasets/KMNIST_3000/train.json
  0%|          | 0/57000 [00:00<?, ?it/s]  1%|          | 299/57000 [00:00<00:19, 2980.91it/s]  1%|          | 599/57000 [00:00<00:18, 2991.28it/s]  2%|▏         | 900/57000 [00:00<00:18, 2998.38it/s]  2%|▏         | 1201/57000 [00:00<00:18, 3000.00it/s]  3%|▎         | 1502/57000 [00:00<00:18, 3003.07it/s]  3%|▎         | 1804/57000 [00:00<00:18, 3006.51it/s]  4%|▎         | 2106/57000 [00:00<00:18, 3009.59it/s]  4%|▍         | 2407/57000 [00:00<00:18, 3008.75it/s]  5%|▍         | 2709/57000 [00:00<00:18, 3009.46it/s]  5%|▌         | 3010/57000 [00:01<00:18, 2995.64it/s]  6%|▌         | 3312/57000 [00:01<00:17, 3000.98it/s]  6%|▋         | 3615/57000 [00:01<00:17, 3006.93it/s]  7%|▋         | 3916/57000 [00:01<00:17, 3007.31it/s]  7%|▋         | 4218/57000 [00:01<00:17, 3010.54it/s]  8%|▊         | 4520/57000 [00:01<00:17, 3008.87it/s]  8%|▊         | 4822/57000 [00:01<00:17, 3009.31it/s]  9%|▉         | 5124/57000 [00:01<00:17, 3010.58it/s] 10%|▉         | 5426/57000 [00:01<00:17, 3006.53it/s] 10%|█         | 5728/57000 [00:01<00:17, 3010.47it/s] 11%|█         | 6030/57000 [00:02<00:16, 3006.51it/s] 11%|█         | 6332/57000 [00:02<00:16, 3007.49it/s] 12%|█▏        | 6634/57000 [00:02<00:16, 3009.07it/s] 12%|█▏        | 6935/57000 [00:02<00:16, 3007.24it/s] 13%|█▎        | 7237/57000 [00:02<00:16, 3008.91it/s] 13%|█▎        | 7538/57000 [00:02<00:16, 3002.93it/s] 14%|█▍        | 7840/57000 [00:02<00:16, 3005.94it/s] 14%|█▍        | 8141/57000 [00:02<00:16, 3005.50it/s] 15%|█▍        | 8443/57000 [00:02<00:16, 3007.50it/s] 15%|█▌        | 8745/57000 [00:02<00:16, 3008.65it/s] 16%|█▌        | 9046/57000 [00:03<00:15, 3007.87it/s] 16%|█▋        | 9347/57000 [00:03<00:15, 3008.30it/s] 17%|█▋        | 9648/57000 [00:03<00:15, 3002.31it/s] 17%|█▋        | 9949/57000 [00:03<00:15, 3004.56it/s] 18%|█▊        | 10251/57000 [00:03<00:15, 3008.39it/s] 19%|█▊        | 10553/57000 [00:03<00:15, 3009.12it/s] 19%|█▉        | 10854/57000 [00:03<00:15, 3009.31it/s] 20%|█▉        | 11156/57000 [00:03<00:15, 3011.25it/s] 20%|██        | 11458/57000 [00:03<00:15, 3008.10it/s] 21%|██        | 11759/57000 [00:03<00:15, 3004.39it/s] 21%|██        | 12060/57000 [00:04<00:14, 2998.72it/s] 22%|██▏       | 12362/57000 [00:04<00:14, 3003.73it/s] 22%|██▏       | 12663/57000 [00:04<00:14, 3000.62it/s] 23%|██▎       | 12965/57000 [00:04<00:14, 3005.78it/s] 23%|██▎       | 13267/57000 [00:04<00:14, 3009.65it/s] 24%|██▍       | 13569/57000 [00:04<00:14, 3012.71it/s] 24%|██▍       | 13871/57000 [00:04<00:14, 3014.45it/s] 25%|██▍       | 14173/57000 [00:04<00:14, 3010.04it/s] 25%|██▌       | 14475/57000 [00:04<00:14, 3012.49it/s] 26%|██▌       | 14777/57000 [00:04<00:14, 3001.92it/s] 26%|██▋       | 15080/57000 [00:05<00:13, 3008.16it/s] 27%|██▋       | 15382/57000 [00:05<00:13, 3010.27it/s] 28%|██▊       | 15684/57000 [00:05<00:13, 3009.96it/s] 28%|██▊       | 15986/57000 [00:05<00:13, 3010.77it/s] 29%|██▊       | 16288/57000 [00:05<00:13, 3009.42it/s] 29%|██▉       | 16590/57000 [00:05<00:13, 3009.73it/s] 30%|██▉       | 16892/57000 [00:05<00:13, 3010.19it/s] 30%|███       | 17194/57000 [00:05<00:13, 3008.07it/s] 31%|███       | 17495/57000 [00:05<00:13, 3006.10it/s] 31%|███       | 17796/57000 [00:05<00:13, 2993.73it/s] 32%|███▏      | 18097/57000 [00:06<00:12, 2998.17it/s] 32%|███▏      | 18398/57000 [00:06<00:12, 2999.65it/s] 33%|███▎      | 18699/57000 [00:06<00:12, 3002.37it/s] 33%|███▎      | 19001/57000 [00:06<00:12, 3004.97it/s] 34%|███▍      | 19302/57000 [00:06<00:12, 3005.83it/s] 34%|███▍      | 19604/57000 [00:06<00:12, 3007.93it/s] 35%|███▍      | 19905/57000 [00:06<00:12, 3001.41it/s] 35%|███▌      | 20206/57000 [00:06<00:12, 3002.08it/s] 36%|███▌      | 20507/57000 [00:06<00:12, 3001.98it/s] 37%|███▋      | 20808/57000 [00:06<00:12, 2994.83it/s] 37%|███▋      | 21110/57000 [00:07<00:11, 3001.21it/s] 38%|███▊      | 21411/57000 [00:07<00:11, 3001.65it/s] 38%|███▊      | 21713/57000 [00:07<00:11, 3004.90it/s] 39%|███▊      | 22014/57000 [00:07<00:11, 3005.52it/s] 39%|███▉      | 22315/57000 [00:07<00:11, 2997.79it/s] 40%|███▉      | 22617/57000 [00:07<00:11, 3002.08it/s] 40%|████      | 22918/57000 [00:07<00:11, 2997.92it/s] 41%|████      | 23220/57000 [00:07<00:11, 3001.66it/s] 41%|████▏     | 23521/57000 [00:07<00:11, 3001.78it/s] 42%|████▏     | 23823/57000 [00:07<00:11, 3005.72it/s] 42%|████▏     | 24125/57000 [00:08<00:10, 3007.18it/s] 43%|████▎     | 24426/57000 [00:08<00:10, 3005.89it/s] 43%|████▎     | 24727/57000 [00:08<00:10, 3007.02it/s] 44%|████▍     | 25028/57000 [00:08<00:10, 3001.77it/s] 44%|████▍     | 25329/57000 [00:08<00:10, 3000.50it/s] 45%|████▍     | 25631/57000 [00:08<00:10, 3004.63it/s] 45%|████▌     | 25932/57000 [00:08<00:10, 3001.87it/s] 46%|████▌     | 26234/57000 [00:08<00:10, 3004.66it/s] 47%|████▋     | 26535/57000 [00:08<00:10, 3002.44it/s] 47%|████▋     | 26837/57000 [00:08<00:10, 3004.97it/s] 48%|████▊     | 27139/57000 [00:09<00:09, 3006.62it/s] 48%|████▊     | 27440/57000 [00:09<00:09, 2999.45it/s] 49%|████▊     | 27742/57000 [00:09<00:09, 3003.26it/s] 49%|████▉     | 28043/57000 [00:09<00:09, 3004.12it/s] 50%|████▉     | 28344/57000 [00:09<00:09, 3002.68it/s] 50%|█████     | 28645/57000 [00:09<00:09, 3004.40it/s] 51%|█████     | 28946/57000 [00:09<00:09, 3002.65it/s] 51%|█████▏    | 29248/57000 [00:09<00:09, 3004.81it/s] 52%|█████▏    | 29549/57000 [00:09<00:09, 3002.02it/s] 52%|█████▏    | 29851/57000 [00:09<00:09, 3005.22it/s] 53%|█████▎    | 30152/57000 [00:10<00:08, 3003.82it/s] 53%|█████▎    | 30454/57000 [00:10<00:08, 3006.09it/s] 54%|█████▍    | 30755/57000 [00:10<00:08, 3006.37it/s] 54%|█████▍    | 31056/57000 [00:10<00:08, 2998.97it/s] 55%|█████▌    | 31356/57000 [00:10<00:08, 2997.53it/s] 56%|█████▌    | 31656/57000 [00:10<00:08, 2992.76it/s] 56%|█████▌    | 31956/57000 [00:10<00:08, 2991.48it/s] 57%|█████▋    | 32257/57000 [00:10<00:08, 2995.75it/s] 57%|█████▋    | 32557/57000 [00:10<00:08, 2990.64it/s] 58%|█████▊    | 32859/57000 [00:10<00:08, 2996.75it/s] 58%|█████▊    | 33159/57000 [00:11<00:07, 2995.27it/s] 59%|█████▊    | 33461/57000 [00:11<00:07, 3000.62it/s] 59%|█████▉    | 33762/57000 [00:11<00:07, 3003.12it/s] 60%|█████▉    | 34063/57000 [00:11<00:07, 2993.79it/s] 60%|██████    | 34364/57000 [00:11<00:07, 2995.80it/s] 61%|██████    | 34664/57000 [00:11<00:07, 2996.15it/s] 61%|██████▏   | 34966/57000 [00:11<00:07, 3002.06it/s] 62%|██████▏   | 35267/57000 [00:11<00:07, 3002.00it/s] 62%|██████▏   | 35569/57000 [00:11<00:07, 3005.79it/s] 63%|██████▎   | 35870/57000 [00:11<00:07, 3002.72it/s] 63%|██████▎   | 36171/57000 [00:12<00:06, 3000.30it/s] 64%|██████▍   | 36473/57000 [00:12<00:06, 3005.62it/s] 65%|██████▍   | 36774/57000 [00:12<00:06, 3003.31it/s] 65%|██████▌   | 37075/57000 [00:12<00:06, 3000.44it/s] 66%|██████▌   | 37376/57000 [00:12<00:06, 2996.02it/s] 66%|██████▌   | 37677/57000 [00:12<00:06, 2998.71it/s] 67%|██████▋   | 37979/57000 [00:12<00:06, 3002.15it/s] 67%|██████▋   | 38280/57000 [00:12<00:06, 3003.99it/s] 68%|██████▊   | 38582/57000 [00:12<00:06, 3006.33it/s] 68%|██████▊   | 38884/57000 [00:12<00:06, 3009.41it/s] 69%|██████▊   | 39185/57000 [00:13<00:05, 3005.87it/s] 69%|██████▉   | 39487/57000 [00:13<00:05, 3007.20it/s] 70%|██████▉   | 39788/57000 [00:13<00:05, 3006.41it/s] 70%|███████   | 40089/57000 [00:13<00:05, 3006.05it/s] 71%|███████   | 40390/57000 [00:13<00:05, 3000.56it/s] 71%|███████▏  | 40691/57000 [00:13<00:05, 2997.92it/s] 72%|███████▏  | 40992/57000 [00:13<00:05, 3001.28it/s] 72%|███████▏  | 41293/57000 [00:13<00:05, 2999.19it/s] 73%|███████▎  | 41595/57000 [00:13<00:05, 3003.50it/s] 74%|███████▎  | 41896/57000 [00:13<00:05, 2998.43it/s] 74%|███████▍  | 42197/57000 [00:14<00:04, 3001.58it/s] 75%|███████▍  | 42498/57000 [00:14<00:04, 3003.44it/s] 75%|███████▌  | 42799/57000 [00:14<00:04, 2997.68it/s] 76%|███████▌  | 43100/57000 [00:14<00:04, 2999.54it/s] 76%|███████▌  | 43400/57000 [00:14<00:04, 2990.38it/s] 77%|███████▋  | 43700/57000 [00:14<00:04, 2993.16it/s] 77%|███████▋  | 44001/57000 [00:14<00:04, 2995.31it/s] 78%|███████▊  | 44301/57000 [00:14<00:04, 2991.70it/s] 78%|███████▊  | 44602/57000 [00:14<00:04, 2996.11it/s] 79%|███████▉  | 44904/57000 [00:14<00:04, 3001.40it/s] 79%|███████▉  | 45205/57000 [00:15<00:03, 2996.97it/s] 80%|███████▉  | 45507/57000 [00:15<00:03, 3002.82it/s] 80%|████████  | 45808/57000 [00:15<00:03, 3002.36it/s] 81%|████████  | 46109/57000 [00:15<00:03, 2999.77it/s] 81%|████████▏ | 46409/57000 [00:15<00:03, 2989.00it/s] 82%|████████▏ | 46710/57000 [00:15<00:03, 2994.65it/s] 82%|████████▏ | 47010/57000 [00:15<00:03, 2990.56it/s] 83%|████████▎ | 47312/57000 [00:15<00:03, 2996.75it/s] 84%|████████▎ | 47614/57000 [00:15<00:03, 3001.43it/s] 84%|████████▍ | 47915/57000 [00:15<00:03, 3002.94it/s] 85%|████████▍ | 48216/57000 [00:16<00:02, 3004.15it/s] 85%|████████▌ | 48517/57000 [00:16<00:02, 2995.88it/s] 86%|████████▌ | 48818/57000 [00:16<00:02, 2997.71it/s] 86%|████████▌ | 49119/57000 [00:16<00:02, 2999.26it/s] 87%|████████▋ | 49421/57000 [00:16<00:02, 3003.42it/s] 87%|████████▋ | 49722/57000 [00:16<00:02, 3004.01it/s] 88%|████████▊ | 50023/57000 [00:16<00:02, 3004.56it/s] 88%|████████▊ | 50325/57000 [00:16<00:02, 3007.39it/s] 89%|████████▉ | 50626/57000 [00:16<00:02, 3008.14it/s] 89%|████████▉ | 50927/57000 [00:16<00:02, 2998.02it/s] 90%|████████▉ | 51229/57000 [00:17<00:01, 3002.61it/s] 90%|█████████ | 51530/57000 [00:17<00:01, 2995.93it/s] 91%|█████████ | 51831/57000 [00:17<00:01, 2998.89it/s] 91%|█████████▏| 52131/57000 [00:17<00:01, 2998.37it/s] 92%|█████████▏| 52432/57000 [00:17<00:01, 3001.04it/s] 93%|█████████▎| 52734/57000 [00:17<00:01, 3003.97it/s] 93%|█████████▎| 53035/57000 [00:17<00:01, 3002.48it/s] 94%|█████████▎| 53337/57000 [00:17<00:01, 3005.60it/s] 94%|█████████▍| 53638/57000 [00:17<00:01, 2998.01it/s] 95%|█████████▍| 53938/57000 [00:17<00:01, 2991.25it/s] 95%|█████████▌| 54239/57000 [00:18<00:00, 2994.86it/s] 96%|█████████▌| 54539/57000 [00:18<00:00, 2994.38it/s] 96%|█████████▌| 54840/57000 [00:18<00:00, 2998.36it/s] 97%|█████████▋| 55140/57000 [00:18<00:00, 2998.24it/s] 97%|█████████▋| 55442/57000 [00:18<00:00, 3004.34it/s] 98%|█████████▊| 55743/57000 [00:18<00:00, 3005.09it/s] 98%|█████████▊| 56044/57000 [00:18<00:00, 3006.32it/s] 99%|█████████▉| 56346/57000 [00:18<00:00, 3008.30it/s] 99%|█████████▉| 56647/57000 [00:18<00:00, 3001.54it/s]100%|█████████▉| 56948/57000 [00:18<00:00, 3003.96it/s]100%|██████████| 57000/57000 [00:18<00:00, 3002.65it/s]
2022-05-22 07:36:21 - loading data from datasets/KMNIST_3000/valid.json
  0%|          | 0/3000 [00:00<?, ?it/s] 10%|█         | 300/3000 [00:00<00:00, 2993.96it/s] 20%|██        | 601/3000 [00:00<00:00, 3000.87it/s] 30%|███       | 902/3000 [00:00<00:00, 3002.56it/s] 40%|████      | 1203/3000 [00:00<00:00, 3001.71it/s] 50%|█████     | 1504/3000 [00:00<00:00, 3003.40it/s] 60%|██████    | 1805/3000 [00:00<00:00, 3002.98it/s] 70%|███████   | 2106/3000 [00:00<00:00, 3003.83it/s] 80%|████████  | 2407/3000 [00:00<00:00, 3003.87it/s] 90%|█████████ | 2708/3000 [00:00<00:00, 3003.78it/s]100%|██████████| 3000/3000 [00:00<00:00, 3002.81it/s]
2022-05-22 07:36:22 - loading data from datasets/KMNIST_3000/test.json
  0%|          | 0/10000 [00:00<?, ?it/s]  3%|▎         | 300/10000 [00:00<00:03, 2996.20it/s]  6%|▌         | 601/10000 [00:00<00:03, 3001.15it/s]  9%|▉         | 902/10000 [00:00<00:03, 3004.63it/s] 12%|█▏        | 1203/10000 [00:00<00:02, 3005.78it/s] 15%|█▌        | 1504/10000 [00:00<00:02, 3005.85it/s] 18%|█▊        | 1806/10000 [00:00<00:02, 3007.87it/s] 21%|██        | 2107/10000 [00:00<00:02, 3006.35it/s] 24%|██▍       | 2408/10000 [00:00<00:02, 3000.28it/s] 27%|██▋       | 2709/10000 [00:00<00:02, 3002.46it/s] 30%|███       | 3010/10000 [00:01<00:02, 3004.29it/s] 33%|███▎      | 3311/10000 [00:01<00:02, 3002.98it/s] 36%|███▌      | 3612/10000 [00:01<00:02, 3003.70it/s] 39%|███▉      | 3913/10000 [00:01<00:02, 3003.71it/s] 42%|████▏     | 4214/10000 [00:01<00:01, 3003.71it/s] 45%|████▌     | 4515/10000 [00:01<00:01, 3001.79it/s] 48%|████▊     | 4816/10000 [00:01<00:01, 3003.61it/s] 51%|█████     | 5117/10000 [00:01<00:01, 2998.95it/s] 54%|█████▍    | 5418/10000 [00:01<00:01, 2999.81it/s] 57%|█████▋    | 5719/10000 [00:01<00:01, 2999.93it/s] 60%|██████    | 6020/10000 [00:02<00:01, 3002.68it/s] 63%|██████▎   | 6321/10000 [00:02<00:01, 3002.36it/s] 66%|██████▌   | 6623/10000 [00:02<00:01, 3004.43it/s] 69%|██████▉   | 6924/10000 [00:02<00:01, 3000.24it/s] 72%|███████▏  | 7225/10000 [00:02<00:00, 2992.20it/s] 75%|███████▌  | 7525/10000 [00:02<00:00, 2987.21it/s] 78%|███████▊  | 7826/10000 [00:02<00:00, 2992.94it/s] 81%|████████▏ | 8127/10000 [00:02<00:00, 2996.23it/s] 84%|████████▍ | 8428/10000 [00:02<00:00, 3000.19it/s] 87%|████████▋ | 8729/10000 [00:02<00:00, 3002.45it/s] 90%|█████████ | 9030/10000 [00:03<00:00, 3004.64it/s] 93%|█████████▎| 9331/10000 [00:03<00:00, 3005.06it/s] 96%|█████████▋| 9632/10000 [00:03<00:00, 2998.52it/s] 99%|█████████▉| 9932/10000 [00:03<00:00, 2997.69it/s]100%|██████████| 10000/10000 [00:03<00:00, 3000.66it/s]
2022-05-22 07:36:31 - Using LF classes: [functools.partial(<class 'sklearn.tree._classes.DecisionTreeClassifier'>, max_depth=1), <class 'sklearn.linear_model._logistic.LogisticRegression'>]
Fitting MulticlassAdaptor... Class 0
  0%|          | 0/23 [00:00<?, ?it/s]  0%|          | 0/23 [2:39:23<?, ?it/s]
Traceback (most recent call last):
  File "fwrench/applications/kmnist.py", line 213, in <module>
    fire.Fire(main)
  File "/home/ubuntu/anaconda3/envs/FWRENCH/lib/python3.7/site-packages/fire/core.py", line 141, in Fire
    component_trace = _Fire(component, args, parsed_flag_args, context, name)
  File "/home/ubuntu/anaconda3/envs/FWRENCH/lib/python3.7/site-packages/fire/core.py", line 471, in _Fire
    target=component.__name__)
  File "/home/ubuntu/anaconda3/envs/FWRENCH/lib/python3.7/site-packages/fire/core.py", line 681, in _CallAndUpdateTrace
    component = fn(*varargs, **kwargs)
  File "fwrench/applications/kmnist.py", line 157, in main
    selector.fit(valid_data_embed, train_data_embed)
  File "/home/ubuntu/FWRENCH/fwrench/utils/utils.py", line 132, in fit
    self.lf_selectors[i].fit(labeled_data_i, unlabeled_data_i)
  File "/home/ubuntu/FWRENCH/fwrench/lf_selectors/snuba_lf_selector.py", line 57, in fit
    model=self.lf_generator, scoring_fn=self.scoring_fn)
  File "/home/ubuntu/FWRENCH/fwrench/lf_selectors/snuba/heuristic_generator.py", line 152, in run_synthesizer
    scoring_fn=scoring_fn)
  File "/home/ubuntu/FWRENCH/fwrench/lf_selectors/snuba/heuristic_generator.py", line 81, in prune_heuristics
    L_temp_train = self.apply_heuristics(heuristics[i], self.train_primitive_matrix, feat_combos[i], beta_opt_temp) 
  File "/home/ubuntu/FWRENCH/fwrench/lf_selectors/snuba/heuristic_generator.py", line 53, in apply_heuristics
    L = np.zeros((np.shape(primitive_matrix)[0],len(heuristics)))
numpy.core._exceptions.MemoryError: Unable to allocate 261. GiB for an array with shape (57000, 613872) and data type float64
