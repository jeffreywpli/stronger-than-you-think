2022-06-06 09:28:45 - loading data from datasets/NavierStokes_100/train.json
  0%|          | 0/100 [00:00<?, ?it/s]100%|██████████| 100/100 [00:00<00:00, 2696.92it/s]
2022-06-06 09:28:45 - loading data from datasets/NavierStokes_100/valid.json
  0%|          | 0/100 [00:00<?, ?it/s]100%|██████████| 100/100 [00:00<00:00, 2685.78it/s]
2022-06-06 09:28:45 - loading data from datasets/NavierStokes_100/test.json
  0%|          | 0/1900 [00:00<?, ?it/s] 14%|█▎        | 258/1900 [00:00<00:00, 2575.81it/s] 27%|██▋       | 516/1900 [00:00<00:00, 2391.64it/s] 40%|████      | 765/1900 [00:00<00:00, 2431.05it/s] 53%|█████▎    | 1015/1900 [00:00<00:00, 2457.13it/s] 67%|██████▋   | 1265/1900 [00:00<00:00, 2471.46it/s] 80%|███████▉  | 1516/1900 [00:00<00:00, 2483.59it/s] 93%|█████████▎| 1768/1900 [00:00<00:00, 2492.05it/s]100%|██████████| 1900/1900 [00:00<00:00, 2476.16it/s]
OPENAI CLIP ZERO SHOT W/ TEXTS ['The Navier-Stokes equation in the turbulent regime with low viscosity: 1e-5.', 'The Navier-Stokes equation with high viscosity: 1e-3.']
Extracting image features...
  0%|          | 0/100 [00:00<?, ?it/s]  1%|          | 1/100 [00:00<00:55,  1.80it/s]  8%|▊         | 8/100 [00:00<00:05, 15.67it/s] 16%|█▌        | 16/100 [00:00<00:02, 29.55it/s] 24%|██▍       | 24/100 [00:00<00:01, 40.51it/s] 32%|███▏      | 32/100 [00:00<00:01, 49.21it/s] 40%|████      | 40/100 [00:01<00:01, 55.75it/s] 48%|████▊     | 48/100 [00:01<00:00, 60.66it/s] 56%|█████▌    | 56/100 [00:01<00:00, 64.13it/s] 64%|██████▍   | 64/100 [00:01<00:00, 66.68it/s] 72%|███████▏  | 72/100 [00:01<00:00, 68.44it/s] 80%|████████  | 80/100 [00:01<00:00, 68.02it/s] 88%|████████▊ | 88/100 [00:01<00:00, 56.49it/s] 96%|█████████▌| 96/100 [00:01<00:00, 60.71it/s]100%|██████████| 100/100 [00:02<00:00, 49.57it/s]
IMAGE FEATURES SHAPE torch.Size([100, 1024])
LOGIT SHAPE torch.Size([100, 2])
OPENAI CLIP ZERO SHOT W/ TEXTS ['The Navier-Stokes equation in the turbulent regime with low viscosity: 1e-5.', 'The Navier-Stokes equation with high viscosity: 1e-3.']
Extracting image features...
  0%|          | 0/100 [00:00<?, ?it/s]  8%|▊         | 8/100 [00:00<00:01, 72.72it/s] 16%|█▌        | 16/100 [00:00<00:01, 72.81it/s] 24%|██▍       | 24/100 [00:00<00:01, 72.90it/s] 32%|███▏      | 32/100 [00:00<00:00, 72.95it/s] 40%|████      | 40/100 [00:00<00:00, 72.97it/s] 48%|████▊     | 48/100 [00:00<00:00, 72.90it/s] 56%|█████▌    | 56/100 [00:00<00:00, 72.97it/s] 64%|██████▍   | 64/100 [00:00<00:00, 73.00it/s] 72%|███████▏  | 72/100 [00:00<00:00, 73.05it/s] 80%|████████  | 80/100 [00:01<00:00, 71.33it/s] 88%|████████▊ | 88/100 [00:01<00:00, 71.80it/s] 96%|█████████▌| 96/100 [00:01<00:00, 72.15it/s]100%|██████████| 100/100 [00:01<00:00, 72.51it/s]
IMAGE FEATURES SHAPE torch.Size([100, 1024])
LOGIT SHAPE torch.Size([100, 2])
OPENAI CLIP ZERO SHOT W/ TEXTS ['The Navier-Stokes equation in the turbulent regime with low viscosity: 1e-5.', 'The Navier-Stokes equation with high viscosity: 1e-3.']
Extracting image features...
  0%|          | 0/1900 [00:00<?, ?it/s]  0%|          | 8/1900 [00:00<00:26, 72.43it/s]  1%|          | 16/1900 [00:00<00:25, 72.73it/s]  1%|▏         | 24/1900 [00:00<00:25, 72.68it/s]  2%|▏         | 32/1900 [00:00<00:25, 72.78it/s]  2%|▏         | 40/1900 [00:00<00:25, 72.85it/s]  3%|▎         | 48/1900 [00:00<00:25, 72.92it/s]  3%|▎         | 56/1900 [00:00<00:25, 72.90it/s]  3%|▎         | 64/1900 [00:00<00:25, 72.98it/s]  4%|▍         | 72/1900 [00:00<00:25, 73.08it/s]  4%|▍         | 80/1900 [00:01<00:24, 73.06it/s]  5%|▍         | 88/1900 [00:01<00:25, 71.20it/s]  5%|▌         | 96/1900 [00:01<00:25, 71.83it/s]  5%|▌         | 104/1900 [00:01<00:24, 72.15it/s]  6%|▌         | 112/1900 [00:01<00:24, 72.39it/s]  6%|▋         | 120/1900 [00:01<00:24, 72.37it/s]  7%|▋         | 128/1900 [00:01<00:24, 72.42it/s]  7%|▋         | 136/1900 [00:01<00:24, 72.39it/s]  8%|▊         | 144/1900 [00:01<00:24, 72.53it/s]  8%|▊         | 152/1900 [00:02<00:24, 72.52it/s]  8%|▊         | 160/1900 [00:02<00:23, 72.66it/s]  9%|▉         | 168/1900 [00:02<00:23, 72.71it/s]  9%|▉         | 176/1900 [00:02<00:23, 72.70it/s] 10%|▉         | 184/1900 [00:02<00:23, 72.75it/s] 10%|█         | 192/1900 [00:02<00:23, 72.65it/s] 11%|█         | 200/1900 [00:02<00:23, 70.85it/s] 11%|█         | 208/1900 [00:02<00:23, 71.36it/s] 11%|█▏        | 216/1900 [00:02<00:23, 71.82it/s] 12%|█▏        | 224/1900 [00:03<00:23, 72.01it/s] 12%|█▏        | 232/1900 [00:03<00:23, 72.17it/s] 13%|█▎        | 240/1900 [00:03<00:22, 72.27it/s] 13%|█▎        | 248/1900 [00:03<00:22, 72.34it/s] 13%|█▎        | 256/1900 [00:03<00:23, 70.06it/s] 14%|█▍        | 264/1900 [00:03<00:23, 70.79it/s] 14%|█▍        | 272/1900 [00:03<00:22, 71.21it/s] 15%|█▍        | 280/1900 [00:03<00:22, 71.65it/s] 15%|█▌        | 288/1900 [00:03<00:22, 71.85it/s] 16%|█▌        | 296/1900 [00:04<00:22, 72.17it/s] 16%|█▌        | 304/1900 [00:04<00:22, 70.63it/s] 16%|█▋        | 312/1900 [00:04<00:22, 71.14it/s] 17%|█▋        | 320/1900 [00:04<00:22, 71.50it/s] 17%|█▋        | 328/1900 [00:04<00:21, 71.66it/s] 18%|█▊        | 336/1900 [00:04<00:21, 71.90it/s] 18%|█▊        | 344/1900 [00:04<00:21, 71.89it/s] 19%|█▊        | 352/1900 [00:04<00:21, 72.12it/s] 19%|█▉        | 360/1900 [00:04<00:21, 72.16it/s] 19%|█▉        | 368/1900 [00:05<00:21, 72.24it/s] 20%|█▉        | 376/1900 [00:05<00:21, 72.19it/s] 20%|██        | 384/1900 [00:05<00:20, 72.33it/s] 21%|██        | 392/1900 [00:05<00:20, 72.35it/s] 21%|██        | 400/1900 [00:05<00:20, 72.16it/s] 21%|██▏       | 408/1900 [00:05<00:20, 71.95it/s] 22%|██▏       | 416/1900 [00:05<00:21, 70.25it/s] 22%|██▏       | 424/1900 [00:05<00:20, 70.66it/s] 23%|██▎       | 432/1900 [00:06<00:20, 71.06it/s] 23%|██▎       | 440/1900 [00:06<00:20, 71.43it/s] 24%|██▎       | 448/1900 [00:06<00:20, 71.57it/s] 24%|██▍       | 456/1900 [00:06<00:20, 71.81it/s] 24%|██▍       | 464/1900 [00:06<00:19, 71.99it/s] 25%|██▍       | 472/1900 [00:06<00:19, 72.13it/s] 25%|██▌       | 480/1900 [00:06<00:19, 72.09it/s] 26%|██▌       | 488/1900 [00:06<00:19, 72.26it/s] 26%|██▌       | 496/1900 [00:06<00:19, 72.35it/s] 27%|██▋       | 504/1900 [00:06<00:19, 72.45it/s] 27%|██▋       | 512/1900 [00:07<00:19, 72.40it/s] 27%|██▋       | 520/1900 [00:07<00:19, 72.42it/s] 28%|██▊       | 528/1900 [00:07<00:19, 70.56it/s] 28%|██▊       | 536/1900 [00:07<00:19, 71.17it/s] 29%|██▊       | 544/1900 [00:07<00:18, 71.49it/s] 29%|██▉       | 552/1900 [00:07<00:18, 71.82it/s] 29%|██▉       | 560/1900 [00:07<00:18, 71.72it/s] 30%|██▉       | 568/1900 [00:07<00:18, 71.79it/s] 30%|███       | 576/1900 [00:08<00:18, 71.92it/s] 31%|███       | 584/1900 [00:08<00:18, 72.02it/s] 31%|███       | 592/1900 [00:08<00:18, 72.10it/s] 32%|███▏      | 600/1900 [00:08<00:18, 72.08it/s] 32%|███▏      | 608/1900 [00:08<00:17, 72.22it/s] 32%|███▏      | 616/1900 [00:08<00:17, 72.13it/s] 33%|███▎      | 624/1900 [00:08<00:17, 72.17it/s] 33%|███▎      | 632/1900 [00:08<00:17, 70.80it/s] 34%|███▎      | 640/1900 [00:08<00:17, 70.82it/s] 34%|███▍      | 648/1900 [00:09<00:17, 71.21it/s] 35%|███▍      | 656/1900 [00:09<00:17, 71.62it/s] 35%|███▍      | 664/1900 [00:09<00:17, 71.79it/s] 35%|███▌      | 672/1900 [00:09<00:17, 71.92it/s] 36%|███▌      | 680/1900 [00:09<00:16, 71.99it/s] 36%|███▌      | 688/1900 [00:09<00:16, 71.85it/s] 37%|███▋      | 696/1900 [00:09<00:16, 71.19it/s] 37%|███▋      | 704/1900 [00:09<00:16, 70.75it/s] 37%|███▋      | 712/1900 [00:09<00:16, 70.38it/s] 38%|███▊      | 720/1900 [00:10<00:16, 70.12it/s] 38%|███▊      | 728/1900 [00:10<00:16, 69.93it/s] 39%|███▊      | 735/1900 [00:10<00:16, 69.68it/s] 39%|███▉      | 742/1900 [00:10<00:17, 68.00it/s] 39%|███▉      | 750/1900 [00:10<00:16, 69.09it/s] 40%|███▉      | 758/1900 [00:10<00:16, 70.02it/s] 40%|████      | 766/1900 [00:10<00:16, 70.61it/s] 41%|████      | 774/1900 [00:10<00:15, 71.06it/s] 41%|████      | 782/1900 [00:10<00:15, 71.12it/s] 42%|████▏     | 790/1900 [00:11<00:15, 71.43it/s] 42%|████▏     | 798/1900 [00:11<00:15, 71.48it/s] 42%|████▏     | 806/1900 [00:11<00:15, 71.62it/s] 43%|████▎     | 814/1900 [00:11<00:15, 71.75it/s] 43%|████▎     | 822/1900 [00:11<00:15, 71.69it/s] 44%|████▎     | 830/1900 [00:11<00:14, 71.76it/s] 44%|████▍     | 838/1900 [00:11<00:14, 71.73it/s] 45%|████▍     | 846/1900 [00:11<00:14, 71.76it/s] 45%|████▍     | 854/1900 [00:11<00:14, 69.98it/s] 45%|████▌     | 862/1900 [00:12<00:14, 70.60it/s] 46%|████▌     | 870/1900 [00:12<00:14, 70.89it/s] 46%|████▌     | 878/1900 [00:12<00:14, 71.25it/s] 47%|████▋     | 886/1900 [00:12<00:14, 71.32it/s] 47%|████▋     | 894/1900 [00:12<00:14, 71.50it/s] 47%|████▋     | 902/1900 [00:12<00:13, 71.58it/s] 48%|████▊     | 910/1900 [00:12<00:13, 71.64it/s] 48%|████▊     | 918/1900 [00:12<00:13, 71.62it/s] 49%|████▊     | 926/1900 [00:12<00:13, 71.75it/s] 49%|████▉     | 934/1900 [00:13<00:13, 71.57it/s] 50%|████▉     | 942/1900 [00:13<00:13, 71.49it/s] 50%|█████     | 950/1900 [00:13<00:13, 71.54it/s] 50%|█████     | 958/1900 [00:13<00:13, 69.80it/s] 51%|█████     | 966/1900 [00:13<00:13, 70.32it/s] 51%|█████▏    | 974/1900 [00:13<00:13, 70.73it/s] 52%|█████▏    | 982/1900 [00:13<00:12, 71.11it/s] 52%|█████▏    | 990/1900 [00:13<00:12, 71.17it/s] 53%|█████▎    | 998/1900 [00:13<00:12, 71.34it/s] 53%|█████▎    | 1006/1900 [00:14<00:12, 71.34it/s] 53%|█████▎    | 1014/1900 [00:14<00:12, 71.46it/s] 54%|█████▍    | 1022/1900 [00:14<00:12, 71.45it/s] 54%|█████▍    | 1030/1900 [00:14<00:12, 71.54it/s] 55%|█████▍    | 1038/1900 [00:14<00:12, 71.51it/s] 55%|█████▌    | 1046/1900 [00:14<00:11, 71.64it/s] 55%|█████▌    | 1054/1900 [00:14<00:11, 71.55it/s] 56%|█████▌    | 1062/1900 [00:14<00:11, 71.60it/s] 56%|█████▋    | 1070/1900 [00:14<00:11, 69.78it/s] 57%|█████▋    | 1078/1900 [00:15<00:11, 70.40it/s] 57%|█████▋    | 1086/1900 [00:15<00:11, 70.79it/s] 58%|█████▊    | 1094/1900 [00:15<00:11, 71.07it/s] 58%|█████▊    | 1102/1900 [00:15<00:11, 71.27it/s] 58%|█████▊    | 1110/1900 [00:15<00:11, 71.26it/s] 59%|█████▉    | 1118/1900 [00:15<00:10, 71.36it/s] 59%|█████▉    | 1126/1900 [00:15<00:10, 71.36it/s] 60%|█████▉    | 1134/1900 [00:15<00:10, 71.38it/s] 60%|██████    | 1142/1900 [00:15<00:10, 71.37it/s] 61%|██████    | 1150/1900 [00:16<00:10, 71.41it/s] 61%|██████    | 1158/1900 [00:16<00:10, 71.36it/s] 61%|██████▏   | 1166/1900 [00:16<00:10, 71.49it/s] 62%|██████▏   | 1174/1900 [00:16<00:10, 70.64it/s] 62%|██████▏   | 1182/1900 [00:16<00:10, 70.01it/s] 63%|██████▎   | 1190/1900 [00:16<00:10, 70.37it/s] 63%|██████▎   | 1198/1900 [00:16<00:09, 70.79it/s] 63%|██████▎   | 1206/1900 [00:16<00:09, 71.01it/s] 64%|██████▍   | 1214/1900 [00:16<00:09, 71.13it/s] 64%|██████▍   | 1222/1900 [00:17<00:09, 71.22it/s] 65%|██████▍   | 1230/1900 [00:17<00:09, 71.26it/s] 65%|██████▌   | 1238/1900 [00:17<00:09, 71.39it/s] 66%|██████▌   | 1246/1900 [00:17<00:09, 71.34it/s] 66%|██████▌   | 1254/1900 [00:17<00:09, 71.48it/s] 66%|██████▋   | 1262/1900 [00:17<00:08, 71.43it/s] 67%|██████▋   | 1270/1900 [00:17<00:08, 71.46it/s] 67%|██████▋   | 1278/1900 [00:17<00:08, 71.50it/s] 68%|██████▊   | 1286/1900 [00:17<00:08, 69.82it/s] 68%|██████▊   | 1294/1900 [00:18<00:08, 70.32it/s] 69%|██████▊   | 1302/1900 [00:18<00:08, 70.74it/s] 69%|██████▉   | 1310/1900 [00:18<00:08, 70.96it/s] 69%|██████▉   | 1318/1900 [00:18<00:08, 71.23it/s] 70%|██████▉   | 1326/1900 [00:18<00:08, 71.20it/s] 70%|███████   | 1334/1900 [00:18<00:07, 71.31it/s] 71%|███████   | 1342/1900 [00:18<00:07, 71.25it/s] 71%|███████   | 1350/1900 [00:18<00:07, 71.39it/s] 71%|███████▏  | 1358/1900 [00:18<00:07, 71.41it/s] 72%|███████▏  | 1366/1900 [00:19<00:09, 54.32it/s] 72%|███████▏  | 1374/1900 [00:19<00:08, 58.58it/s] 73%|███████▎  | 1382/1900 [00:19<00:08, 61.93it/s] 73%|███████▎  | 1389/1900 [00:19<00:08, 62.90it/s] 74%|███████▎  | 1397/1900 [00:19<00:07, 65.31it/s] 74%|███████▍  | 1405/1900 [00:19<00:07, 67.12it/s] 74%|███████▍  | 1413/1900 [00:19<00:07, 68.35it/s] 75%|███████▍  | 1421/1900 [00:20<00:06, 69.31it/s] 75%|███████▌  | 1429/1900 [00:20<00:06, 69.93it/s] 76%|███████▌  | 1437/1900 [00:20<00:06, 70.42it/s] 76%|███████▌  | 1445/1900 [00:20<00:06, 70.66it/s] 76%|███████▋  | 1453/1900 [00:20<00:06, 70.96it/s] 77%|███████▋  | 1461/1900 [00:20<00:06, 71.10it/s] 77%|███████▋  | 1469/1900 [00:20<00:06, 71.33it/s] 78%|███████▊  | 1477/1900 [00:20<00:05, 71.37it/s] 78%|███████▊  | 1485/1900 [00:20<00:05, 71.39it/s] 79%|███████▊  | 1493/1900 [00:21<00:05, 71.43it/s] 79%|███████▉  | 1501/1900 [00:21<00:05, 71.39it/s] 79%|███████▉  | 1509/1900 [00:21<00:05, 71.48it/s] 80%|███████▉  | 1517/1900 [00:21<00:05, 71.46it/s] 80%|████████  | 1525/1900 [00:21<00:05, 71.53it/s] 81%|████████  | 1533/1900 [00:21<00:05, 71.50it/s] 81%|████████  | 1541/1900 [00:21<00:05, 71.46it/s] 82%|████████▏ | 1549/1900 [00:21<00:04, 71.32it/s] 82%|████████▏ | 1557/1900 [00:21<00:04, 71.37it/s] 82%|████████▏ | 1565/1900 [00:22<00:04, 71.24it/s] 83%|████████▎ | 1573/1900 [00:22<00:04, 71.29it/s] 83%|████████▎ | 1581/1900 [00:22<00:04, 71.22it/s] 84%|████████▎ | 1589/1900 [00:22<00:04, 71.28it/s] 84%|████████▍ | 1597/1900 [00:22<00:04, 71.22it/s] 84%|████████▍ | 1605/1900 [00:22<00:04, 71.28it/s] 85%|████████▍ | 1613/1900 [00:22<00:04, 71.30it/s] 85%|████████▌ | 1621/1900 [00:22<00:03, 71.21it/s] 86%|████████▌ | 1629/1900 [00:22<00:03, 71.32it/s] 86%|████████▌ | 1637/1900 [00:23<00:03, 71.36it/s] 87%|████████▋ | 1645/1900 [00:23<00:03, 71.47it/s] 87%|████████▋ | 1653/1900 [00:23<00:03, 71.34it/s] 87%|████████▋ | 1661/1900 [00:23<00:03, 71.32it/s] 88%|████████▊ | 1669/1900 [00:23<00:03, 71.26it/s] 88%|████████▊ | 1677/1900 [00:23<00:03, 71.30it/s] 89%|████████▊ | 1685/1900 [00:23<00:03, 71.24it/s] 89%|████████▉ | 1693/1900 [00:23<00:02, 71.27it/s] 90%|████████▉ | 1701/1900 [00:23<00:02, 71.20it/s] 90%|████████▉ | 1709/1900 [00:24<00:02, 71.20it/s] 90%|█████████ | 1717/1900 [00:24<00:02, 71.13it/s] 91%|█████████ | 1725/1900 [00:24<00:02, 71.22it/s] 91%|█████████ | 1733/1900 [00:24<00:02, 71.20it/s] 92%|█████████▏| 1741/1900 [00:24<00:02, 71.35it/s] 92%|█████████▏| 1749/1900 [00:24<00:02, 71.41it/s] 92%|█████████▏| 1757/1900 [00:24<00:02, 71.43it/s] 93%|█████████▎| 1765/1900 [00:24<00:01, 71.34it/s] 93%|█████████▎| 1773/1900 [00:24<00:01, 71.25it/s] 94%|█████████▎| 1781/1900 [00:25<00:01, 71.27it/s] 94%|█████████▍| 1789/1900 [00:25<00:01, 71.23it/s] 95%|█████████▍| 1797/1900 [00:25<00:01, 71.31it/s] 95%|█████████▌| 1805/1900 [00:25<00:01, 71.27it/s] 95%|█████████▌| 1813/1900 [00:25<00:01, 71.34it/s] 96%|█████████▌| 1821/1900 [00:25<00:01, 71.26it/s] 96%|█████████▋| 1829/1900 [00:25<00:00, 71.32it/s] 97%|█████████▋| 1837/1900 [00:25<00:00, 71.24it/s] 97%|█████████▋| 1845/1900 [00:25<00:00, 71.37it/s] 98%|█████████▊| 1853/1900 [00:26<00:00, 71.28it/s] 98%|█████████▊| 1861/1900 [00:26<00:00, 71.37it/s] 98%|█████████▊| 1869/1900 [00:26<00:00, 71.15it/s] 99%|█████████▉| 1877/1900 [00:26<00:00, 71.21it/s] 99%|█████████▉| 1885/1900 [00:26<00:00, 71.22it/s]100%|█████████▉| 1893/1900 [00:26<00:00, 71.15it/s]100%|██████████| 1900/1900 [00:26<00:00, 71.10it/s]
IMAGE FEATURES SHAPE torch.Size([1900, 1024])
LOGIT SHAPE torch.Size([1900, 2])
2022-06-06 09:29:23 - Using LF classes: [functools.partial(<class 'sklearn.tree._classes.DecisionTreeClassifier'>, max_depth=1), <class 'sklearn.linear_model._logistic.LogisticRegression'>]
  0%|          | 0/3 [00:00<?, ?it/s]  0%|          | 0/3 [00:00<?, ?it/s]
  0%|          | 0/100 [00:00<?, ?epoch/s]100%|██████████| 100/100 [00:00<00:00, 1152.85epoch/s]
2022-06-06 09:29:23 - [0.85714286 0.7254902 ]
2022-06-06 09:29:23 - [train] accuracy: 0.7900, coverage: 1.0000
2022-06-06 09:29:23 - [0.85714286 0.7254902 ]
2022-06-06 09:29:23 - [valid] accuracy: 0.7900, coverage: 1.0000
2022-06-06 09:29:24 - [0.87276551 0.71022129]
2022-06-06 09:29:24 - [test] accuracy: 0.7916, coverage: 1.0000
2022-06-06 09:29:24 - label model train acc:    0.791578947368421
2022-06-06 09:29:24 - label model coverage:     1.0
0.791578947368421
