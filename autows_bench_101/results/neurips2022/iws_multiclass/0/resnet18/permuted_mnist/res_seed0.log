/hdd2/kaylee/anaconda3/envs/AutoWS-Bench-101/lib/python3.7/site-packages/torchvision/datasets/mnist.py:498: UserWarning: The given NumPy array is not writeable, and PyTorch does not support non-writeable tensors. This means you can write to the underlying (supposedly non-writeable) NumPy array using the tensor. You may want to copy the array to protect its data or make it writeable before converting it to a tensor. This type of warning will be suppressed for the rest of this program. (Triggered internally at  /opt/conda/conda-bld/pytorch_1631630836880/work/torch/csrc/utils/tensor_numpy.cpp:180.)
  return torch.from_numpy(parsed.astype(m[2], copy=False)).view(*s)
2022-08-09 05:28:46 - loading data from datasets/MNIST_3000/train.json
  0%|          | 0/57000 [00:00<?, ?it/s]  1%|▏         | 725/57000 [00:00<00:07, 7248.50it/s]  3%|▎         | 1450/57000 [00:00<00:07, 7102.24it/s]  4%|▍         | 2161/57000 [00:00<00:07, 7100.23it/s]  5%|▌         | 2872/57000 [00:00<00:07, 7084.91it/s]  6%|▋         | 3593/57000 [00:00<00:07, 7128.18it/s]  8%|▊         | 4321/57000 [00:00<00:07, 7177.43it/s]  9%|▉         | 5039/57000 [00:00<00:07, 7157.80it/s] 10%|█         | 5774/57000 [00:00<00:07, 7218.06it/s] 11%|█▏        | 6496/57000 [00:00<00:07, 7175.54it/s] 13%|█▎        | 7222/57000 [00:01<00:06, 7200.52it/s] 14%|█▍        | 7950/57000 [00:01<00:06, 7224.27it/s] 15%|█▌        | 8673/57000 [00:01<00:06, 7151.46it/s] 16%|█▋        | 9389/57000 [00:01<00:06, 7092.35it/s] 18%|█▊        | 10116/57000 [00:01<00:06, 7143.11it/s] 19%|█▉        | 10845/57000 [00:01<00:06, 7186.73it/s] 20%|██        | 11572/57000 [00:01<00:06, 7210.08it/s] 22%|██▏       | 12301/57000 [00:01<00:06, 7231.67it/s] 23%|██▎       | 13030/57000 [00:01<00:06, 7248.65it/s] 24%|██▍       | 13755/57000 [00:01<00:05, 7245.69it/s] 25%|██▌       | 14482/57000 [00:02<00:05, 7252.18it/s] 27%|██▋       | 15210/57000 [00:02<00:05, 7258.16it/s] 28%|██▊       | 15937/57000 [00:02<00:05, 7258.90it/s] 29%|██▉       | 16669/57000 [00:02<00:05, 7275.46it/s] 31%|███       | 17398/57000 [00:02<00:05, 7277.10it/s] 32%|███▏      | 18126/57000 [00:02<00:05, 7116.56it/s] 33%|███▎      | 18855/57000 [00:02<00:05, 7167.05it/s] 34%|███▍      | 19573/57000 [00:02<00:05, 7144.83it/s] 36%|███▌      | 20288/57000 [00:02<00:05, 7117.31it/s] 37%|███▋      | 21013/57000 [00:02<00:05, 7154.23it/s] 38%|███▊      | 21738/57000 [00:03<00:04, 7182.49it/s] 39%|███▉      | 22463/57000 [00:03<00:04, 7201.70it/s] 41%|████      | 23184/57000 [00:03<00:04, 7159.00it/s] 42%|████▏     | 23901/57000 [00:03<00:04, 7110.87it/s] 43%|████▎     | 24621/57000 [00:03<00:04, 7135.31it/s] 44%|████▍     | 25335/57000 [00:03<00:04, 7109.74it/s] 46%|████▌     | 26051/57000 [00:03<00:04, 7122.72it/s] 47%|████▋     | 26770/57000 [00:03<00:04, 7141.24it/s] 48%|████▊     | 27499/57000 [00:03<00:04, 7183.59it/s] 50%|████▉     | 28227/57000 [00:03<00:03, 7210.37it/s] 51%|█████     | 28949/57000 [00:04<00:03, 7170.42it/s] 52%|█████▏    | 29677/57000 [00:04<00:03, 7200.63it/s] 53%|█████▎    | 30398/57000 [00:04<00:03, 7157.99it/s] 55%|█████▍    | 31117/57000 [00:04<00:03, 7166.53it/s] 56%|█████▌    | 31834/57000 [00:04<00:03, 7147.59it/s] 57%|█████▋    | 32550/57000 [00:04<00:03, 7148.47it/s] 58%|█████▊    | 33274/57000 [00:04<00:03, 7174.90it/s] 60%|█████▉    | 33992/57000 [00:04<00:03, 7146.53it/s] 61%|██████    | 34715/57000 [00:04<00:03, 7170.36it/s] 62%|██████▏   | 35433/57000 [00:04<00:03, 7145.06it/s] 63%|██████▎   | 36158/57000 [00:05<00:02, 7175.68it/s] 65%|██████▍   | 36888/57000 [00:05<00:02, 7212.09it/s] 66%|██████▌   | 37610/57000 [00:05<00:02, 7203.02it/s] 67%|██████▋   | 38332/57000 [00:05<00:02, 7205.64it/s] 69%|██████▊   | 39059/57000 [00:05<00:02, 7222.74it/s] 70%|██████▉   | 39782/57000 [00:05<00:02, 7212.17it/s] 71%|███████   | 40504/57000 [00:05<00:02, 7213.65it/s] 72%|███████▏  | 41226/57000 [00:05<00:02, 7193.82it/s] 74%|███████▎  | 41946/57000 [00:05<00:02, 7168.66it/s] 75%|███████▍  | 42670/57000 [00:05<00:01, 7189.19it/s] 76%|███████▌  | 43389/57000 [00:06<00:01, 7105.06it/s] 77%|███████▋  | 44125/57000 [00:06<00:01, 7180.31it/s] 79%|███████▊  | 44844/57000 [00:06<00:01, 7157.95it/s] 80%|███████▉  | 45570/57000 [00:06<00:01, 7186.44it/s] 81%|████████  | 46301/57000 [00:06<00:01, 7222.16it/s] 82%|████████▏ | 47024/57000 [00:06<00:01, 7181.35it/s] 84%|████████▍ | 47754/57000 [00:06<00:01, 7214.74it/s] 85%|████████▌ | 48479/57000 [00:06<00:01, 7224.46it/s] 86%|████████▋ | 49202/57000 [00:06<00:01, 7197.23it/s] 88%|████████▊ | 49922/57000 [00:06<00:00, 7160.77it/s] 89%|████████▉ | 50639/57000 [00:07<00:00, 7118.49it/s] 90%|█████████ | 51351/57000 [00:07<00:00, 7050.40it/s] 91%|█████████▏| 52057/57000 [00:07<00:00, 7001.03it/s] 93%|█████████▎| 52777/57000 [00:07<00:00, 7059.12it/s] 94%|█████████▍| 53503/57000 [00:07<00:00, 7117.39it/s] 95%|█████████▌| 54225/57000 [00:07<00:00, 7145.78it/s] 96%|█████████▋| 54947/57000 [00:07<00:00, 7166.51it/s] 98%|█████████▊| 55671/57000 [00:07<00:00, 7186.16it/s] 99%|█████████▉| 56390/57000 [00:07<00:00, 7153.35it/s]100%|██████████| 57000/57000 [00:07<00:00, 7169.43it/s]
2022-08-09 05:28:54 - loading data from datasets/MNIST_3000/valid.json
  0%|          | 0/3000 [00:00<?, ?it/s] 24%|██▍       | 718/3000 [00:00<00:00, 7171.92it/s] 48%|████▊     | 1445/3000 [00:00<00:00, 7225.03it/s] 72%|███████▏  | 2172/3000 [00:00<00:00, 7241.52it/s] 97%|█████████▋| 2897/3000 [00:00<00:00, 7231.74it/s]100%|██████████| 3000/3000 [00:00<00:00, 7225.49it/s]
2022-08-09 05:28:55 - loading data from datasets/MNIST_3000/test.json
  0%|          | 0/10000 [00:00<?, ?it/s]  7%|▋         | 703/10000 [00:00<00:01, 7029.57it/s] 14%|█▍        | 1432/10000 [00:00<00:01, 7180.36it/s] 22%|██▏       | 2151/10000 [00:00<00:01, 7160.35it/s] 29%|██▊       | 2868/10000 [00:00<00:01, 7117.19it/s] 36%|███▌      | 3595/10000 [00:00<00:00, 7169.93it/s] 43%|████▎     | 4313/10000 [00:00<00:00, 7109.72it/s] 50%|█████     | 5025/10000 [00:00<00:00, 7093.31it/s] 58%|█████▊    | 5751/10000 [00:00<00:00, 7143.58it/s] 65%|██████▍   | 6480/10000 [00:00<00:00, 7184.90it/s] 72%|███████▏  | 7199/10000 [00:01<00:00, 7135.86it/s] 79%|███████▉  | 7920/10000 [00:01<00:00, 7156.35it/s] 86%|████████▋ | 8636/10000 [00:01<00:00, 7145.75it/s] 94%|█████████▎| 9351/10000 [00:01<00:00, 6998.81it/s]100%|██████████| 10000/10000 [00:01<00:00, 7138.17it/s]2022-08-09 05:29:26 - Using LF classes: [functools.partial(<class 'sklearn.tree._classes.DecisionTreeClassifier'>, max_depth=1), <class 'sklearn.linear_model._logistic.LogisticRegression'>]
|----------------------------------------------------------------------------------------------------|0.0% 0/20|█████-----------------------------------------------------------------------------------------------|5.0% 1/20|██████████------------------------------------------------------------------------------------------|10.0% 2/20|███████████████-------------------------------------------------------------------------------------|15.0% 3/20|----------------------------------------------------------------------------------------------------|0.0% 0/20|█████-----------------------------------------------------------------------------------------------|5.0% 1/20|██████████------------------------------------------------------------------------------------------|10.0% 2/20|███████████████-------------------------------------------------------------------------------------|15.0% 3/20|████████████████████--------------------------------------------------------------------------------|20.0% 4/20|█████████████████████████---------------------------------------------------------------------------|25.0% 5/20|██████████████████████████████----------------------------------------------------------------------|30.0% 6/20|███████████████████████████████████-----------------------------------------------------------------|35.0% 7/20|████████████████████████████████████████------------------------------------------------------------|40.0% 8/20|█████████████████████████████████████████████-------------------------------------------------------|45.0% 9/20|██████████████████████████████████████████████████--------------------------------------------------|50.0% 10/20|███████████████████████████████████████████████████████---------------------------------------------|55.0% 11/20|████████████████████████████████████████████████████████████----------------------------------------|60.0% 12/20|█████████████████████████████████████████████████████████████████-----------------------------------|65.0% 13/20|██████████████████████████████████████████████████████████████████████------------------------------|70.0% 14/20|███████████████████████████████████████████████████████████████████████████-------------------------|75.0% 15/20|████████████████████████████████████████████████████████████████████████████████--------------------|80.0% 16/20|█████████████████████████████████████████████████████████████████████████████████████---------------|85.0% 17/20|██████████████████████████████████████████████████████████████████████████████████████████----------|90.0% 18/20|███████████████████████████████████████████████████████████████████████████████████████████████-----|95.0% 19/20|████████████████████████████████████████████████████████████████████████████████████████████████████|100.0% 20/20

/hdd2/kaylee/AutoWS-Bench-101/fwrench/lf_selectors/interactive_multiclass/iws.py:152: SparseEfficiencyWarning: Comparing a sparse matrix with a nonzero scalar using != is inefficient, try using == instead.
  accuracy = evaluate_complex_multiclass(LFs, Ytrue, scoring_fn)
/hdd2/kaylee/AutoWS-Bench-101/fwrench/lf_selectors/interactive_multiclass/utils.py:635: RuntimeWarning: invalid value encountered in true_divide
  accuracy = (tp) / numvotes
[82, 178, 299, 484, 245, 73, 111, 506, 1017, 249, 148, 29, 142, 449, 65, 77, 106, 391, 165, 80, 328, 493, 459, 183, 362, 365, 138, 436, 279, 342, 508, 384, 213, 454, 434, 17, 433, 159, 154, 97, 416, 13, 428, 112, 239, 401, 41, 45, 986, 207, 216, 141, 362, 37, 51, 208, 444, 645, 260]
  0%|          | 0/100 [00:00<?, ?epoch/s] 14%|█▍        | 14/100 [00:00<00:00, 132.14epoch/s] 36%|███▌      | 36/100 [00:00<00:00, 182.51epoch/s] 59%|█████▉    | 59/100 [00:00<00:00, 203.79epoch/s] 82%|████████▏ | 82/100 [00:00<00:00, 213.19epoch/s]100%|██████████| 100/100 [00:00<00:00, 206.35epoch/s]
2022-08-09 05:31:13 - [0.00000000e+00 7.73800219e-01 0.00000000e+00 7.86275911e-03
 3.66820276e-02 3.83164582e-01 0.00000000e+00 6.92880651e-04
 2.94279934e-03 2.83145659e-01]
2022-08-09 05:31:13 - [train] accuracy: 0.1563, coverage: 0.9765
2022-08-09 05:31:13 - [0.         1.         0.         0.         0.08333333 0.75
 0.         0.         0.         0.46153846]
2022-08-09 05:31:13 - [valid] accuracy: 0.2947, coverage: 0.9500
2022-08-09 05:31:14 - [0.         0.78464254 0.         0.00822199 0.03354298 0.42172897
 0.         0.001001   0.00521376 0.29568789]
2022-08-09 05:31:14 - [test] accuracy: 0.1627, coverage: 0.9735
2022-08-09 05:31:14 - label model train acc:    0.16271186440677965
2022-08-09 05:31:14 - label model coverage:     0.9735
0.16271186440677965
