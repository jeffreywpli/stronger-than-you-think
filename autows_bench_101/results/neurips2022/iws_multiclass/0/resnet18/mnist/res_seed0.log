/hdd2/kaylee/anaconda3/envs/AutoWS-Bench-101/lib/python3.7/site-packages/torchvision/datasets/mnist.py:498: UserWarning: The given NumPy array is not writeable, and PyTorch does not support non-writeable tensors. This means you can write to the underlying (supposedly non-writeable) NumPy array using the tensor. You may want to copy the array to protect its data or make it writeable before converting it to a tensor. This type of warning will be suppressed for the rest of this program. (Triggered internally at  /opt/conda/conda-bld/pytorch_1631630836880/work/torch/csrc/utils/tensor_numpy.cpp:180.)
  return torch.from_numpy(parsed.astype(m[2], copy=False)).view(*s)
2022-08-09 05:21:36 - loading data from datasets/MNIST_3000/train.json
  0%|          | 0/57000 [00:00<?, ?it/s]  1%|▏         | 725/57000 [00:00<00:07, 7247.97it/s]  3%|▎         | 1455/57000 [00:00<00:07, 7277.28it/s]  4%|▍         | 2186/57000 [00:00<00:07, 7289.94it/s]  5%|▌         | 2918/57000 [00:00<00:07, 7298.28it/s]  6%|▋         | 3656/57000 [00:00<00:07, 7326.26it/s]  8%|▊         | 4399/57000 [00:00<00:07, 7359.59it/s]  9%|▉         | 5136/57000 [00:00<00:07, 7360.13it/s] 10%|█         | 5877/57000 [00:00<00:06, 7375.43it/s] 12%|█▏        | 6615/57000 [00:00<00:06, 7330.51it/s] 13%|█▎        | 7349/57000 [00:01<00:06, 7270.56it/s] 14%|█▍        | 8110/57000 [00:01<00:06, 7372.89it/s] 16%|█▌        | 8848/57000 [00:01<00:06, 7337.43it/s] 17%|█▋        | 9612/57000 [00:01<00:06, 7427.26it/s] 18%|█▊        | 10386/57000 [00:01<00:06, 7518.42it/s] 20%|█▉        | 11150/57000 [00:01<00:06, 7553.48it/s] 21%|██        | 11926/57000 [00:01<00:05, 7614.20it/s] 22%|██▏       | 12699/57000 [00:01<00:05, 7647.39it/s] 24%|██▎       | 13465/57000 [00:01<00:05, 7650.39it/s] 25%|██▌       | 14251/57000 [00:01<00:05, 7712.65it/s] 26%|██▋       | 15023/57000 [00:02<00:05, 7672.39it/s] 28%|██▊       | 15792/57000 [00:02<00:05, 7677.09it/s] 29%|██▉       | 16566/57000 [00:02<00:05, 7692.89it/s] 30%|███       | 17336/57000 [00:02<00:05, 7618.40it/s] 32%|███▏      | 18112/57000 [00:02<00:05, 7658.38it/s] 33%|███▎      | 18878/57000 [00:02<00:04, 7635.05it/s] 34%|███▍      | 19642/57000 [00:02<00:04, 7565.71it/s] 36%|███▌      | 20421/57000 [00:02<00:04, 7628.46it/s] 37%|███▋      | 21185/57000 [00:02<00:04, 7400.35it/s] 39%|███▊      | 21955/57000 [00:02<00:04, 7487.17it/s] 40%|███▉      | 22709/57000 [00:03<00:04, 7500.64it/s] 41%|████      | 23460/57000 [00:03<00:04, 7498.90it/s] 42%|████▏     | 24222/57000 [00:03<00:04, 7533.35it/s] 44%|████▍     | 24976/57000 [00:03<00:04, 7474.28it/s] 45%|████▌     | 25731/57000 [00:03<00:04, 7494.76it/s] 46%|████▋     | 26492/57000 [00:03<00:04, 7525.16it/s] 48%|████▊     | 27245/57000 [00:03<00:03, 7477.43it/s] 49%|████▉     | 27993/57000 [00:03<00:03, 7393.66it/s] 50%|█████     | 28733/57000 [00:03<00:03, 7382.84it/s] 52%|█████▏    | 29487/57000 [00:03<00:03, 7427.14it/s] 53%|█████▎    | 30242/57000 [00:04<00:03, 7461.13it/s] 54%|█████▍    | 30995/57000 [00:04<00:03, 7480.42it/s] 56%|█████▌    | 31748/57000 [00:04<00:03, 7493.50it/s] 57%|█████▋    | 32506/57000 [00:04<00:03, 7518.19it/s] 58%|█████▊    | 33258/57000 [00:04<00:03, 7501.17it/s] 60%|█████▉    | 34014/57000 [00:04<00:03, 7516.75it/s] 61%|██████    | 34766/57000 [00:04<00:02, 7516.52it/s] 62%|██████▏   | 35518/57000 [00:04<00:02, 7500.66it/s] 64%|██████▎   | 36275/57000 [00:04<00:02, 7521.13it/s] 65%|██████▍   | 37028/57000 [00:04<00:02, 7510.58it/s] 66%|██████▋   | 37781/57000 [00:05<00:02, 7513.74it/s] 68%|██████▊   | 38533/57000 [00:05<00:02, 7482.78it/s] 69%|██████▉   | 39282/57000 [00:05<00:02, 7455.74it/s] 70%|███████   | 40031/57000 [00:05<00:02, 7465.18it/s] 72%|███████▏  | 40778/57000 [00:05<00:02, 7424.85it/s] 73%|███████▎  | 41521/57000 [00:05<00:02, 7395.37it/s] 74%|███████▍  | 42261/57000 [00:05<00:01, 7387.94it/s] 75%|███████▌  | 43000/57000 [00:05<00:01, 7357.23it/s] 77%|███████▋  | 43751/57000 [00:05<00:01, 7402.43it/s] 78%|███████▊  | 44495/57000 [00:05<00:01, 7413.51it/s] 79%|███████▉  | 45241/57000 [00:06<00:01, 7425.74it/s] 81%|████████  | 45984/57000 [00:06<00:01, 7241.75it/s] 82%|████████▏ | 46710/57000 [00:06<00:01, 7221.18it/s] 83%|████████▎ | 47433/57000 [00:06<00:01, 7214.31it/s] 84%|████████▍ | 48155/57000 [00:06<00:01, 7202.40it/s] 86%|████████▌ | 48876/57000 [00:06<00:01, 7159.27it/s] 87%|████████▋ | 49656/57000 [00:06<00:00, 7347.85it/s] 88%|████████▊ | 50421/57000 [00:06<00:00, 7435.94it/s] 90%|████████▉ | 51165/57000 [00:06<00:00, 7423.64it/s] 91%|█████████ | 51947/57000 [00:06<00:00, 7540.08it/s] 92%|█████████▏| 52702/57000 [00:07<00:00, 7492.34it/s] 94%|█████████▍| 53452/57000 [00:07<00:00, 7180.15it/s] 95%|█████████▌| 54173/57000 [00:07<00:00, 7051.30it/s] 96%|█████████▋| 54920/57000 [00:07<00:00, 7169.88it/s] 98%|█████████▊| 55668/57000 [00:07<00:00, 7258.07it/s] 99%|█████████▉| 56411/57000 [00:07<00:00, 7306.69it/s]100%|██████████| 57000/57000 [00:07<00:00, 7432.72it/s]
2022-08-09 05:21:44 - loading data from datasets/MNIST_3000/valid.json
  0%|          | 0/3000 [00:00<?, ?it/s] 25%|██▍       | 737/3000 [00:00<00:00, 7369.43it/s] 50%|████▉     | 1485/3000 [00:00<00:00, 7429.60it/s] 74%|███████▍  | 2234/3000 [00:00<00:00, 7453.04it/s] 99%|█████████▉| 2980/3000 [00:00<00:00, 7435.28it/s]100%|██████████| 3000/3000 [00:00<00:00, 7430.94it/s]
2022-08-09 05:21:44 - loading data from datasets/MNIST_3000/test.json
  0%|          | 0/10000 [00:00<?, ?it/s]  7%|▋         | 736/10000 [00:00<00:01, 7358.45it/s] 15%|█▍        | 1472/10000 [00:00<00:01, 7261.66it/s] 22%|██▏       | 2215/10000 [00:00<00:01, 7337.50it/s] 30%|██▉       | 2959/10000 [00:00<00:00, 7376.96it/s] 37%|███▋      | 3697/10000 [00:00<00:00, 7327.79it/s] 44%|████▍     | 4430/10000 [00:00<00:00, 7254.68it/s] 52%|█████▏    | 5174/10000 [00:00<00:00, 7311.66it/s] 59%|█████▉    | 5906/10000 [00:00<00:00, 7279.18it/s] 67%|██████▋   | 6654/10000 [00:00<00:00, 7341.20it/s] 74%|███████▍  | 7397/10000 [00:01<00:00, 7365.89it/s] 81%|████████▏ | 8140/10000 [00:01<00:00, 7383.05it/s] 89%|████████▉ | 8881/10000 [00:01<00:00, 7390.56it/s] 96%|█████████▌| 9621/10000 [00:01<00:00, 7317.15it/s]100%|██████████| 10000/10000 [00:01<00:00, 7325.60it/s]2022-08-09 05:22:14 - Using LF classes: [functools.partial(<class 'sklearn.tree._classes.DecisionTreeClassifier'>, max_depth=1), <class 'sklearn.linear_model._logistic.LogisticRegression'>]
|----------------------------------------------------------------------------------------------------|0.0% 0/20|█████-----------------------------------------------------------------------------------------------|5.0% 1/20|██████████------------------------------------------------------------------------------------------|10.0% 2/20|███████████████-------------------------------------------------------------------------------------|15.0% 3/20|----------------------------------------------------------------------------------------------------|0.0% 0/20|█████-----------------------------------------------------------------------------------------------|5.0% 1/20|██████████------------------------------------------------------------------------------------------|10.0% 2/20|███████████████-------------------------------------------------------------------------------------|15.0% 3/20|████████████████████--------------------------------------------------------------------------------|20.0% 4/20|█████████████████████████---------------------------------------------------------------------------|25.0% 5/20|██████████████████████████████----------------------------------------------------------------------|30.0% 6/20|███████████████████████████████████-----------------------------------------------------------------|35.0% 7/20|████████████████████████████████████████------------------------------------------------------------|40.0% 8/20|█████████████████████████████████████████████-------------------------------------------------------|45.0% 9/20|██████████████████████████████████████████████████--------------------------------------------------|50.0% 10/20|███████████████████████████████████████████████████████---------------------------------------------|55.0% 11/20|████████████████████████████████████████████████████████████----------------------------------------|60.0% 12/20|█████████████████████████████████████████████████████████████████-----------------------------------|65.0% 13/20|██████████████████████████████████████████████████████████████████████------------------------------|70.0% 14/20|███████████████████████████████████████████████████████████████████████████-------------------------|75.0% 15/20|████████████████████████████████████████████████████████████████████████████████--------------------|80.0% 16/20|█████████████████████████████████████████████████████████████████████████████████████---------------|85.0% 17/20|██████████████████████████████████████████████████████████████████████████████████████████----------|90.0% 18/20|███████████████████████████████████████████████████████████████████████████████████████████████-----|95.0% 19/20|████████████████████████████████████████████████████████████████████████████████████████████████████|100.0% 20/20

/hdd2/kaylee/anaconda3/envs/AutoWS-Bench-101/lib/python3.7/site-packages/sklearn/linear_model/_logistic.py:765: ConvergenceWarning: lbfgs failed to converge (status=1):
STOP: TOTAL NO. of ITERATIONS REACHED LIMIT.

Increase the number of iterations (max_iter) or scale the data as shown in:
    https://scikit-learn.org/stable/modules/preprocessing.html
Please also refer to the documentation for alternative solver options:
    https://scikit-learn.org/stable/modules/linear_model.html#logistic-regression
  extra_warning_msg=_LOGISTIC_SOLVER_CONVERGENCE_MSG)
/hdd2/kaylee/AutoWS-Bench-101/fwrench/lf_selectors/interactive_multiclass/iws.py:152: SparseEfficiencyWarning: Comparing a sparse matrix with a nonzero scalar using != is inefficient, try using == instead.
  accuracy = evaluate_complex_multiclass(LFs, Ytrue, scoring_fn)
/hdd2/kaylee/AutoWS-Bench-101/fwrench/lf_selectors/interactive_multiclass/utils.py:635: RuntimeWarning: invalid value encountered in true_divide
  accuracy = (tp) / numvotes
[82, 256, 75, 698, 197, 152, 293, 184, 328, 255, 148, 309, 326, 274, 73, 140, 344, 158, 335, 382, 229, 339, 250, 147, 518, 297, 398, 452, 263, 918, 133, 330, 625, 535, 832, 507, 236, 332, 157, 24, 826, 372, 64, 4, 373, 394, 163, 3, 65, 261, 443, 238, 475, 488, 290]
  0%|          | 0/100 [00:00<?, ?epoch/s] 18%|█▊        | 18/100 [00:00<00:00, 173.09epoch/s] 38%|███▊      | 38/100 [00:00<00:00, 187.29epoch/s] 60%|██████    | 60/100 [00:00<00:00, 201.64epoch/s] 86%|████████▌ | 86/100 [00:00<00:00, 222.37epoch/s]100%|██████████| 100/100 [00:00<00:00, 216.94epoch/s]
2022-08-09 05:24:03 - [0.02348512 0.9996877  0.         0.46466431 0.1407767  0.15550756
 0.11208752 0.00336927 0.         0.54031244]
2022-08-09 05:24:03 - [train] accuracy: 0.2551, coverage: 0.9898
2022-08-09 05:24:03 - [0.09090909 1.         0.         0.63636364 0.08333333 0.58333333
 0.42857143 0.         0.         0.69230769]
2022-08-09 05:24:03 - [valid] accuracy: 0.4082, coverage: 0.9800
2022-08-09 05:24:03 - [2.37603306e-02 9.99118943e-01 0.00000000e+00 4.63190184e-01
 1.52749491e-01 1.97488584e-01 1.44973545e-01 9.72762646e-04
 0.00000000e+00 5.30303030e-01]
2022-08-09 05:24:03 - [test] accuracy: 0.2626, coverage: 0.9885
2022-08-09 05:24:03 - label model train acc:    0.2626201315123925
2022-08-09 05:24:03 - label model coverage:     0.9885
0.2626201315123925
