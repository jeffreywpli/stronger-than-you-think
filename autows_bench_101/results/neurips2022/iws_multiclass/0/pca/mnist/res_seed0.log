/hdd2/kaylee/anaconda3/envs/AutoWS-Bench-101/lib/python3.7/site-packages/torchvision/datasets/mnist.py:498: UserWarning: The given NumPy array is not writeable, and PyTorch does not support non-writeable tensors. This means you can write to the underlying (supposedly non-writeable) NumPy array using the tensor. You may want to copy the array to protect its data or make it writeable before converting it to a tensor. This type of warning will be suppressed for the rest of this program. (Triggered internally at  /opt/conda/conda-bld/pytorch_1631630836880/work/torch/csrc/utils/tensor_numpy.cpp:180.)
  return torch.from_numpy(parsed.astype(m[2], copy=False)).view(*s)
2022-08-09 04:15:34 - loading data from datasets/MNIST_3000/train.json
  0%|          | 0/57000 [00:00<?, ?it/s]  1%|▏         | 729/57000 [00:00<00:07, 7280.88it/s]  3%|▎         | 1461/57000 [00:00<00:07, 7298.48it/s]  4%|▍         | 2191/57000 [00:00<00:07, 7271.58it/s]  5%|▌         | 2919/57000 [00:00<00:07, 7213.38it/s]  6%|▋         | 3641/57000 [00:00<00:07, 7185.49it/s]  8%|▊         | 4362/57000 [00:00<00:07, 7192.73it/s]  9%|▉         | 5089/57000 [00:00<00:07, 7215.70it/s] 10%|█         | 5817/57000 [00:00<00:07, 7235.73it/s] 11%|█▏        | 6549/57000 [00:00<00:06, 7260.35it/s] 13%|█▎        | 7276/57000 [00:01<00:06, 7254.69it/s] 14%|█▍        | 8002/57000 [00:01<00:06, 7244.67it/s] 15%|█▌        | 8727/57000 [00:01<00:06, 7211.19it/s] 17%|█▋        | 9449/57000 [00:01<00:06, 7036.84it/s] 18%|█▊        | 10183/57000 [00:01<00:06, 7124.85it/s] 19%|█▉        | 10900/57000 [00:01<00:06, 7136.11it/s] 20%|██        | 11616/57000 [00:01<00:06, 7143.03it/s] 22%|██▏       | 12362/57000 [00:01<00:06, 7235.32it/s] 23%|██▎       | 13100/57000 [00:01<00:06, 7277.84it/s] 24%|██▍       | 13839/57000 [00:01<00:05, 7310.65it/s] 26%|██▌       | 14572/57000 [00:02<00:05, 7315.57it/s] 27%|██▋       | 15304/57000 [00:02<00:05, 7269.16it/s] 28%|██▊       | 16035/57000 [00:02<00:05, 7278.55it/s] 29%|██▉       | 16772/57000 [00:02<00:05, 7305.45it/s] 31%|███       | 17511/57000 [00:02<00:05, 7327.89it/s] 32%|███▏      | 18244/57000 [00:02<00:05, 7266.70it/s] 33%|███▎      | 18976/57000 [00:02<00:05, 7282.14it/s] 35%|███▍      | 19705/57000 [00:02<00:05, 7215.03it/s] 36%|███▌      | 20427/57000 [00:02<00:05, 7184.95it/s] 37%|███▋      | 21146/57000 [00:02<00:04, 7177.62it/s] 38%|███▊      | 21865/57000 [00:03<00:04, 7180.52it/s] 40%|███▉      | 22584/57000 [00:03<00:04, 7053.10it/s] 41%|████      | 23312/57000 [00:03<00:04, 7118.75it/s] 42%|████▏     | 24042/57000 [00:03<00:04, 7170.83it/s] 43%|████▎     | 24760/57000 [00:03<00:04, 7112.44it/s] 45%|████▍     | 25476/57000 [00:03<00:04, 7124.26it/s] 46%|████▌     | 26207/57000 [00:03<00:04, 7177.47it/s] 47%|████▋     | 26925/57000 [00:03<00:04, 7088.10it/s] 49%|████▊     | 27663/57000 [00:03<00:04, 7172.29it/s] 50%|████▉     | 28381/57000 [00:03<00:03, 7168.23it/s] 51%|█████     | 29099/57000 [00:04<00:03, 7146.55it/s] 52%|█████▏    | 29829/57000 [00:04<00:03, 7191.60it/s] 54%|█████▎    | 30549/57000 [00:04<00:03, 7154.68it/s] 55%|█████▍    | 31290/57000 [00:04<00:03, 7228.32it/s] 56%|█████▌    | 32024/57000 [00:04<00:03, 7259.10it/s] 57%|█████▋    | 32751/57000 [00:04<00:03, 6999.20it/s] 59%|█████▊    | 33485/57000 [00:04<00:03, 7096.51it/s] 60%|██████    | 34221/57000 [00:04<00:03, 7173.67it/s] 61%|██████▏   | 34962/57000 [00:04<00:03, 7241.67it/s] 63%|██████▎   | 35688/57000 [00:04<00:02, 7177.80it/s] 64%|██████▍   | 36418/57000 [00:05<00:02, 7210.91it/s] 65%|██████▌   | 37149/57000 [00:05<00:02, 7238.36it/s] 66%|██████▋   | 37874/57000 [00:05<00:02, 7137.04it/s] 68%|██████▊   | 38623/57000 [00:05<00:02, 7240.96it/s] 69%|██████▉   | 39348/57000 [00:05<00:02, 7230.36it/s] 70%|███████   | 40072/57000 [00:05<00:02, 7175.58it/s] 72%|███████▏  | 40790/57000 [00:05<00:02, 7166.81it/s] 73%|███████▎  | 41507/57000 [00:05<00:02, 7155.34it/s] 74%|███████▍  | 42245/57000 [00:05<00:02, 7220.91it/s] 75%|███████▌  | 42980/57000 [00:05<00:01, 7258.01it/s] 77%|███████▋  | 43706/57000 [00:06<00:01, 6999.34it/s] 78%|███████▊  | 44444/57000 [00:06<00:01, 7109.31it/s] 79%|███████▉  | 45180/57000 [00:06<00:01, 7180.37it/s] 81%|████████  | 45921/57000 [00:06<00:01, 7247.07it/s] 82%|████████▏ | 46660/57000 [00:06<00:01, 7288.98it/s] 83%|████████▎ | 47399/57000 [00:06<00:01, 7316.32it/s] 84%|████████▍ | 48139/57000 [00:06<00:01, 7340.57it/s] 86%|████████▌ | 48874/57000 [00:06<00:01, 7336.47it/s] 87%|████████▋ | 49615/57000 [00:06<00:01, 7357.05it/s] 88%|████████▊ | 50355/57000 [00:06<00:00, 7366.97it/s] 90%|████████▉ | 51092/57000 [00:07<00:00, 7350.60it/s] 91%|█████████ | 51839/57000 [00:07<00:00, 7384.69it/s] 92%|█████████▏| 52578/57000 [00:07<00:00, 7348.68it/s] 94%|█████████▎| 53313/57000 [00:07<00:00, 7320.71it/s] 95%|█████████▍| 54046/57000 [00:07<00:00, 7274.52it/s] 96%|█████████▌| 54774/57000 [00:07<00:00, 7232.29it/s] 97%|█████████▋| 55528/57000 [00:07<00:00, 7322.42it/s] 99%|█████████▉| 56301/57000 [00:07<00:00, 7442.97it/s]100%|██████████| 57000/57000 [00:07<00:00, 7231.39it/s]
2022-08-09 04:15:43 - loading data from datasets/MNIST_3000/valid.json
  0%|          | 0/3000 [00:00<?, ?it/s] 23%|██▎       | 693/3000 [00:00<00:00, 6925.61it/s] 48%|████▊     | 1434/3000 [00:00<00:00, 7208.93it/s] 72%|███████▏  | 2158/3000 [00:00<00:00, 7219.25it/s] 96%|█████████▌| 2880/3000 [00:00<00:00, 7129.79it/s]100%|██████████| 3000/3000 [00:00<00:00, 7136.09it/s]
2022-08-09 04:15:43 - loading data from datasets/MNIST_3000/test.json
  0%|          | 0/10000 [00:00<?, ?it/s]  7%|▋         | 713/10000 [00:00<00:01, 7124.55it/s] 14%|█▍        | 1426/10000 [00:00<00:01, 7124.82it/s] 22%|██▏       | 2157/10000 [00:00<00:01, 7207.39it/s] 29%|██▉       | 2886/10000 [00:00<00:00, 7236.31it/s] 36%|███▌      | 3610/10000 [00:00<00:00, 7186.87it/s] 43%|████▎     | 4335/10000 [00:00<00:00, 7205.34it/s] 51%|█████     | 5056/10000 [00:00<00:00, 7200.46it/s] 58%|█████▊    | 5777/10000 [00:00<00:00, 6854.89it/s] 65%|██████▍   | 6476/10000 [00:00<00:00, 6893.44it/s] 72%|███████▏  | 7168/10000 [00:01<00:00, 6814.08it/s] 79%|███████▉  | 7916/10000 [00:01<00:00, 7010.88it/s] 86%|████████▋ | 8629/10000 [00:01<00:00, 7046.03it/s] 94%|█████████▍| 9377/10000 [00:01<00:00, 7174.05it/s]100%|██████████| 10000/10000 [00:01<00:00, 7056.87it/s](67100, 784)
2022-08-09 04:15:50 - Using LF classes: [functools.partial(<class 'sklearn.tree._classes.DecisionTreeClassifier'>, max_depth=1), <class 'sklearn.linear_model._logistic.LogisticRegression'>]
|----------------------------------------------------------------------------------------------------|0.0% 0/20|█████-----------------------------------------------------------------------------------------------|5.0% 1/20|██████████------------------------------------------------------------------------------------------|10.0% 2/20|███████████████-------------------------------------------------------------------------------------|15.0% 3/20|----------------------------------------------------------------------------------------------------|0.0% 0/20|█████-----------------------------------------------------------------------------------------------|5.0% 1/20|██████████------------------------------------------------------------------------------------------|10.0% 2/20|███████████████-------------------------------------------------------------------------------------|15.0% 3/20|████████████████████--------------------------------------------------------------------------------|20.0% 4/20|█████████████████████████---------------------------------------------------------------------------|25.0% 5/20|██████████████████████████████----------------------------------------------------------------------|30.0% 6/20|███████████████████████████████████-----------------------------------------------------------------|35.0% 7/20|████████████████████████████████████████------------------------------------------------------------|40.0% 8/20|█████████████████████████████████████████████-------------------------------------------------------|45.0% 9/20|██████████████████████████████████████████████████--------------------------------------------------|50.0% 10/20|███████████████████████████████████████████████████████---------------------------------------------|55.0% 11/20|████████████████████████████████████████████████████████████----------------------------------------|60.0% 12/20|█████████████████████████████████████████████████████████████████-----------------------------------|65.0% 13/20|██████████████████████████████████████████████████████████████████████------------------------------|70.0% 14/20|███████████████████████████████████████████████████████████████████████████-------------------------|75.0% 15/20|████████████████████████████████████████████████████████████████████████████████--------------------|80.0% 16/20|█████████████████████████████████████████████████████████████████████████████████████---------------|85.0% 17/20|██████████████████████████████████████████████████████████████████████████████████████████----------|90.0% 18/20|███████████████████████████████████████████████████████████████████████████████████████████████-----|95.0% 19/20|████████████████████████████████████████████████████████████████████████████████████████████████████|100.0% 20/20

/hdd2/kaylee/AutoWS-Bench-101/fwrench/lf_selectors/interactive_multiclass/iws.py:152: SparseEfficiencyWarning: Comparing a sparse matrix with a nonzero scalar using != is inefficient, try using == instead.
  accuracy = evaluate_complex_multiclass(LFs, Ytrue, scoring_fn)
/hdd2/kaylee/AutoWS-Bench-101/fwrench/lf_selectors/interactive_multiclass/utils.py:635: RuntimeWarning: invalid value encountered in true_divide
  accuracy = (tp) / numvotes
  0%|          | 0/100 [00:00<?, ?epoch/s] 41%|████      | 41/100 [00:00<00:00, 404.47epoch/s] 97%|█████████▋| 97/100 [00:00<00:00, 492.42epoch/s]100%|██████████| 100/100 [00:00<00:00, 481.49epoch/s]
2022-08-09 04:17:14 - [0.         0.         0.         0.00561903 0.49674929 0.49504337
 0.09272146 0.01451028 0.03165412 0.24471058]
2022-08-09 04:17:14 - [train] accuracy: 0.1377, coverage: 0.8695
2022-08-09 04:17:14 - [0.         0.         0.         0.         1.         1.
 0.5        0.42857143 0.71428571 0.81818182]
2022-08-09 04:17:14 - [valid] accuracy: 0.5122, coverage: 0.8200
2022-08-09 04:17:14 - [0.         0.         0.         0.01287554 0.5250291  0.52764423
 0.09988901 0.01880141 0.03769401 0.24505495]
2022-08-09 04:17:14 - [test] accuracy: 0.1466, coverage: 0.8631
2022-08-09 04:17:14 - label model train acc:    0.14656470860850423
2022-08-09 04:17:14 - label model coverage:     0.8631
0.14656470860850423
