2022-05-22 07:23:50 - loading data from datasets/FashionMNIST_3000/train.json
  0%|          | 0/57000 [00:00<?, ?it/s]  1%|          | 286/57000 [00:00<00:19, 2854.31it/s]  1%|          | 574/57000 [00:00<00:19, 2866.82it/s]  2%|▏         | 863/57000 [00:00<00:19, 2873.98it/s]  2%|▏         | 1151/57000 [00:00<00:19, 2873.80it/s]  3%|▎         | 1440/57000 [00:00<00:19, 2878.15it/s]  3%|▎         | 1728/57000 [00:00<00:19, 2877.65it/s]  4%|▎         | 2016/57000 [00:00<00:19, 2877.85it/s]  4%|▍         | 2304/57000 [00:00<00:19, 2877.91it/s]  5%|▍         | 2593/57000 [00:00<00:18, 2881.27it/s]  5%|▌         | 2882/57000 [00:01<00:18, 2881.28it/s]  6%|▌         | 3171/57000 [00:01<00:18, 2877.04it/s]  6%|▌         | 3460/57000 [00:01<00:18, 2878.56it/s]  7%|▋         | 3749/57000 [00:01<00:18, 2878.96it/s]  7%|▋         | 4037/57000 [00:01<00:18, 2879.21it/s]  8%|▊         | 4326/57000 [00:01<00:18, 2880.41it/s]  8%|▊         | 4615/57000 [00:01<00:18, 2881.22it/s]  9%|▊         | 4904/57000 [00:01<00:18, 2880.03it/s]  9%|▉         | 5193/57000 [00:01<00:17, 2881.24it/s] 10%|▉         | 5482/57000 [00:01<00:17, 2880.74it/s] 10%|█         | 5771/57000 [00:02<00:17, 2881.81it/s] 11%|█         | 6060/57000 [00:02<00:17, 2881.75it/s] 11%|█         | 6349/57000 [00:02<00:17, 2881.81it/s] 12%|█▏        | 6638/57000 [00:02<00:17, 2877.78it/s] 12%|█▏        | 6926/57000 [00:02<00:17, 2876.28it/s] 13%|█▎        | 7215/57000 [00:02<00:17, 2879.04it/s] 13%|█▎        | 7503/57000 [00:02<00:17, 2877.23it/s] 14%|█▎        | 7792/57000 [00:02<00:17, 2879.04it/s] 14%|█▍        | 8082/57000 [00:02<00:16, 2882.86it/s] 15%|█▍        | 8371/57000 [00:02<00:16, 2882.33it/s] 15%|█▌        | 8660/57000 [00:03<00:16, 2881.09it/s] 16%|█▌        | 8949/57000 [00:03<00:16, 2879.93it/s] 16%|█▌        | 9238/57000 [00:03<00:16, 2881.60it/s] 17%|█▋        | 9527/57000 [00:03<00:16, 2877.13it/s] 17%|█▋        | 9815/57000 [00:03<00:16, 2875.04it/s] 18%|█▊        | 10104/57000 [00:03<00:16, 2878.49it/s] 18%|█▊        | 10393/57000 [00:03<00:16, 2881.53it/s] 19%|█▊        | 10682/57000 [00:03<00:16, 2881.86it/s] 19%|█▉        | 10971/57000 [00:03<00:15, 2884.14it/s] 20%|█▉        | 11260/57000 [00:03<00:15, 2882.81it/s] 20%|██        | 11549/57000 [00:04<00:15, 2882.04it/s] 21%|██        | 11838/57000 [00:04<00:15, 2869.42it/s] 21%|██▏       | 12127/57000 [00:04<00:15, 2874.22it/s] 22%|██▏       | 12416/57000 [00:04<00:15, 2877.64it/s] 22%|██▏       | 12705/57000 [00:04<00:15, 2878.97it/s] 23%|██▎       | 12994/57000 [00:04<00:15, 2881.88it/s] 23%|██▎       | 13283/57000 [00:04<00:15, 2879.15it/s] 24%|██▍       | 13571/57000 [00:04<00:15, 2879.27it/s] 24%|██▍       | 13859/57000 [00:04<00:14, 2879.11it/s] 25%|██▍       | 14147/57000 [00:04<00:14, 2877.97it/s] 25%|██▌       | 14435/57000 [00:05<00:14, 2878.19it/s] 26%|██▌       | 14724/57000 [00:05<00:14, 2881.44it/s] 26%|██▋       | 15013/57000 [00:05<00:14, 2877.50it/s] 27%|██▋       | 15302/57000 [00:05<00:14, 2879.71it/s] 27%|██▋       | 15590/57000 [00:05<00:14, 2877.60it/s] 28%|██▊       | 15878/57000 [00:05<00:14, 2877.29it/s] 28%|██▊       | 16167/57000 [00:05<00:14, 2879.43it/s] 29%|██▉       | 16456/57000 [00:05<00:14, 2879.97it/s] 29%|██▉       | 16745/57000 [00:05<00:13, 2880.26it/s] 30%|██▉       | 17034/57000 [00:05<00:13, 2880.07it/s] 30%|███       | 17323/57000 [00:06<00:13, 2869.84it/s] 31%|███       | 17613/57000 [00:06<00:13, 2876.23it/s] 31%|███▏      | 17901/57000 [00:06<00:13, 2872.27it/s] 32%|███▏      | 18190/57000 [00:06<00:13, 2875.90it/s] 32%|███▏      | 18478/57000 [00:06<00:13, 2876.89it/s] 33%|███▎      | 18767/57000 [00:06<00:13, 2878.13it/s] 33%|███▎      | 19056/57000 [00:06<00:13, 2881.13it/s] 34%|███▍      | 19345/57000 [00:06<00:13, 2879.18it/s] 34%|███▍      | 19633/57000 [00:06<00:12, 2878.39it/s] 35%|███▍      | 19921/57000 [00:06<00:12, 2873.65it/s] 35%|███▌      | 20210/57000 [00:07<00:12, 2877.59it/s] 36%|███▌      | 20499/57000 [00:07<00:12, 2880.56it/s] 36%|███▋      | 20788/57000 [00:07<00:12, 2878.05it/s] 37%|███▋      | 21077/57000 [00:07<00:12, 2879.59it/s] 37%|███▋      | 21365/57000 [00:07<00:12, 2877.18it/s] 38%|███▊      | 21654/57000 [00:07<00:12, 2878.72it/s] 38%|███▊      | 21943/57000 [00:07<00:12, 2881.11it/s] 39%|███▉      | 22232/57000 [00:07<00:12, 2882.28it/s] 40%|███▉      | 22521/57000 [00:07<00:11, 2879.22it/s] 40%|████      | 22810/57000 [00:07<00:11, 2879.21it/s] 41%|████      | 23098/57000 [00:08<00:11, 2878.90it/s] 41%|████      | 23387/57000 [00:08<00:11, 2879.42it/s] 42%|████▏     | 23675/57000 [00:08<00:11, 2879.17it/s] 42%|████▏     | 23963/57000 [00:08<00:11, 2878.87it/s] 43%|████▎     | 24252/57000 [00:08<00:11, 2879.37it/s] 43%|████▎     | 24540/57000 [00:08<00:11, 2876.62it/s] 44%|████▎     | 24829/57000 [00:08<00:11, 2878.45it/s] 44%|████▍     | 25117/57000 [00:08<00:11, 2870.62it/s] 45%|████▍     | 25405/57000 [00:08<00:11, 2872.25it/s] 45%|████▌     | 25694/57000 [00:08<00:10, 2876.47it/s] 46%|████▌     | 25982/57000 [00:09<00:10, 2873.16it/s] 46%|████▌     | 26271/57000 [00:09<00:10, 2876.11it/s] 47%|████▋     | 26559/57000 [00:09<00:10, 2871.23it/s] 47%|████▋     | 26847/57000 [00:09<00:10, 2872.36it/s] 48%|████▊     | 27135/57000 [00:09<00:10, 2874.22it/s] 48%|████▊     | 27423/57000 [00:09<00:10, 2873.48it/s] 49%|████▊     | 27712/57000 [00:09<00:10, 2875.37it/s] 49%|████▉     | 28001/57000 [00:09<00:10, 2877.28it/s] 50%|████▉     | 28289/57000 [00:09<00:09, 2874.16it/s] 50%|█████     | 28578/57000 [00:09<00:09, 2876.92it/s] 51%|█████     | 28866/57000 [00:10<00:09, 2872.40it/s] 51%|█████     | 29154/57000 [00:10<00:09, 2872.38it/s] 52%|█████▏    | 29442/57000 [00:10<00:09, 2873.08it/s] 52%|█████▏    | 29730/57000 [00:10<00:09, 2873.72it/s] 53%|█████▎    | 30019/57000 [00:10<00:09, 2876.35it/s] 53%|█████▎    | 30307/57000 [00:10<00:09, 2874.44it/s] 54%|█████▎    | 30596/57000 [00:10<00:09, 2876.32it/s] 54%|█████▍    | 30884/57000 [00:10<00:09, 2873.79it/s] 55%|█████▍    | 31172/57000 [00:10<00:08, 2874.32it/s] 55%|█████▌    | 31460/57000 [00:10<00:08, 2875.22it/s] 56%|█████▌    | 31748/57000 [00:11<00:08, 2870.60it/s] 56%|█████▌    | 32037/57000 [00:11<00:08, 2874.18it/s] 57%|█████▋    | 32326/57000 [00:11<00:08, 2875.84it/s] 57%|█████▋    | 32614/57000 [00:11<00:08, 2876.77it/s] 58%|█████▊    | 32902/57000 [00:11<00:08, 2876.41it/s] 58%|█████▊    | 33190/57000 [00:11<00:08, 2871.28it/s] 59%|█████▊    | 33478/57000 [00:11<00:08, 2872.99it/s] 59%|█████▉    | 33766/57000 [00:11<00:08, 2874.47it/s] 60%|█████▉    | 34054/57000 [00:11<00:07, 2873.48it/s] 60%|██████    | 34342/57000 [00:11<00:07, 2874.10it/s] 61%|██████    | 34630/57000 [00:12<00:07, 2868.25it/s] 61%|██████▏   | 34918/57000 [00:12<00:07, 2870.98it/s] 62%|██████▏   | 35207/57000 [00:12<00:07, 2875.38it/s] 62%|██████▏   | 35495/57000 [00:12<00:07, 2874.26it/s] 63%|██████▎   | 35783/57000 [00:12<00:07, 2868.75it/s] 63%|██████▎   | 36071/57000 [00:12<00:07, 2869.87it/s] 64%|██████▍   | 36360/57000 [00:12<00:07, 2874.19it/s] 64%|██████▍   | 36649/57000 [00:12<00:07, 2878.70it/s] 65%|██████▍   | 36937/57000 [00:12<00:06, 2876.36it/s] 65%|██████▌   | 37226/57000 [00:12<00:06, 2877.48it/s] 66%|██████▌   | 37515/57000 [00:13<00:06, 2879.10it/s] 66%|██████▋   | 37804/57000 [00:13<00:06, 2879.36it/s] 67%|██████▋   | 38093/57000 [00:13<00:06, 2881.56it/s] 67%|██████▋   | 38382/57000 [00:13<00:06, 2878.47it/s] 68%|██████▊   | 38670/57000 [00:13<00:06, 2877.31it/s] 68%|██████▊   | 38958/57000 [00:13<00:06, 2873.03it/s] 69%|██████▉   | 39247/57000 [00:13<00:06, 2875.41it/s] 69%|██████▉   | 39536/57000 [00:13<00:06, 2876.88it/s] 70%|██████▉   | 39824/57000 [00:13<00:05, 2877.63it/s] 70%|███████   | 40112/57000 [00:13<00:05, 2877.82it/s] 71%|███████   | 40400/57000 [00:14<00:05, 2871.28it/s] 71%|███████▏  | 40689/57000 [00:14<00:05, 2876.54it/s] 72%|███████▏  | 40979/57000 [00:14<00:05, 2880.84it/s] 72%|███████▏  | 41268/57000 [00:14<00:05, 2878.91it/s] 73%|███████▎  | 41556/57000 [00:14<00:05, 2877.77it/s] 73%|███████▎  | 41844/57000 [00:14<00:05, 2877.84it/s] 74%|███████▍  | 42132/57000 [00:14<00:05, 2873.59it/s] 74%|███████▍  | 42420/57000 [00:14<00:05, 2874.22it/s] 75%|███████▍  | 42708/57000 [00:14<00:04, 2872.06it/s] 75%|███████▌  | 42996/57000 [00:14<00:04, 2872.82it/s] 76%|███████▌  | 43284/57000 [00:15<00:04, 2874.92it/s] 76%|███████▋  | 43572/57000 [00:15<00:04, 2871.68it/s] 77%|███████▋  | 43861/57000 [00:15<00:04, 2875.35it/s] 77%|███████▋  | 44149/57000 [00:15<00:04, 2872.07it/s] 78%|███████▊  | 44438/57000 [00:15<00:04, 2874.79it/s] 78%|███████▊  | 44727/57000 [00:15<00:04, 2876.71it/s] 79%|███████▉  | 45015/57000 [00:15<00:04, 2876.37it/s] 79%|███████▉  | 45303/57000 [00:15<00:04, 2869.87it/s] 80%|███████▉  | 45592/57000 [00:15<00:03, 2873.85it/s] 80%|████████  | 45881/57000 [00:15<00:03, 2876.99it/s] 81%|████████  | 46170/57000 [00:16<00:03, 2879.26it/s] 82%|████████▏ | 46458/57000 [00:16<00:03, 2875.01it/s] 82%|████████▏ | 46747/57000 [00:16<00:03, 2876.79it/s] 83%|████████▎ | 47035/57000 [00:16<00:03, 2877.47it/s] 83%|████████▎ | 47323/57000 [00:16<00:03, 2877.08it/s] 84%|████████▎ | 47612/57000 [00:16<00:03, 2878.21it/s] 84%|████████▍ | 47900/57000 [00:16<00:03, 2873.85it/s] 85%|████████▍ | 48188/57000 [00:16<00:03, 2875.43it/s] 85%|████████▌ | 48476/57000 [00:16<00:02, 2870.66it/s] 86%|████████▌ | 48764/57000 [00:16<00:02, 2871.40it/s] 86%|████████▌ | 49053/57000 [00:17<00:02, 2874.64it/s] 87%|████████▋ | 49342/57000 [00:17<00:02, 2876.50it/s] 87%|████████▋ | 49631/57000 [00:17<00:02, 2878.24it/s] 88%|████████▊ | 49919/57000 [00:17<00:02, 2877.11it/s] 88%|████████▊ | 50207/57000 [00:17<00:02, 2874.43it/s] 89%|████████▊ | 50496/57000 [00:17<00:02, 2876.55it/s] 89%|████████▉ | 50784/57000 [00:17<00:02, 2873.34it/s] 90%|████████▉ | 51072/57000 [00:17<00:02, 2868.34it/s] 90%|█████████ | 51361/57000 [00:17<00:01, 2873.47it/s] 91%|█████████ | 51649/57000 [00:17<00:01, 2874.26it/s] 91%|█████████ | 51938/57000 [00:18<00:01, 2876.82it/s] 92%|█████████▏| 52226/57000 [00:18<00:01, 2871.40it/s] 92%|█████████▏| 52515/57000 [00:18<00:01, 2874.05it/s] 93%|█████████▎| 52803/57000 [00:18<00:01, 2874.05it/s] 93%|█████████▎| 53091/57000 [00:18<00:01, 2870.76it/s] 94%|█████████▎| 53380/57000 [00:18<00:01, 2875.10it/s] 94%|█████████▍| 53668/57000 [00:18<00:01, 2873.65it/s] 95%|█████████▍| 53957/57000 [00:18<00:01, 2875.95it/s] 95%|█████████▌| 54246/57000 [00:18<00:00, 2879.52it/s] 96%|█████████▌| 54534/57000 [00:18<00:00, 2876.39it/s] 96%|█████████▌| 54822/57000 [00:19<00:00, 2876.14it/s] 97%|█████████▋| 55110/57000 [00:19<00:00, 2877.01it/s] 97%|█████████▋| 55398/57000 [00:19<00:00, 2877.10it/s] 98%|█████████▊| 55687/57000 [00:19<00:00, 2878.61it/s] 98%|█████████▊| 55976/57000 [00:19<00:00, 2879.27it/s] 99%|█████████▊| 56265/57000 [00:19<00:00, 2880.28it/s] 99%|█████████▉| 56554/57000 [00:19<00:00, 2876.18it/s]100%|█████████▉| 56842/57000 [00:19<00:00, 2876.11it/s]100%|██████████| 57000/57000 [00:19<00:00, 2876.51it/s]
2022-05-22 07:24:10 - loading data from datasets/FashionMNIST_3000/valid.json
  0%|          | 0/3000 [00:00<?, ?it/s] 10%|▉         | 288/3000 [00:00<00:00, 2869.64it/s] 19%|█▉        | 576/3000 [00:00<00:00, 2874.04it/s] 29%|██▉       | 864/3000 [00:00<00:00, 2875.82it/s] 38%|███▊      | 1153/3000 [00:00<00:00, 2878.00it/s] 48%|████▊     | 1441/3000 [00:00<00:00, 2877.83it/s] 58%|█████▊    | 1729/3000 [00:00<00:00, 2875.31it/s] 67%|██████▋   | 2017/3000 [00:00<00:00, 2873.85it/s] 77%|███████▋  | 2305/3000 [00:00<00:00, 2875.25it/s] 86%|████████▋ | 2594/3000 [00:00<00:00, 2876.87it/s] 96%|█████████▌| 2882/3000 [00:01<00:00, 2877.50it/s]100%|██████████| 3000/3000 [00:01<00:00, 2875.27it/s]
2022-05-22 07:24:11 - loading data from datasets/FashionMNIST_3000/test.json
  0%|          | 0/10000 [00:00<?, ?it/s]  3%|▎         | 287/10000 [00:00<00:03, 2864.76it/s]  6%|▌         | 574/10000 [00:00<00:03, 2864.36it/s]  9%|▊         | 862/10000 [00:00<00:03, 2869.52it/s] 12%|█▏        | 1150/10000 [00:00<00:03, 2870.95it/s] 14%|█▍        | 1438/10000 [00:00<00:02, 2870.58it/s] 17%|█▋        | 1726/10000 [00:00<00:02, 2871.95it/s] 20%|██        | 2014/10000 [00:00<00:02, 2869.93it/s] 23%|██▎       | 2301/10000 [00:00<00:02, 2867.89it/s] 26%|██▌       | 2588/10000 [00:00<00:02, 2866.91it/s] 29%|██▉       | 2876/10000 [00:01<00:02, 2868.50it/s] 32%|███▏      | 3163/10000 [00:01<00:02, 2866.59it/s] 34%|███▍      | 3450/10000 [00:01<00:02, 2861.91it/s] 37%|███▋      | 3737/10000 [00:01<00:02, 2863.09it/s] 40%|████      | 4024/10000 [00:01<00:02, 2862.15it/s] 43%|████▎     | 4311/10000 [00:01<00:01, 2860.74it/s] 46%|████▌     | 4598/10000 [00:01<00:01, 2862.70it/s] 49%|████▉     | 4885/10000 [00:01<00:01, 2863.47it/s] 52%|█████▏    | 5172/10000 [00:01<00:01, 2863.92it/s] 55%|█████▍    | 5459/10000 [00:01<00:01, 2864.21it/s] 57%|█████▋    | 5746/10000 [00:02<00:01, 2865.29it/s] 60%|██████    | 6033/10000 [00:02<00:01, 2866.43it/s] 63%|██████▎   | 6320/10000 [00:02<00:01, 2865.53it/s] 66%|██████▌   | 6607/10000 [00:02<00:01, 2864.17it/s] 69%|██████▉   | 6894/10000 [00:02<00:01, 2863.57it/s] 72%|███████▏  | 7181/10000 [00:02<00:00, 2863.69it/s] 75%|███████▍  | 7468/10000 [00:02<00:00, 2865.24it/s] 78%|███████▊  | 7755/10000 [00:02<00:00, 2863.08it/s] 80%|████████  | 8043/10000 [00:02<00:00, 2865.22it/s] 83%|████████▎ | 8331/10000 [00:02<00:00, 2867.42it/s] 86%|████████▌ | 8618/10000 [00:03<00:00, 2867.10it/s] 89%|████████▉ | 8905/10000 [00:03<00:00, 2866.75it/s] 92%|█████████▏| 9192/10000 [00:03<00:00, 2866.01it/s] 95%|█████████▍| 9479/10000 [00:03<00:00, 2867.05it/s] 98%|█████████▊| 9766/10000 [00:03<00:00, 2867.59it/s]100%|██████████| 10000/10000 [00:03<00:00, 2863.84it/s]
2022-05-22 07:24:21 - Using LF classes: [functools.partial(<class 'sklearn.tree._classes.DecisionTreeClassifier'>, max_depth=1), <class 'sklearn.linear_model._logistic.LogisticRegression'>]
Fitting MulticlassAdaptor... Class 0
  0%|          | 0/23 [00:00<?, ?it/s]  0%|          | 0/23 [2:58:01<?, ?it/s]
Traceback (most recent call last):
  File "fwrench/applications/fashion_mnist.py", line 213, in <module>
    fire.Fire(main)
  File "/home/ubuntu/anaconda3/envs/FWRENCH/lib/python3.7/site-packages/fire/core.py", line 141, in Fire
    component_trace = _Fire(component, args, parsed_flag_args, context, name)
  File "/home/ubuntu/anaconda3/envs/FWRENCH/lib/python3.7/site-packages/fire/core.py", line 471, in _Fire
    target=component.__name__)
  File "/home/ubuntu/anaconda3/envs/FWRENCH/lib/python3.7/site-packages/fire/core.py", line 681, in _CallAndUpdateTrace
    component = fn(*varargs, **kwargs)
  File "fwrench/applications/fashion_mnist.py", line 157, in main
    selector.fit(valid_data_embed, train_data_embed)
  File "/home/ubuntu/FWRENCH/fwrench/utils/utils.py", line 132, in fit
    self.lf_selectors[i].fit(labeled_data_i, unlabeled_data_i)
  File "/home/ubuntu/FWRENCH/fwrench/lf_selectors/snuba_lf_selector.py", line 57, in fit
    model=self.lf_generator, scoring_fn=self.scoring_fn)
  File "/home/ubuntu/FWRENCH/fwrench/lf_selectors/snuba/heuristic_generator.py", line 152, in run_synthesizer
    scoring_fn=scoring_fn)
  File "/home/ubuntu/FWRENCH/fwrench/lf_selectors/snuba/heuristic_generator.py", line 81, in prune_heuristics
    L_temp_train = self.apply_heuristics(heuristics[i], self.train_primitive_matrix, feat_combos[i], beta_opt_temp) 
  File "/home/ubuntu/FWRENCH/fwrench/lf_selectors/snuba/heuristic_generator.py", line 53, in apply_heuristics
    L = np.zeros((np.shape(primitive_matrix)[0],len(heuristics)))
numpy.core._exceptions.MemoryError: Unable to allocate 261. GiB for an array with shape (57000, 613872) and data type float64
