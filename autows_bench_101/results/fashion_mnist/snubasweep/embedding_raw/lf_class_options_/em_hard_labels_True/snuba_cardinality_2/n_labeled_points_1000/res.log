2022-05-22 10:24:46 - loading data from datasets/FashionMNIST_3000/train.json
  0%|          | 0/57000 [00:00<?, ?it/s]  0%|          | 283/57000 [00:00<00:20, 2821.67it/s]  1%|          | 566/57000 [00:00<00:19, 2822.86it/s]  1%|▏         | 850/57000 [00:00<00:19, 2828.50it/s]  2%|▏         | 1134/57000 [00:00<00:19, 2831.41it/s]  2%|▏         | 1419/57000 [00:00<00:19, 2834.21it/s]  3%|▎         | 1704/57000 [00:00<00:19, 2836.96it/s]  3%|▎         | 1988/57000 [00:00<00:19, 2829.91it/s]  4%|▍         | 2271/57000 [00:00<00:19, 2829.30it/s]  4%|▍         | 2556/57000 [00:00<00:19, 2834.65it/s]  5%|▍         | 2841/57000 [00:01<00:19, 2838.00it/s]  5%|▌         | 3125/57000 [00:01<00:18, 2836.81it/s]  6%|▌         | 3410/57000 [00:01<00:18, 2839.46it/s]  6%|▋         | 3695/57000 [00:01<00:18, 2840.17it/s]  7%|▋         | 3980/57000 [00:01<00:18, 2839.25it/s]  7%|▋         | 4265/57000 [00:01<00:18, 2841.19it/s]  8%|▊         | 4550/57000 [00:01<00:18, 2840.62it/s]  8%|▊         | 4835/57000 [00:01<00:18, 2839.76it/s]  9%|▉         | 5120/57000 [00:01<00:18, 2841.95it/s]  9%|▉         | 5405/57000 [00:01<00:18, 2840.23it/s] 10%|▉         | 5690/57000 [00:02<00:18, 2842.53it/s] 10%|█         | 5975/57000 [00:02<00:17, 2843.45it/s] 11%|█         | 6260/57000 [00:02<00:17, 2841.52it/s] 11%|█▏        | 6545/57000 [00:02<00:17, 2842.26it/s] 12%|█▏        | 6830/57000 [00:02<00:17, 2840.73it/s] 12%|█▏        | 7115/57000 [00:02<00:17, 2841.22it/s] 13%|█▎        | 7400/57000 [00:02<00:17, 2838.42it/s] 13%|█▎        | 7684/57000 [00:02<00:17, 2836.26it/s] 14%|█▍        | 7969/57000 [00:02<00:17, 2838.97it/s] 14%|█▍        | 8254/57000 [00:02<00:17, 2840.42it/s] 15%|█▍        | 8539/57000 [00:03<00:17, 2842.20it/s] 15%|█▌        | 8824/57000 [00:03<00:16, 2841.63it/s] 16%|█▌        | 9109/57000 [00:03<00:16, 2840.48it/s] 16%|█▋        | 9394/57000 [00:03<00:16, 2841.80it/s] 17%|█▋        | 9679/57000 [00:03<00:16, 2839.02it/s] 17%|█▋        | 9964/57000 [00:03<00:16, 2840.06it/s] 18%|█▊        | 10249/57000 [00:03<00:16, 2840.54it/s] 18%|█▊        | 10534/57000 [00:03<00:16, 2839.80it/s] 19%|█▉        | 10819/57000 [00:03<00:16, 2841.23it/s] 19%|█▉        | 11104/57000 [00:03<00:16, 2838.99it/s] 20%|█▉        | 11389/57000 [00:04<00:16, 2840.94it/s] 20%|██        | 11675/57000 [00:04<00:15, 2844.71it/s] 21%|██        | 11960/57000 [00:04<00:15, 2836.43it/s] 21%|██▏       | 12246/57000 [00:04<00:15, 2840.53it/s] 22%|██▏       | 12531/57000 [00:04<00:15, 2841.78it/s] 22%|██▏       | 12817/57000 [00:04<00:15, 2844.43it/s] 23%|██▎       | 13103/57000 [00:04<00:15, 2847.24it/s] 23%|██▎       | 13388/57000 [00:04<00:15, 2847.45it/s] 24%|██▍       | 13674/57000 [00:04<00:15, 2848.75it/s] 24%|██▍       | 13959/57000 [00:04<00:15, 2848.04it/s] 25%|██▍       | 14244/57000 [00:05<00:15, 2843.23it/s] 25%|██▌       | 14530/57000 [00:05<00:14, 2845.83it/s] 26%|██▌       | 14815/57000 [00:05<00:14, 2845.67it/s] 26%|██▋       | 15100/57000 [00:05<00:14, 2845.98it/s] 27%|██▋       | 15386/57000 [00:05<00:14, 2847.40it/s] 27%|██▋       | 15671/57000 [00:05<00:14, 2840.52it/s] 28%|██▊       | 15956/57000 [00:05<00:14, 2841.59it/s] 28%|██▊       | 16241/57000 [00:05<00:14, 2836.63it/s] 29%|██▉       | 16525/57000 [00:05<00:14, 2836.52it/s] 29%|██▉       | 16809/57000 [00:05<00:14, 2837.19it/s] 30%|██▉       | 17093/57000 [00:06<00:14, 2833.49it/s] 30%|███       | 17378/57000 [00:06<00:13, 2835.36it/s] 31%|███       | 17662/57000 [00:06<00:13, 2831.59it/s] 31%|███▏      | 17947/57000 [00:06<00:13, 2834.74it/s] 32%|███▏      | 18232/57000 [00:06<00:13, 2836.85it/s] 32%|███▏      | 18516/57000 [00:06<00:13, 2834.66it/s] 33%|███▎      | 18801/57000 [00:06<00:13, 2837.99it/s] 33%|███▎      | 19086/57000 [00:06<00:13, 2839.45it/s] 34%|███▍      | 19370/57000 [00:06<00:13, 2837.32it/s] 34%|███▍      | 19655/57000 [00:06<00:13, 2839.01it/s] 35%|███▍      | 19939/57000 [00:07<00:13, 2833.72it/s] 35%|███▌      | 20224/57000 [00:07<00:12, 2836.93it/s] 36%|███▌      | 20508/57000 [00:07<00:12, 2836.30it/s] 36%|███▋      | 20792/57000 [00:07<00:12, 2836.91it/s] 37%|███▋      | 21076/57000 [00:07<00:12, 2836.31it/s] 37%|███▋      | 21360/57000 [00:07<00:12, 2835.13it/s] 38%|███▊      | 21645/57000 [00:07<00:12, 2836.76it/s] 38%|███▊      | 21930/57000 [00:07<00:12, 2838.09it/s] 39%|███▉      | 22214/57000 [00:07<00:12, 2836.06it/s] 39%|███▉      | 22498/57000 [00:07<00:12, 2833.98it/s] 40%|███▉      | 22782/57000 [00:08<00:12, 2834.92it/s] 40%|████      | 23066/57000 [00:08<00:11, 2834.63it/s] 41%|████      | 23350/57000 [00:08<00:11, 2833.77it/s] 41%|████▏     | 23634/57000 [00:08<00:11, 2833.95it/s] 42%|████▏     | 23918/57000 [00:08<00:11, 2835.36it/s] 42%|████▏     | 24202/57000 [00:08<00:11, 2835.58it/s] 43%|████▎     | 24486/57000 [00:08<00:11, 2834.12it/s] 43%|████▎     | 24770/57000 [00:08<00:11, 2834.92it/s] 44%|████▍     | 25054/57000 [00:08<00:11, 2824.08it/s] 44%|████▍     | 25339/57000 [00:08<00:11, 2829.12it/s] 45%|████▍     | 25624/57000 [00:09<00:11, 2833.13it/s] 45%|████▌     | 25908/57000 [00:09<00:10, 2829.72it/s] 46%|████▌     | 26192/57000 [00:09<00:10, 2830.76it/s] 46%|████▋     | 26476/57000 [00:09<00:10, 2830.85it/s] 47%|████▋     | 26760/57000 [00:09<00:10, 2831.42it/s] 47%|████▋     | 27044/57000 [00:09<00:10, 2832.28it/s] 48%|████▊     | 27328/57000 [00:09<00:10, 2828.13it/s] 48%|████▊     | 27612/57000 [00:09<00:10, 2830.28it/s] 49%|████▉     | 27896/57000 [00:09<00:10, 2830.98it/s] 49%|████▉     | 28180/57000 [00:09<00:10, 2827.59it/s] 50%|████▉     | 28464/57000 [00:10<00:10, 2829.14it/s] 50%|█████     | 28747/57000 [00:10<00:09, 2827.21it/s] 51%|█████     | 29031/57000 [00:10<00:09, 2829.55it/s] 51%|█████▏    | 29315/57000 [00:10<00:09, 2831.82it/s] 52%|█████▏    | 29599/57000 [00:10<00:09, 2832.44it/s] 52%|█████▏    | 29883/57000 [00:10<00:09, 2834.43it/s] 53%|█████▎    | 30167/57000 [00:10<00:09, 2832.81it/s] 53%|█████▎    | 30452/57000 [00:10<00:09, 2835.24it/s] 54%|█████▍    | 30736/57000 [00:10<00:09, 2836.45it/s] 54%|█████▍    | 31020/57000 [00:10<00:09, 2832.16it/s] 55%|█████▍    | 31304/57000 [00:11<00:09, 2834.38it/s] 55%|█████▌    | 31588/57000 [00:11<00:08, 2835.64it/s] 56%|█████▌    | 31872/57000 [00:11<00:08, 2830.42it/s] 56%|█████▋    | 32157/57000 [00:11<00:08, 2834.75it/s] 57%|█████▋    | 32441/57000 [00:11<00:08, 2834.59it/s] 57%|█████▋    | 32725/57000 [00:11<00:08, 2835.37it/s] 58%|█████▊    | 33010/57000 [00:11<00:08, 2836.94it/s] 58%|█████▊    | 33294/57000 [00:11<00:08, 2829.88it/s] 59%|█████▉    | 33578/57000 [00:11<00:08, 2832.60it/s] 59%|█████▉    | 33862/57000 [00:11<00:08, 2829.91it/s] 60%|█████▉    | 34146/57000 [00:12<00:08, 2832.01it/s] 60%|██████    | 34430/57000 [00:12<00:07, 2833.61it/s] 61%|██████    | 34714/57000 [00:12<00:07, 2832.95it/s] 61%|██████▏   | 34998/57000 [00:12<00:07, 2834.79it/s] 62%|██████▏   | 35282/57000 [00:12<00:07, 2833.32it/s] 62%|██████▏   | 35567/57000 [00:12<00:07, 2836.02it/s] 63%|██████▎   | 35851/57000 [00:12<00:07, 2831.70it/s] 63%|██████▎   | 36136/57000 [00:12<00:07, 2834.96it/s] 64%|██████▍   | 36421/57000 [00:12<00:07, 2836.54it/s] 64%|██████▍   | 36705/57000 [00:12<00:07, 2832.82it/s] 65%|██████▍   | 36989/57000 [00:13<00:07, 2834.27it/s] 65%|██████▌   | 37274/57000 [00:13<00:06, 2835.60it/s] 66%|██████▌   | 37558/57000 [00:13<00:06, 2834.89it/s] 66%|██████▋   | 37842/57000 [00:13<00:06, 2835.49it/s] 67%|██████▋   | 38126/57000 [00:13<00:06, 2836.58it/s] 67%|██████▋   | 38410/57000 [00:13<00:06, 2832.97it/s] 68%|██████▊   | 38695/57000 [00:13<00:06, 2836.58it/s] 68%|██████▊   | 38979/57000 [00:13<00:06, 2835.20it/s] 69%|██████▉   | 39263/57000 [00:13<00:06, 2835.51it/s] 69%|██████▉   | 39547/57000 [00:13<00:06, 2835.50it/s] 70%|██████▉   | 39831/57000 [00:14<00:06, 2834.52it/s] 70%|███████   | 40116/57000 [00:14<00:05, 2836.23it/s] 71%|███████   | 40400/57000 [00:14<00:05, 2828.88it/s] 71%|███████▏  | 40685/57000 [00:14<00:05, 2832.47it/s] 72%|███████▏  | 40969/57000 [00:14<00:05, 2834.62it/s] 72%|███████▏  | 41253/57000 [00:14<00:05, 2833.37it/s] 73%|███████▎  | 41537/57000 [00:14<00:05, 2834.18it/s] 73%|███████▎  | 41822/57000 [00:14<00:05, 2836.98it/s] 74%|███████▍  | 42106/57000 [00:14<00:05, 2835.16it/s] 74%|███████▍  | 42390/57000 [00:14<00:05, 2834.24it/s] 75%|███████▍  | 42674/57000 [00:15<00:05, 2832.97it/s] 75%|███████▌  | 42958/57000 [00:15<00:04, 2832.77it/s] 76%|███████▌  | 43242/57000 [00:15<00:04, 2832.13it/s] 76%|███████▋  | 43526/57000 [00:15<00:04, 2833.03it/s] 77%|███████▋  | 43811/57000 [00:15<00:04, 2835.62it/s] 77%|███████▋  | 44095/57000 [00:15<00:04, 2832.72it/s] 78%|███████▊  | 44380/57000 [00:15<00:04, 2835.38it/s] 78%|███████▊  | 44665/57000 [00:15<00:04, 2837.23it/s] 79%|███████▉  | 44949/57000 [00:15<00:04, 2834.80it/s] 79%|███████▉  | 45233/57000 [00:15<00:04, 2828.28it/s] 80%|███████▉  | 45517/57000 [00:16<00:04, 2828.85it/s] 80%|████████  | 45802/57000 [00:16<00:03, 2833.40it/s] 81%|████████  | 46087/57000 [00:16<00:03, 2836.03it/s] 81%|████████▏ | 46371/57000 [00:16<00:03, 2833.25it/s] 82%|████████▏ | 46655/57000 [00:16<00:03, 2834.20it/s] 82%|████████▏ | 46940/57000 [00:16<00:03, 2836.76it/s] 83%|████████▎ | 47224/57000 [00:16<00:03, 2836.57it/s] 83%|████████▎ | 47508/57000 [00:16<00:03, 2836.24it/s] 84%|████████▍ | 47792/57000 [00:16<00:03, 2835.43it/s] 84%|████████▍ | 48077/57000 [00:16<00:03, 2837.68it/s] 85%|████████▍ | 48361/57000 [00:17<00:03, 2836.41it/s] 85%|████████▌ | 48645/57000 [00:17<00:02, 2832.64it/s] 86%|████████▌ | 48930/57000 [00:17<00:02, 2834.85it/s] 86%|████████▋ | 49214/57000 [00:17<00:02, 2835.58it/s] 87%|████████▋ | 49499/57000 [00:17<00:02, 2837.07it/s] 87%|████████▋ | 49783/57000 [00:17<00:02, 2836.81it/s] 88%|████████▊ | 50067/57000 [00:17<00:02, 2833.52it/s] 88%|████████▊ | 50352/57000 [00:17<00:02, 2835.58it/s] 89%|████████▉ | 50636/57000 [00:17<00:02, 2832.98it/s] 89%|████████▉ | 50920/57000 [00:17<00:02, 2823.12it/s] 90%|████████▉ | 51205/57000 [00:18<00:02, 2828.02it/s] 90%|█████████ | 51490/57000 [00:18<00:01, 2831.76it/s] 91%|█████████ | 51775/57000 [00:18<00:01, 2836.09it/s] 91%|█████████▏| 52060/57000 [00:18<00:01, 2838.88it/s] 92%|█████████▏| 52344/57000 [00:18<00:01, 2832.99it/s] 92%|█████████▏| 52629/57000 [00:18<00:01, 2835.69it/s] 93%|█████████▎| 52913/57000 [00:18<00:01, 2832.83it/s] 93%|█████████▎| 53197/57000 [00:18<00:01, 2832.53it/s] 94%|█████████▍| 53481/57000 [00:18<00:01, 2834.36it/s] 94%|█████████▍| 53765/57000 [00:18<00:01, 2832.67it/s] 95%|█████████▍| 54049/57000 [00:19<00:01, 2833.00it/s] 95%|█████████▌| 54333/57000 [00:19<00:00, 2830.06it/s] 96%|█████████▌| 54617/57000 [00:19<00:00, 2832.00it/s] 96%|█████████▋| 54902/57000 [00:19<00:00, 2834.86it/s] 97%|█████████▋| 55186/57000 [00:19<00:00, 2835.30it/s] 97%|█████████▋| 55471/57000 [00:19<00:00, 2838.53it/s] 98%|█████████▊| 55755/57000 [00:19<00:00, 2838.52it/s] 98%|█████████▊| 56039/57000 [00:19<00:00, 2837.40it/s] 99%|█████████▉| 56323/57000 [00:19<00:00, 2838.11it/s] 99%|█████████▉| 56607/57000 [00:19<00:00, 2834.64it/s]100%|█████████▉| 56891/57000 [00:20<00:00, 2835.42it/s]100%|██████████| 57000/57000 [00:20<00:00, 2835.65it/s]
2022-05-22 10:25:07 - loading data from datasets/FashionMNIST_3000/valid.json
  0%|          | 0/3000 [00:00<?, ?it/s]  9%|▉         | 283/3000 [00:00<00:00, 2826.17it/s] 19%|█▉        | 567/3000 [00:00<00:00, 2832.35it/s] 28%|██▊       | 852/3000 [00:00<00:00, 2837.58it/s] 38%|███▊      | 1136/3000 [00:00<00:00, 2835.61it/s] 47%|████▋     | 1420/3000 [00:00<00:00, 2835.33it/s] 57%|█████▋    | 1704/3000 [00:00<00:00, 2833.87it/s] 66%|██████▋   | 1988/3000 [00:00<00:00, 2833.07it/s] 76%|███████▌  | 2272/3000 [00:00<00:00, 2833.22it/s] 85%|████████▌ | 2556/3000 [00:00<00:00, 2831.93it/s] 95%|█████████▍| 2840/3000 [00:01<00:00, 2829.98it/s]100%|██████████| 3000/3000 [00:01<00:00, 2831.50it/s]
2022-05-22 10:25:08 - loading data from datasets/FashionMNIST_3000/test.json
  0%|          | 0/10000 [00:00<?, ?it/s]  3%|▎         | 283/10000 [00:00<00:03, 2821.82it/s]  6%|▌         | 566/10000 [00:00<00:03, 2826.22it/s]  8%|▊         | 850/10000 [00:00<00:03, 2832.25it/s] 11%|█▏        | 1134/10000 [00:00<00:03, 2833.87it/s] 14%|█▍        | 1418/10000 [00:00<00:03, 2836.00it/s] 17%|█▋        | 1702/10000 [00:00<00:02, 2836.40it/s] 20%|█▉        | 1986/10000 [00:00<00:02, 2834.71it/s] 23%|██▎       | 2270/10000 [00:00<00:02, 2833.95it/s] 26%|██▌       | 2554/10000 [00:00<00:02, 2832.33it/s] 28%|██▊       | 2838/10000 [00:01<00:02, 2829.45it/s] 31%|███       | 3121/10000 [00:01<00:02, 2826.88it/s] 34%|███▍      | 3405/10000 [00:01<00:02, 2828.67it/s] 37%|███▋      | 3688/10000 [00:01<00:02, 2826.02it/s] 40%|███▉      | 3971/10000 [00:01<00:02, 2826.15it/s] 43%|████▎     | 4254/10000 [00:01<00:02, 2825.69it/s] 45%|████▌     | 4537/10000 [00:01<00:01, 2825.67it/s] 48%|████▊     | 4820/10000 [00:01<00:01, 2826.02it/s] 51%|█████     | 5103/10000 [00:01<00:01, 2826.53it/s] 54%|█████▍    | 5386/10000 [00:01<00:01, 2822.91it/s] 57%|█████▋    | 5669/10000 [00:02<00:01, 2822.13it/s] 60%|█████▉    | 5952/10000 [00:02<00:01, 2823.14it/s] 62%|██████▏   | 6235/10000 [00:02<00:01, 2821.45it/s] 65%|██████▌   | 6518/10000 [00:02<00:01, 2823.06it/s] 68%|██████▊   | 6801/10000 [00:02<00:01, 2823.56it/s] 71%|███████   | 7084/10000 [00:02<00:01, 2823.17it/s] 74%|███████▎  | 7367/10000 [00:02<00:00, 2824.19it/s] 76%|███████▋  | 7650/10000 [00:02<00:00, 2825.50it/s] 79%|███████▉  | 7933/10000 [00:02<00:00, 2825.51it/s] 82%|████████▏ | 8216/10000 [00:02<00:00, 2826.58it/s] 85%|████████▍ | 8499/10000 [00:03<00:00, 2827.25it/s] 88%|████████▊ | 8782/10000 [00:03<00:00, 2824.94it/s] 91%|█████████ | 9065/10000 [00:03<00:00, 2825.94it/s] 93%|█████████▎| 9349/10000 [00:03<00:00, 2827.65it/s] 96%|█████████▋| 9632/10000 [00:03<00:00, 2828.25it/s] 99%|█████████▉| 9915/10000 [00:03<00:00, 2828.13it/s]100%|██████████| 10000/10000 [00:03<00:00, 2826.99it/s]
2022-05-22 10:25:17 - Using LF classes: [functools.partial(<class 'sklearn.tree._classes.DecisionTreeClassifier'>, max_depth=1), <class 'sklearn.linear_model._logistic.LogisticRegression'>]
Fitting MulticlassAdaptor... Class 0
  0%|          | 0/23 [00:00<?, ?it/s]  0%|          | 0/23 [3:17:11<?, ?it/s]
Traceback (most recent call last):
  File "fwrench/applications/fashion_mnist.py", line 213, in <module>
    fire.Fire(main)
  File "/home/ubuntu/anaconda3/envs/FWRENCH/lib/python3.7/site-packages/fire/core.py", line 141, in Fire
    component_trace = _Fire(component, args, parsed_flag_args, context, name)
  File "/home/ubuntu/anaconda3/envs/FWRENCH/lib/python3.7/site-packages/fire/core.py", line 471, in _Fire
    target=component.__name__)
  File "/home/ubuntu/anaconda3/envs/FWRENCH/lib/python3.7/site-packages/fire/core.py", line 681, in _CallAndUpdateTrace
    component = fn(*varargs, **kwargs)
  File "fwrench/applications/fashion_mnist.py", line 157, in main
    selector.fit(valid_data_embed, train_data_embed)
  File "/home/ubuntu/FWRENCH/fwrench/utils/utils.py", line 132, in fit
    self.lf_selectors[i].fit(labeled_data_i, unlabeled_data_i)
  File "/home/ubuntu/FWRENCH/fwrench/lf_selectors/snuba_lf_selector.py", line 57, in fit
    model=self.lf_generator, scoring_fn=self.scoring_fn)
  File "/home/ubuntu/FWRENCH/fwrench/lf_selectors/snuba/heuristic_generator.py", line 152, in run_synthesizer
    scoring_fn=scoring_fn)
  File "/home/ubuntu/FWRENCH/fwrench/lf_selectors/snuba/heuristic_generator.py", line 81, in prune_heuristics
    L_temp_train = self.apply_heuristics(heuristics[i], self.train_primitive_matrix, feat_combos[i], beta_opt_temp) 
  File "/home/ubuntu/FWRENCH/fwrench/lf_selectors/snuba/heuristic_generator.py", line 53, in apply_heuristics
    L = np.zeros((np.shape(primitive_matrix)[0],len(heuristics)))
numpy.core._exceptions.MemoryError: Unable to allocate 261. GiB for an array with shape (57000, 613872) and data type float64
