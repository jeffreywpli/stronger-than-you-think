2022-05-22 15:52:59 - loading data from datasets/FashionMNIST_3000/train.json
  0%|          | 0/57000 [00:00<?, ?it/s]  1%|          | 291/57000 [00:00<00:19, 2905.40it/s]  1%|          | 583/57000 [00:00<00:19, 2908.45it/s]  2%|▏         | 876/57000 [00:00<00:19, 2916.12it/s]  2%|▏         | 1168/57000 [00:00<00:19, 2915.43it/s]  3%|▎         | 1462/57000 [00:00<00:19, 2921.34it/s]  3%|▎         | 1755/57000 [00:00<00:18, 2920.20it/s]  4%|▎         | 2049/57000 [00:00<00:18, 2923.32it/s]  4%|▍         | 2342/57000 [00:00<00:18, 2920.01it/s]  5%|▍         | 2635/57000 [00:00<00:18, 2920.07it/s]  5%|▌         | 2928/57000 [00:01<00:18, 2921.43it/s]  6%|▌         | 3221/57000 [00:01<00:18, 2918.61it/s]  6%|▌         | 3514/57000 [00:01<00:18, 2921.36it/s]  7%|▋         | 3807/57000 [00:01<00:18, 2918.84it/s]  7%|▋         | 4101/57000 [00:01<00:18, 2922.61it/s]  8%|▊         | 4394/57000 [00:01<00:18, 2920.31it/s]  8%|▊         | 4687/57000 [00:01<00:17, 2921.05it/s]  9%|▊         | 4980/57000 [00:01<00:17, 2921.42it/s]  9%|▉         | 5273/57000 [00:01<00:17, 2919.25it/s] 10%|▉         | 5566/57000 [00:01<00:17, 2921.10it/s] 10%|█         | 5859/57000 [00:02<00:17, 2922.29it/s] 11%|█         | 6152/57000 [00:02<00:17, 2923.18it/s] 11%|█▏        | 6445/57000 [00:02<00:17, 2924.85it/s] 12%|█▏        | 6738/57000 [00:02<00:17, 2924.32it/s] 12%|█▏        | 7031/57000 [00:02<00:17, 2921.98it/s] 13%|█▎        | 7324/57000 [00:02<00:16, 2923.66it/s] 13%|█▎        | 7617/57000 [00:02<00:16, 2917.99it/s] 14%|█▍        | 7910/57000 [00:02<00:16, 2919.70it/s] 14%|█▍        | 8202/57000 [00:02<00:16, 2919.33it/s] 15%|█▍        | 8495/57000 [00:02<00:16, 2920.91it/s] 15%|█▌        | 8788/57000 [00:03<00:16, 2922.07it/s] 16%|█▌        | 9081/57000 [00:03<00:16, 2922.47it/s] 16%|█▋        | 9375/57000 [00:03<00:16, 2926.26it/s] 17%|█▋        | 9668/57000 [00:03<00:16, 2922.96it/s] 17%|█▋        | 9961/57000 [00:03<00:16, 2924.51it/s] 18%|█▊        | 10255/57000 [00:03<00:15, 2926.19it/s] 19%|█▊        | 10548/57000 [00:03<00:15, 2926.60it/s] 19%|█▉        | 10842/57000 [00:03<00:15, 2928.32it/s] 20%|█▉        | 11135/57000 [00:03<00:15, 2922.78it/s] 20%|██        | 11429/57000 [00:03<00:15, 2926.74it/s] 21%|██        | 11722/57000 [00:04<00:15, 2927.62it/s] 21%|██        | 12015/57000 [00:04<00:15, 2923.88it/s] 22%|██▏       | 12309/57000 [00:04<00:15, 2925.93it/s] 22%|██▏       | 12602/57000 [00:04<00:15, 2926.83it/s] 23%|██▎       | 12896/57000 [00:04<00:15, 2929.68it/s] 23%|██▎       | 13190/57000 [00:04<00:14, 2931.88it/s] 24%|██▎       | 13484/57000 [00:04<00:14, 2931.84it/s] 24%|██▍       | 13778/57000 [00:04<00:14, 2933.15it/s] 25%|██▍       | 14072/57000 [00:04<00:14, 2929.06it/s] 25%|██▌       | 14365/57000 [00:04<00:14, 2927.62it/s] 26%|██▌       | 14659/57000 [00:05<00:14, 2928.49it/s] 26%|██▌       | 14952/57000 [00:05<00:14, 2926.77it/s] 27%|██▋       | 15246/57000 [00:05<00:14, 2927.97it/s] 27%|██▋       | 15539/57000 [00:05<00:14, 2923.50it/s] 28%|██▊       | 15832/57000 [00:05<00:14, 2922.68it/s] 28%|██▊       | 16125/57000 [00:05<00:13, 2921.52it/s] 29%|██▉       | 16418/57000 [00:05<00:13, 2918.41it/s] 29%|██▉       | 16710/57000 [00:05<00:13, 2917.80it/s] 30%|██▉       | 17002/57000 [00:05<00:13, 2912.55it/s] 30%|███       | 17294/57000 [00:05<00:13, 2913.97it/s] 31%|███       | 17586/57000 [00:06<00:13, 2909.02it/s] 31%|███▏      | 17879/57000 [00:06<00:13, 2912.95it/s] 32%|███▏      | 18172/57000 [00:06<00:13, 2915.49it/s] 32%|███▏      | 18464/57000 [00:06<00:13, 2914.57it/s] 33%|███▎      | 18756/57000 [00:06<00:13, 2916.05it/s] 33%|███▎      | 19048/57000 [00:06<00:13, 2915.11it/s] 34%|███▍      | 19340/57000 [00:06<00:12, 2914.28it/s] 34%|███▍      | 19632/57000 [00:06<00:12, 2914.29it/s] 35%|███▍      | 19924/57000 [00:06<00:12, 2908.32it/s] 35%|███▌      | 20217/57000 [00:06<00:12, 2912.72it/s] 36%|███▌      | 20509/57000 [00:07<00:12, 2912.60it/s] 36%|███▋      | 20801/57000 [00:07<00:12, 2911.45it/s] 37%|███▋      | 21093/57000 [00:07<00:12, 2912.57it/s] 38%|███▊      | 21385/57000 [00:07<00:12, 2911.54it/s] 38%|███▊      | 21677/57000 [00:07<00:12, 2912.08it/s] 39%|███▊      | 21969/57000 [00:07<00:12, 2913.72it/s] 39%|███▉      | 22261/57000 [00:07<00:11, 2909.86it/s] 40%|███▉      | 22554/57000 [00:07<00:11, 2915.00it/s] 40%|████      | 22846/57000 [00:07<00:11, 2915.28it/s] 41%|████      | 23138/57000 [00:07<00:11, 2916.54it/s] 41%|████      | 23430/57000 [00:08<00:11, 2916.05it/s] 42%|████▏     | 23722/57000 [00:08<00:11, 2915.64it/s] 42%|████▏     | 24015/57000 [00:08<00:11, 2916.94it/s] 43%|████▎     | 24307/57000 [00:08<00:11, 2914.51it/s] 43%|████▎     | 24599/57000 [00:08<00:11, 2916.02it/s] 44%|████▎     | 24891/57000 [00:08<00:11, 2915.82it/s] 44%|████▍     | 25183/57000 [00:08<00:10, 2908.72it/s] 45%|████▍     | 25476/57000 [00:08<00:10, 2913.69it/s] 45%|████▌     | 25768/57000 [00:08<00:10, 2914.33it/s] 46%|████▌     | 26060/57000 [00:08<00:10, 2915.38it/s] 46%|████▌     | 26352/57000 [00:09<00:10, 2915.31it/s] 47%|████▋     | 26644/57000 [00:09<00:10, 2915.92it/s] 47%|████▋     | 26936/57000 [00:09<00:10, 2916.48it/s] 48%|████▊     | 27228/57000 [00:09<00:10, 2912.84it/s] 48%|████▊     | 27520/57000 [00:09<00:10, 2914.64it/s] 49%|████▉     | 27813/57000 [00:09<00:10, 2916.96it/s] 49%|████▉     | 28105/57000 [00:09<00:09, 2916.84it/s] 50%|████▉     | 28397/57000 [00:09<00:09, 2915.17it/s] 50%|█████     | 28690/57000 [00:09<00:09, 2917.60it/s] 51%|█████     | 28983/57000 [00:09<00:09, 2920.33it/s] 51%|█████▏    | 29276/57000 [00:10<00:09, 2916.28it/s] 52%|█████▏    | 29568/57000 [00:10<00:09, 2914.18it/s] 52%|█████▏    | 29860/57000 [00:10<00:09, 2915.83it/s] 53%|█████▎    | 30152/57000 [00:10<00:09, 2913.31it/s] 53%|█████▎    | 30444/57000 [00:10<00:09, 2914.91it/s] 54%|█████▍    | 30737/57000 [00:10<00:09, 2916.94it/s] 54%|█████▍    | 31029/57000 [00:10<00:08, 2914.98it/s] 55%|█████▍    | 31322/57000 [00:10<00:08, 2918.48it/s] 55%|█████▌    | 31615/57000 [00:10<00:08, 2919.24it/s] 56%|█████▌    | 31907/57000 [00:10<00:08, 2915.77it/s] 56%|█████▋    | 32200/57000 [00:11<00:08, 2919.22it/s] 57%|█████▋    | 32492/57000 [00:11<00:08, 2917.72it/s] 58%|█████▊    | 32785/57000 [00:11<00:08, 2919.37it/s] 58%|█████▊    | 33077/57000 [00:11<00:08, 2912.92it/s] 59%|█████▊    | 33369/57000 [00:11<00:08, 2913.05it/s] 59%|█████▉    | 33661/57000 [00:11<00:08, 2914.08it/s] 60%|█████▉    | 33953/57000 [00:11<00:07, 2914.93it/s] 60%|██████    | 34245/57000 [00:11<00:07, 2915.77it/s] 61%|██████    | 34537/57000 [00:11<00:07, 2914.40it/s] 61%|██████    | 34829/57000 [00:11<00:07, 2915.19it/s] 62%|██████▏   | 35121/57000 [00:12<00:07, 2914.02it/s] 62%|██████▏   | 35413/57000 [00:12<00:07, 2911.07it/s] 63%|██████▎   | 35705/57000 [00:12<00:07, 2906.08it/s] 63%|██████▎   | 35998/57000 [00:12<00:07, 2910.24it/s] 64%|██████▎   | 36291/57000 [00:12<00:07, 2915.63it/s] 64%|██████▍   | 36584/57000 [00:12<00:06, 2919.88it/s] 65%|██████▍   | 36876/57000 [00:12<00:06, 2914.22it/s] 65%|██████▌   | 37168/57000 [00:12<00:06, 2915.82it/s] 66%|██████▌   | 37460/57000 [00:12<00:06, 2915.88it/s] 66%|██████▌   | 37753/57000 [00:12<00:06, 2917.93it/s] 67%|██████▋   | 38045/57000 [00:13<00:06, 2917.05it/s] 67%|██████▋   | 38337/57000 [00:13<00:06, 2911.59it/s] 68%|██████▊   | 38630/57000 [00:13<00:06, 2914.67it/s] 68%|██████▊   | 38922/57000 [00:13<00:06, 2913.09it/s] 69%|██████▉   | 39215/57000 [00:13<00:06, 2916.34it/s] 69%|██████▉   | 39507/57000 [00:13<00:05, 2916.28it/s] 70%|██████▉   | 39799/57000 [00:13<00:05, 2915.04it/s] 70%|███████   | 40092/57000 [00:13<00:05, 2916.64it/s] 71%|███████   | 40384/57000 [00:13<00:05, 2912.26it/s] 71%|███████▏  | 40677/57000 [00:13<00:05, 2917.09it/s] 72%|███████▏  | 40970/57000 [00:14<00:05, 2919.95it/s] 72%|███████▏  | 41262/57000 [00:14<00:05, 2918.77it/s] 73%|███████▎  | 41555/57000 [00:14<00:05, 2920.40it/s] 73%|███████▎  | 41848/57000 [00:14<00:05, 2918.16it/s] 74%|███████▍  | 42140/57000 [00:14<00:05, 2917.27it/s] 74%|███████▍  | 42432/57000 [00:14<00:04, 2917.95it/s] 75%|███████▍  | 42724/57000 [00:14<00:04, 2915.51it/s] 75%|███████▌  | 43016/57000 [00:14<00:04, 2916.04it/s] 76%|███████▌  | 43308/57000 [00:14<00:04, 2916.41it/s] 76%|███████▋  | 43600/57000 [00:14<00:04, 2915.18it/s] 77%|███████▋  | 43893/57000 [00:15<00:04, 2917.18it/s] 78%|███████▊  | 44185/57000 [00:15<00:04, 2913.08it/s] 78%|███████▊  | 44477/57000 [00:15<00:04, 2914.59it/s] 79%|███████▊  | 44769/57000 [00:15<00:04, 2915.15it/s] 79%|███████▉  | 45061/57000 [00:15<00:04, 2916.33it/s] 80%|███████▉  | 45353/57000 [00:15<00:03, 2913.68it/s] 80%|████████  | 45645/57000 [00:15<00:03, 2915.19it/s] 81%|████████  | 45939/57000 [00:15<00:03, 2920.05it/s] 81%|████████  | 46232/57000 [00:15<00:03, 2921.48it/s] 82%|████████▏ | 46525/57000 [00:15<00:03, 2919.40it/s] 82%|████████▏ | 46817/57000 [00:16<00:03, 2915.99it/s] 83%|████████▎ | 47109/57000 [00:16<00:03, 2913.90it/s] 83%|████████▎ | 47402/57000 [00:16<00:03, 2915.38it/s] 84%|████████▎ | 47695/57000 [00:16<00:03, 2918.18it/s] 84%|████████▍ | 47987/57000 [00:16<00:03, 2916.47it/s] 85%|████████▍ | 48279/57000 [00:16<00:02, 2917.18it/s] 85%|████████▌ | 48571/57000 [00:16<00:02, 2912.70it/s] 86%|████████▌ | 48863/57000 [00:16<00:02, 2914.42it/s] 86%|████████▌ | 49156/57000 [00:16<00:02, 2916.43it/s] 87%|████████▋ | 49448/57000 [00:16<00:02, 2913.45it/s] 87%|████████▋ | 49740/57000 [00:17<00:02, 2915.09it/s] 88%|████████▊ | 50032/57000 [00:17<00:02, 2910.61it/s] 88%|████████▊ | 50324/57000 [00:17<00:02, 2912.80it/s] 89%|████████▉ | 50616/57000 [00:17<00:02, 2914.24it/s] 89%|████████▉ | 50908/57000 [00:17<00:02, 2902.45it/s] 90%|████████▉ | 51202/57000 [00:17<00:01, 2911.41it/s] 90%|█████████ | 51495/57000 [00:17<00:01, 2914.90it/s] 91%|█████████ | 51789/57000 [00:17<00:01, 2919.65it/s] 91%|█████████▏| 52082/57000 [00:17<00:01, 2920.46it/s] 92%|█████████▏| 52375/57000 [00:17<00:01, 2916.08it/s] 92%|█████████▏| 52668/57000 [00:18<00:01, 2917.30it/s] 93%|█████████▎| 52960/57000 [00:18<00:01, 2915.36it/s] 93%|█████████▎| 53253/57000 [00:18<00:01, 2918.34it/s] 94%|█████████▍| 53546/57000 [00:18<00:01, 2919.16it/s] 94%|█████████▍| 53839/57000 [00:18<00:01, 2919.59it/s] 95%|█████████▍| 54132/57000 [00:18<00:00, 2919.91it/s] 95%|█████████▌| 54424/57000 [00:18<00:00, 2914.67it/s] 96%|█████████▌| 54716/57000 [00:18<00:00, 2915.98it/s] 97%|█████████▋| 55009/57000 [00:18<00:00, 2917.98it/s] 97%|█████████▋| 55301/57000 [00:18<00:00, 2915.33it/s] 98%|█████████▊| 55593/57000 [00:19<00:00, 2915.37it/s] 98%|█████████▊| 55885/57000 [00:19<00:00, 2914.26it/s] 99%|█████████▊| 56178/57000 [00:19<00:00, 2917.31it/s] 99%|█████████▉| 56470/57000 [00:19<00:00, 2917.52it/s]100%|█████████▉| 56762/57000 [00:19<00:00, 2914.93it/s]100%|██████████| 57000/57000 [00:19<00:00, 2917.48it/s]
2022-05-22 15:53:18 - loading data from datasets/FashionMNIST_3000/valid.json
  0%|          | 0/3000 [00:00<?, ?it/s] 10%|▉         | 292/3000 [00:00<00:00, 2914.90it/s] 20%|█▉        | 586/3000 [00:00<00:00, 2924.23it/s] 29%|██▉       | 879/3000 [00:00<00:00, 2924.24it/s] 39%|███▉      | 1172/3000 [00:00<00:00, 2922.72it/s] 49%|████▉     | 1465/3000 [00:00<00:00, 2922.99it/s] 59%|█████▊    | 1759/3000 [00:00<00:00, 2925.43it/s] 68%|██████▊   | 2052/3000 [00:00<00:00, 2926.84it/s] 78%|███████▊  | 2345/3000 [00:00<00:00, 2927.41it/s] 88%|████████▊ | 2638/3000 [00:00<00:00, 2903.71it/s] 98%|█████████▊| 2930/3000 [00:01<00:00, 2908.06it/s]100%|██████████| 3000/3000 [00:01<00:00, 2916.35it/s]
2022-05-22 15:53:19 - loading data from datasets/FashionMNIST_3000/test.json
  0%|          | 0/10000 [00:00<?, ?it/s]  3%|▎         | 291/10000 [00:00<00:03, 2907.61it/s]  6%|▌         | 584/10000 [00:00<00:03, 2915.94it/s]  9%|▉         | 877/10000 [00:00<00:03, 2921.26it/s] 12%|█▏        | 1170/10000 [00:00<00:03, 2912.79it/s] 15%|█▍        | 1463/10000 [00:00<00:02, 2917.90it/s] 18%|█▊        | 1756/10000 [00:00<00:02, 2918.92it/s] 20%|██        | 2048/10000 [00:00<00:02, 2918.07it/s] 23%|██▎       | 2340/10000 [00:00<00:02, 2915.81it/s] 26%|██▋       | 2632/10000 [00:00<00:02, 2916.15it/s] 29%|██▉       | 2924/10000 [00:01<00:02, 2915.27it/s] 32%|███▏      | 3216/10000 [00:01<00:02, 2915.24it/s] 35%|███▌      | 3508/10000 [00:01<00:02, 2913.79it/s] 38%|███▊      | 3800/10000 [00:01<00:02, 2913.99it/s] 41%|████      | 4092/10000 [00:01<00:02, 2912.79it/s] 44%|████▍     | 4384/10000 [00:01<00:01, 2914.35it/s] 47%|████▋     | 4677/10000 [00:01<00:01, 2916.41it/s] 50%|████▉     | 4969/10000 [00:01<00:01, 2915.92it/s] 53%|█████▎    | 5261/10000 [00:01<00:01, 2916.94it/s] 56%|█████▌    | 5553/10000 [00:01<00:01, 2915.72it/s] 58%|█████▊    | 5845/10000 [00:02<00:01, 2915.92it/s] 61%|██████▏   | 6137/10000 [00:02<00:01, 2916.57it/s] 64%|██████▍   | 6430/10000 [00:02<00:01, 2917.63it/s] 67%|██████▋   | 6723/10000 [00:02<00:01, 2918.39it/s] 70%|███████   | 7015/10000 [00:02<00:01, 2917.10it/s] 73%|███████▎  | 7307/10000 [00:02<00:00, 2917.47it/s] 76%|███████▌  | 7599/10000 [00:02<00:00, 2915.80it/s] 79%|███████▉  | 7891/10000 [00:02<00:00, 2916.55it/s] 82%|████████▏ | 8183/10000 [00:02<00:00, 2913.55it/s] 85%|████████▍ | 8475/10000 [00:02<00:00, 2912.24it/s] 88%|████████▊ | 8767/10000 [00:03<00:00, 2912.17it/s] 91%|█████████ | 9059/10000 [00:03<00:00, 2911.05it/s] 94%|█████████▎| 9351/10000 [00:03<00:00, 2913.63it/s] 96%|█████████▋| 9643/10000 [00:03<00:00, 2912.66it/s] 99%|█████████▉| 9935/10000 [00:03<00:00, 2913.82it/s]100%|██████████| 10000/10000 [00:03<00:00, 2915.01it/s]
2022-05-22 15:53:29 - Using LF classes: [functools.partial(<class 'sklearn.tree._classes.DecisionTreeClassifier'>, max_depth=1), <class 'sklearn.linear_model._logistic.LogisticRegression'>]
Fitting MulticlassAdaptor... Class 0
  0%|          | 0/23 [00:00<?, ?it/s]  0%|          | 0/23 [2:20:45<?, ?it/s]
Traceback (most recent call last):
  File "fwrench/applications/fashion_mnist.py", line 213, in <module>
    fire.Fire(main)
  File "/home/ubuntu/anaconda3/envs/FWRENCH/lib/python3.7/site-packages/fire/core.py", line 141, in Fire
    component_trace = _Fire(component, args, parsed_flag_args, context, name)
  File "/home/ubuntu/anaconda3/envs/FWRENCH/lib/python3.7/site-packages/fire/core.py", line 471, in _Fire
    target=component.__name__)
  File "/home/ubuntu/anaconda3/envs/FWRENCH/lib/python3.7/site-packages/fire/core.py", line 681, in _CallAndUpdateTrace
    component = fn(*varargs, **kwargs)
  File "fwrench/applications/fashion_mnist.py", line 157, in main
    selector.fit(valid_data_embed, train_data_embed)
  File "/home/ubuntu/FWRENCH/fwrench/utils/utils.py", line 132, in fit
    self.lf_selectors[i].fit(labeled_data_i, unlabeled_data_i)
  File "/home/ubuntu/FWRENCH/fwrench/lf_selectors/snuba_lf_selector.py", line 57, in fit
    model=self.lf_generator, scoring_fn=self.scoring_fn)
  File "/home/ubuntu/FWRENCH/fwrench/lf_selectors/snuba/heuristic_generator.py", line 152, in run_synthesizer
    scoring_fn=scoring_fn)
  File "/home/ubuntu/FWRENCH/fwrench/lf_selectors/snuba/heuristic_generator.py", line 81, in prune_heuristics
    L_temp_train = self.apply_heuristics(heuristics[i], self.train_primitive_matrix, feat_combos[i], beta_opt_temp) 
  File "/home/ubuntu/FWRENCH/fwrench/lf_selectors/snuba/heuristic_generator.py", line 53, in apply_heuristics
    L = np.zeros((np.shape(primitive_matrix)[0],len(heuristics)))
numpy.core._exceptions.MemoryError: Unable to allocate 261. GiB for an array with shape (57000, 613872) and data type float64
