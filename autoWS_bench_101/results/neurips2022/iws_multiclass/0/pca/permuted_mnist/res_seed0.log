/hdd2/kaylee/anaconda3/envs/AutoWS-Bench-101/lib/python3.7/site-packages/torchvision/datasets/mnist.py:498: UserWarning: The given NumPy array is not writeable, and PyTorch does not support non-writeable tensors. This means you can write to the underlying (supposedly non-writeable) NumPy array using the tensor. You may want to copy the array to protect its data or make it writeable before converting it to a tensor. This type of warning will be suppressed for the rest of this program. (Triggered internally at  /opt/conda/conda-bld/pytorch_1631630836880/work/torch/csrc/utils/tensor_numpy.cpp:180.)
  return torch.from_numpy(parsed.astype(m[2], copy=False)).view(*s)
2022-08-09 04:23:06 - loading data from datasets/MNIST_3000/train.json
  0%|          | 0/57000 [00:00<?, ?it/s]  1%|▏         | 725/57000 [00:00<00:07, 7245.26it/s]  3%|▎         | 1452/57000 [00:00<00:07, 7259.71it/s]  4%|▍         | 2183/57000 [00:00<00:07, 7281.51it/s]  5%|▌         | 2914/57000 [00:00<00:07, 7289.66it/s]  6%|▋         | 3647/57000 [00:00<00:07, 7301.17it/s]  8%|▊         | 4378/57000 [00:00<00:07, 7255.57it/s]  9%|▉         | 5104/57000 [00:00<00:07, 7200.44it/s] 10%|█         | 5837/57000 [00:00<00:07, 7238.77it/s] 12%|█▏        | 6570/57000 [00:00<00:06, 7264.66it/s] 13%|█▎        | 7297/57000 [00:01<00:06, 7227.38it/s] 14%|█▍        | 8030/57000 [00:01<00:06, 7255.61it/s] 15%|█▌        | 8756/57000 [00:01<00:06, 7254.94it/s] 17%|█▋        | 9486/57000 [00:01<00:06, 7266.83it/s] 18%|█▊        | 10223/57000 [00:01<00:06, 7297.19it/s] 19%|█▉        | 10953/57000 [00:01<00:06, 7264.84it/s] 21%|██        | 11691/57000 [00:01<00:06, 7296.61it/s] 22%|██▏       | 12421/57000 [00:01<00:06, 7247.73it/s] 23%|██▎       | 13148/57000 [00:01<00:06, 7251.77it/s] 24%|██▍       | 13879/57000 [00:01<00:05, 7267.29it/s] 26%|██▌       | 14606/57000 [00:02<00:05, 7264.32it/s] 27%|██▋       | 15338/57000 [00:02<00:05, 7279.51it/s] 28%|██▊       | 16066/57000 [00:02<00:05, 7250.35it/s] 29%|██▉       | 16792/57000 [00:02<00:05, 7229.60it/s] 31%|███       | 17533/57000 [00:02<00:05, 7283.04it/s] 32%|███▏      | 18274/57000 [00:02<00:05, 7318.66it/s] 33%|███▎      | 19006/57000 [00:02<00:05, 7293.57it/s] 35%|███▍      | 19736/57000 [00:02<00:05, 7192.51it/s] 36%|███▌      | 20468/57000 [00:02<00:05, 7228.37it/s] 37%|███▋      | 21204/57000 [00:02<00:04, 7265.56it/s] 38%|███▊      | 21938/57000 [00:03<00:04, 7287.26it/s] 40%|███▉      | 22670/57000 [00:03<00:04, 7295.86it/s] 41%|████      | 23407/57000 [00:03<00:04, 7317.83it/s] 42%|████▏     | 24145/57000 [00:03<00:04, 7336.00it/s] 44%|████▎     | 24879/57000 [00:03<00:04, 7322.82it/s] 45%|████▍     | 25612/57000 [00:03<00:04, 7260.34it/s] 46%|████▌     | 26339/57000 [00:03<00:04, 7252.48it/s] 47%|████▋     | 27065/57000 [00:03<00:04, 7201.46it/s] 49%|████▉     | 27793/57000 [00:03<00:04, 7224.01it/s] 50%|█████     | 28522/57000 [00:03<00:03, 7242.71it/s] 51%|█████▏    | 29247/57000 [00:04<00:03, 7223.60it/s] 53%|█████▎    | 29975/57000 [00:04<00:03, 7239.21it/s] 54%|█████▍    | 30702/57000 [00:04<00:03, 7247.04it/s] 55%|█████▌    | 31435/57000 [00:04<00:03, 7270.90it/s] 56%|█████▋    | 32163/57000 [00:04<00:03, 7199.43it/s] 58%|█████▊    | 32884/57000 [00:04<00:03, 7193.40it/s] 59%|█████▉    | 33604/57000 [00:04<00:03, 7177.32it/s] 60%|██████    | 34333/57000 [00:04<00:03, 7209.99it/s] 62%|██████▏   | 35061/57000 [00:04<00:03, 7230.13it/s] 63%|██████▎   | 35786/57000 [00:04<00:02, 7234.40it/s] 64%|██████▍   | 36520/57000 [00:05<00:02, 7263.67it/s] 65%|██████▌   | 37253/57000 [00:05<00:02, 7282.87it/s] 67%|██████▋   | 37982/57000 [00:05<00:02, 7277.86it/s] 68%|██████▊   | 38717/57000 [00:05<00:02, 7297.58it/s] 69%|██████▉   | 39447/57000 [00:05<00:02, 7203.97it/s] 70%|███████   | 40168/57000 [00:05<00:02, 7202.47it/s] 72%|███████▏  | 40904/57000 [00:05<00:02, 7248.94it/s] 73%|███████▎  | 41630/57000 [00:05<00:02, 7123.95it/s] 74%|███████▍  | 42366/57000 [00:05<00:02, 7191.78it/s] 76%|███████▌  | 43099/57000 [00:05<00:01, 7232.30it/s] 77%|███████▋  | 43828/57000 [00:06<00:01, 7247.79it/s] 78%|███████▊  | 44554/57000 [00:06<00:01, 7217.46it/s] 79%|███████▉  | 45290/57000 [00:06<00:01, 7259.72it/s] 81%|████████  | 46034/57000 [00:06<00:01, 7311.41it/s] 82%|████████▏ | 46800/57000 [00:06<00:01, 7415.18it/s] 83%|████████▎ | 47546/57000 [00:06<00:01, 7427.88it/s] 85%|████████▍ | 48314/57000 [00:06<00:01, 7501.05it/s] 86%|████████▌ | 49070/57000 [00:06<00:01, 7516.61it/s] 87%|████████▋ | 49822/57000 [00:06<00:00, 7491.10it/s] 89%|████████▊ | 50572/57000 [00:06<00:00, 7448.01it/s] 90%|█████████ | 51347/57000 [00:07<00:00, 7535.83it/s] 91%|█████████▏| 52101/57000 [00:07<00:00, 7366.27it/s] 93%|█████████▎| 52845/57000 [00:07<00:00, 7382.25it/s] 94%|█████████▍| 53607/57000 [00:07<00:00, 7449.08it/s] 95%|█████████▌| 54358/57000 [00:07<00:00, 7466.24it/s] 97%|█████████▋| 55106/57000 [00:07<00:00, 7451.69it/s] 98%|█████████▊| 55855/57000 [00:07<00:00, 7461.39it/s] 99%|█████████▉| 56602/57000 [00:07<00:00, 7408.81it/s]100%|██████████| 57000/57000 [00:07<00:00, 7293.46it/s]
2022-08-09 04:23:14 - loading data from datasets/MNIST_3000/valid.json
  0%|          | 0/3000 [00:00<?, ?it/s] 25%|██▍       | 737/3000 [00:00<00:00, 7364.83it/s] 49%|████▉     | 1474/3000 [00:00<00:00, 7163.62it/s] 75%|███████▍  | 2239/3000 [00:00<00:00, 7374.50it/s] 99%|█████████▉| 2977/3000 [00:00<00:00, 7296.25it/s]100%|██████████| 3000/3000 [00:00<00:00, 7294.47it/s]
2022-08-09 04:23:14 - loading data from datasets/MNIST_3000/test.json
  0%|          | 0/10000 [00:00<?, ?it/s]  7%|▋         | 748/10000 [00:00<00:01, 7475.91it/s] 15%|█▌        | 1518/10000 [00:00<00:01, 7607.22it/s] 23%|██▎       | 2279/10000 [00:00<00:01, 7590.28it/s] 31%|███       | 3060/10000 [00:00<00:00, 7673.20it/s] 38%|███▊      | 3828/10000 [00:00<00:00, 7638.98it/s] 46%|████▌     | 4595/10000 [00:00<00:00, 7648.61it/s] 54%|█████▎    | 5360/10000 [00:00<00:00, 7486.71it/s] 61%|██████    | 6110/10000 [00:00<00:00, 7477.57it/s] 69%|██████▉   | 6883/10000 [00:00<00:00, 7553.27it/s] 76%|███████▋  | 7639/10000 [00:01<00:00, 7525.53it/s] 84%|████████▍ | 8395/10000 [00:01<00:00, 7535.66it/s] 92%|█████████▏| 9163/10000 [00:01<00:00, 7576.57it/s] 99%|█████████▉| 9921/10000 [00:01<00:00, 7553.76it/s]100%|██████████| 10000/10000 [00:01<00:00, 7561.51it/s](67100, 784)
2022-08-09 04:23:24 - Using LF classes: [functools.partial(<class 'sklearn.tree._classes.DecisionTreeClassifier'>, max_depth=1), <class 'sklearn.linear_model._logistic.LogisticRegression'>]
|----------------------------------------------------------------------------------------------------|0.0% 0/20|█████-----------------------------------------------------------------------------------------------|5.0% 1/20|██████████------------------------------------------------------------------------------------------|10.0% 2/20|███████████████-------------------------------------------------------------------------------------|15.0% 3/20|----------------------------------------------------------------------------------------------------|0.0% 0/20|█████-----------------------------------------------------------------------------------------------|5.0% 1/20|██████████------------------------------------------------------------------------------------------|10.0% 2/20|███████████████-------------------------------------------------------------------------------------|15.0% 3/20|████████████████████--------------------------------------------------------------------------------|20.0% 4/20|█████████████████████████---------------------------------------------------------------------------|25.0% 5/20|██████████████████████████████----------------------------------------------------------------------|30.0% 6/20|███████████████████████████████████-----------------------------------------------------------------|35.0% 7/20|████████████████████████████████████████------------------------------------------------------------|40.0% 8/20|█████████████████████████████████████████████-------------------------------------------------------|45.0% 9/20|██████████████████████████████████████████████████--------------------------------------------------|50.0% 10/20|███████████████████████████████████████████████████████---------------------------------------------|55.0% 11/20|████████████████████████████████████████████████████████████----------------------------------------|60.0% 12/20|█████████████████████████████████████████████████████████████████-----------------------------------|65.0% 13/20|██████████████████████████████████████████████████████████████████████------------------------------|70.0% 14/20|███████████████████████████████████████████████████████████████████████████-------------------------|75.0% 15/20|████████████████████████████████████████████████████████████████████████████████--------------------|80.0% 16/20|█████████████████████████████████████████████████████████████████████████████████████---------------|85.0% 17/20|██████████████████████████████████████████████████████████████████████████████████████████----------|90.0% 18/20|███████████████████████████████████████████████████████████████████████████████████████████████-----|95.0% 19/20|████████████████████████████████████████████████████████████████████████████████████████████████████|100.0% 20/20

/hdd2/kaylee/AutoWS-Bench-101/fwrench/lf_selectors/interactive_multiclass/iws.py:152: SparseEfficiencyWarning: Comparing a sparse matrix with a nonzero scalar using != is inefficient, try using == instead.
  accuracy = evaluate_complex_multiclass(LFs, Ytrue, scoring_fn)
/hdd2/kaylee/AutoWS-Bench-101/fwrench/lf_selectors/interactive_multiclass/utils.py:635: RuntimeWarning: invalid value encountered in true_divide
  accuracy = (tp) / numvotes
  0%|          | 0/100 [00:00<?, ?epoch/s] 34%|███▍      | 34/100 [00:00<00:00, 335.68epoch/s] 80%|████████  | 80/100 [00:00<00:00, 404.47epoch/s]100%|██████████| 100/100 [00:00<00:00, 405.02epoch/s]
2022-08-09 04:24:47 - [0.         0.         0.         0.         0.00669892 0.00308261
 0.         0.         0.         0.99325969]
2022-08-09 04:24:47 - [train] accuracy: 0.1045, coverage: 0.8989
2022-08-09 04:24:47 - [0.         0.         0.         0.         0.         0.08333333
 0.         0.         0.         1.        ]
2022-08-09 04:24:47 - [valid] accuracy: 0.1687, coverage: 0.8300
2022-08-09 04:24:47 - [0.         0.         0.         0.         0.003125   0.00235571
 0.         0.         0.         0.99579832]
2022-08-09 04:24:47 - [test] accuracy: 0.1062, coverage: 0.8970
2022-08-09 04:24:47 - label model train acc:    0.10624303232998886
2022-08-09 04:24:47 - label model coverage:     0.897
0.10624303232998886
