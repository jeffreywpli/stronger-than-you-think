2022-08-09 04:42:31 - loading data from datasets/yelp/train.json
  0%|          | 0/30400 [00:00<?, ?it/s]100%|██████████| 30400/30400 [00:00<00:00, 2114541.32it/s]
2022-08-09 04:42:31 - loading data from datasets/yelp/valid.json
  0%|          | 0/3800 [00:00<?, ?it/s]100%|██████████| 3800/3800 [00:00<00:00, 2109084.98it/s]
2022-08-09 04:42:31 - loading data from datasets/yelp/test.json
  0%|          | 0/3800 [00:00<?, ?it/s]100%|██████████| 3800/3800 [00:00<00:00, 2065891.80it/s]2022-08-09 04:42:31 - loading features from datasets/yelp/train_bert.pkl
2022-08-09 04:42:31 - loading features from datasets/yelp/valid_bert.pkl
2022-08-09 04:42:31 - loading features from datasets/yelp/test_bert.pkl
(34300, 768)
2022-08-09 04:42:32 - Using LF classes: [functools.partial(<class 'sklearn.tree._classes.DecisionTreeClassifier'>, max_depth=1), <class 'sklearn.linear_model._logistic.LogisticRegression'>]
|----------------------------------------------------------------------------------------------------|0.0% 0/20|█████-----------------------------------------------------------------------------------------------|5.0% 1/20|██████████------------------------------------------------------------------------------------------|10.0% 2/20|███████████████-------------------------------------------------------------------------------------|15.0% 3/20|----------------------------------------------------------------------------------------------------|0.0% 0/20|█████-----------------------------------------------------------------------------------------------|5.0% 1/20|██████████------------------------------------------------------------------------------------------|10.0% 2/20|███████████████-------------------------------------------------------------------------------------|15.0% 3/20|████████████████████--------------------------------------------------------------------------------|20.0% 4/20|█████████████████████████---------------------------------------------------------------------------|25.0% 5/20|██████████████████████████████----------------------------------------------------------------------|30.0% 6/20|███████████████████████████████████-----------------------------------------------------------------|35.0% 7/20|████████████████████████████████████████------------------------------------------------------------|40.0% 8/20|█████████████████████████████████████████████-------------------------------------------------------|45.0% 9/20|██████████████████████████████████████████████████--------------------------------------------------|50.0% 10/20|███████████████████████████████████████████████████████---------------------------------------------|55.0% 11/20|████████████████████████████████████████████████████████████----------------------------------------|60.0% 12/20|█████████████████████████████████████████████████████████████████-----------------------------------|65.0% 13/20|██████████████████████████████████████████████████████████████████████------------------------------|70.0% 14/20|███████████████████████████████████████████████████████████████████████████-------------------------|75.0% 15/20|████████████████████████████████████████████████████████████████████████████████--------------------|80.0% 16/20|█████████████████████████████████████████████████████████████████████████████████████---------------|85.0% 17/20|██████████████████████████████████████████████████████████████████████████████████████████----------|90.0% 18/20|███████████████████████████████████████████████████████████████████████████████████████████████-----|95.0% 19/20|████████████████████████████████████████████████████████████████████████████████████████████████████|100.0% 20/20

/hdd2/kaylee/AutoWS-Bench-101/fwrench/lf_selectors/interactive_multiclass/iws.py:152: SparseEfficiencyWarning: Comparing a sparse matrix with a nonzero scalar using != is inefficient, try using == instead.
  accuracy = evaluate_complex_multiclass(LFs, Ytrue, scoring_fn)
[98, 194, 107, 10]
  0%|          | 0/100 [00:00<?, ?epoch/s]100%|██████████| 100/100 [00:00<00:00, 3392.38epoch/s]
2022-08-09 04:43:44 - [0.01534844 0.98886606]
2022-08-09 04:43:44 - [train] accuracy: 0.4986, coverage: 1.0000
2022-08-09 04:43:44 - [0.02 1.  ]
2022-08-09 04:43:44 - [valid] accuracy: 0.5100, coverage: 1.0000
2022-08-09 04:43:44 - [0.01211454 0.99395161]
2022-08-09 04:43:44 - [test] accuracy: 0.5247, coverage: 1.0000
2022-08-09 04:43:44 - label model train acc:    0.5247368421052632
2022-08-09 04:43:44 - label model coverage:     1.0
0.5247368421052632
