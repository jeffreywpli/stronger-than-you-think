/hdd2/kaylee/anaconda3/envs/AutoWS-Bench-101/lib/python3.7/site-packages/torchvision/datasets/mnist.py:498: UserWarning: The given NumPy array is not writeable, and PyTorch does not support non-writeable tensors. This means you can write to the underlying (supposedly non-writeable) NumPy array using the tensor. You may want to copy the array to protect its data or make it writeable before converting it to a tensor. This type of warning will be suppressed for the rest of this program. (Triggered internally at  /opt/conda/conda-bld/pytorch_1631630836880/work/torch/csrc/utils/tensor_numpy.cpp:180.)
  return torch.from_numpy(parsed.astype(m[2], copy=False)).view(*s)
2022-08-09 04:59:32 - loading data from datasets/MNIST_3000/train.json
  0%|          | 0/57000 [00:00<?, ?it/s]  1%|▏         | 726/57000 [00:00<00:07, 7257.17it/s]  3%|▎         | 1455/57000 [00:00<00:07, 7272.02it/s]  4%|▍         | 2183/57000 [00:00<00:07, 7251.34it/s]  5%|▌         | 2909/57000 [00:00<00:07, 7042.52it/s]  6%|▋         | 3626/57000 [00:00<00:07, 7087.18it/s]  8%|▊         | 4341/57000 [00:00<00:07, 7107.55it/s]  9%|▉         | 5073/57000 [00:00<00:07, 7175.45it/s] 10%|█         | 5791/57000 [00:00<00:07, 7095.54it/s] 11%|█▏        | 6513/57000 [00:00<00:07, 7132.34it/s] 13%|█▎        | 7244/57000 [00:01<00:06, 7186.64it/s] 14%|█▍        | 7978/57000 [00:01<00:06, 7231.02it/s] 15%|█▌        | 8702/57000 [00:01<00:06, 7217.12it/s] 17%|█▋        | 9424/57000 [00:01<00:06, 7148.98it/s] 18%|█▊        | 10145/57000 [00:01<00:06, 7166.16it/s] 19%|█▉        | 10879/57000 [00:01<00:06, 7216.89it/s] 20%|██        | 11621/57000 [00:01<00:06, 7275.97it/s] 22%|██▏       | 12349/57000 [00:01<00:06, 7266.17it/s] 23%|██▎       | 13079/57000 [00:01<00:06, 7275.47it/s] 24%|██▍       | 13807/57000 [00:01<00:05, 7275.43it/s] 26%|██▌       | 14541/57000 [00:02<00:05, 7292.48it/s] 27%|██▋       | 15271/57000 [00:02<00:05, 7262.29it/s] 28%|██▊       | 16009/57000 [00:02<00:05, 7295.35it/s] 29%|██▉       | 16749/57000 [00:02<00:05, 7324.09it/s] 31%|███       | 17491/57000 [00:02<00:05, 7349.85it/s] 32%|███▏      | 18231/57000 [00:02<00:05, 7361.89it/s] 33%|███▎      | 18968/57000 [00:02<00:05, 7354.58it/s] 35%|███▍      | 19704/57000 [00:02<00:05, 7304.66it/s] 36%|███▌      | 20435/57000 [00:02<00:05, 7304.62it/s] 37%|███▋      | 21169/57000 [00:02<00:04, 7313.99it/s] 38%|███▊      | 21901/57000 [00:03<00:04, 7285.17it/s] 40%|███▉      | 22630/57000 [00:03<00:04, 7283.68it/s] 41%|████      | 23371/57000 [00:03<00:04, 7318.59it/s] 42%|████▏     | 24107/57000 [00:03<00:04, 7329.11it/s] 44%|████▎     | 24840/57000 [00:03<00:04, 7282.42it/s] 45%|████▍     | 25575/57000 [00:03<00:04, 7301.65it/s] 46%|████▌     | 26306/57000 [00:03<00:04, 7203.73it/s] 47%|████▋     | 27041/57000 [00:03<00:04, 7244.13it/s] 49%|████▊     | 27782/57000 [00:03<00:04, 7291.06it/s] 50%|█████     | 28519/57000 [00:03<00:03, 7311.67it/s] 51%|█████▏    | 29260/57000 [00:04<00:03, 7338.58it/s] 53%|█████▎    | 29995/57000 [00:04<00:03, 7341.11it/s] 54%|█████▍    | 30730/57000 [00:04<00:03, 7273.21it/s] 55%|█████▌    | 31471/57000 [00:04<00:03, 7312.76it/s] 56%|█████▋    | 32204/57000 [00:04<00:03, 7315.29it/s] 58%|█████▊    | 32945/57000 [00:04<00:03, 7342.04it/s] 59%|█████▉    | 33686/57000 [00:04<00:03, 7360.40it/s] 60%|██████    | 34427/57000 [00:04<00:03, 7373.64it/s] 62%|██████▏   | 35170/57000 [00:04<00:02, 7389.22it/s] 63%|██████▎   | 35909/57000 [00:04<00:02, 7382.20it/s] 64%|██████▍   | 36648/57000 [00:05<00:02, 7379.12it/s] 66%|██████▌   | 37386/57000 [00:05<00:02, 7369.96it/s] 67%|██████▋   | 38124/57000 [00:05<00:02, 7295.31it/s] 68%|██████▊   | 38854/57000 [00:05<00:02, 7290.38it/s] 69%|██████▉   | 39584/57000 [00:05<00:02, 7217.67it/s] 71%|███████   | 40323/57000 [00:05<00:02, 7268.16it/s] 72%|███████▏  | 41075/57000 [00:05<00:02, 7341.67it/s] 73%|███████▎  | 41810/57000 [00:05<00:02, 7310.28it/s] 75%|███████▍  | 42542/57000 [00:05<00:01, 7289.58it/s] 76%|███████▌  | 43277/57000 [00:05<00:01, 7304.65it/s] 77%|███████▋  | 44020/57000 [00:06<00:01, 7339.80it/s] 79%|███████▊  | 44761/57000 [00:06<00:01, 7360.54it/s] 80%|███████▉  | 45498/57000 [00:06<00:01, 7359.77it/s] 81%|████████  | 46240/57000 [00:06<00:01, 7375.89it/s] 82%|████████▏ | 46980/57000 [00:06<00:01, 7381.95it/s] 84%|████████▎ | 47719/57000 [00:06<00:01, 7284.46it/s] 85%|████████▌ | 48461/57000 [00:06<00:01, 7322.15it/s] 86%|████████▋ | 49199/57000 [00:06<00:01, 7336.91it/s] 88%|████████▊ | 49941/57000 [00:06<00:00, 7358.93it/s] 89%|████████▉ | 50681/57000 [00:06<00:00, 7369.51it/s] 90%|█████████ | 51419/57000 [00:07<00:00, 7349.92it/s] 92%|█████████▏| 52162/57000 [00:07<00:00, 7370.86it/s] 93%|█████████▎| 52901/57000 [00:07<00:00, 7373.76it/s] 94%|█████████▍| 53642/57000 [00:07<00:00, 7381.98it/s] 95%|█████████▌| 54385/57000 [00:07<00:00, 7394.02it/s] 97%|█████████▋| 55125/57000 [00:07<00:00, 7385.37it/s] 98%|█████████▊| 55867/57000 [00:07<00:00, 7393.25it/s] 99%|█████████▉| 56609/57000 [00:07<00:00, 7401.07it/s]100%|██████████| 57000/57000 [00:07<00:00, 7300.98it/s]
2022-08-09 04:59:40 - loading data from datasets/MNIST_3000/valid.json
  0%|          | 0/3000 [00:00<?, ?it/s] 25%|██▍       | 739/3000 [00:00<00:00, 7386.64it/s] 49%|████▉     | 1484/3000 [00:00<00:00, 7419.31it/s] 74%|███████▍  | 2226/3000 [00:00<00:00, 7400.89it/s] 99%|█████████▉| 2967/3000 [00:00<00:00, 7399.66it/s]100%|██████████| 3000/3000 [00:00<00:00, 7398.90it/s]
2022-08-09 04:59:40 - loading data from datasets/MNIST_3000/test.json
  0%|          | 0/10000 [00:00<?, ?it/s]  7%|▋         | 740/10000 [00:00<00:01, 7394.70it/s] 15%|█▍        | 1482/10000 [00:00<00:01, 7405.23it/s] 22%|██▏       | 2223/10000 [00:00<00:01, 7402.80it/s] 30%|██▉       | 2964/10000 [00:00<00:00, 7366.33it/s] 37%|███▋      | 3701/10000 [00:00<00:00, 7363.54it/s] 44%|████▍     | 4438/10000 [00:00<00:00, 7195.28it/s] 52%|█████▏    | 5159/10000 [00:00<00:00, 7154.58it/s] 59%|█████▉    | 5876/10000 [00:00<00:00, 7158.23it/s] 66%|██████▌   | 6607/10000 [00:00<00:00, 7202.67it/s] 73%|███████▎  | 7344/10000 [00:01<00:00, 7251.65it/s] 81%|████████  | 8086/10000 [00:01<00:00, 7300.19it/s] 88%|████████▊ | 8829/10000 [00:01<00:00, 7338.12it/s] 96%|█████████▌| 9578/10000 [00:01<00:00, 7381.06it/s]100%|██████████| 10000/10000 [00:01<00:00, 7295.11it/s]2022-08-09 04:59:48 - Using LF classes: [functools.partial(<class 'sklearn.tree._classes.DecisionTreeClassifier'>, max_depth=1), <class 'sklearn.linear_model._logistic.LogisticRegression'>]
|----------------------------------------------------------------------------------------------------|0.0% 0/20|█████-----------------------------------------------------------------------------------------------|5.0% 1/20|██████████------------------------------------------------------------------------------------------|10.0% 2/20|███████████████-------------------------------------------------------------------------------------|15.0% 3/20|----------------------------------------------------------------------------------------------------|0.0% 0/20|█████-----------------------------------------------------------------------------------------------|5.0% 1/20|██████████------------------------------------------------------------------------------------------|10.0% 2/20|███████████████-------------------------------------------------------------------------------------|15.0% 3/20|████████████████████--------------------------------------------------------------------------------|20.0% 4/20|█████████████████████████---------------------------------------------------------------------------|25.0% 5/20|██████████████████████████████----------------------------------------------------------------------|30.0% 6/20|███████████████████████████████████-----------------------------------------------------------------|35.0% 7/20|████████████████████████████████████████------------------------------------------------------------|40.0% 8/20|█████████████████████████████████████████████-------------------------------------------------------|45.0% 9/20|██████████████████████████████████████████████████--------------------------------------------------|50.0% 10/20|███████████████████████████████████████████████████████---------------------------------------------|55.0% 11/20|████████████████████████████████████████████████████████████----------------------------------------|60.0% 12/20|█████████████████████████████████████████████████████████████████-----------------------------------|65.0% 13/20|██████████████████████████████████████████████████████████████████████------------------------------|70.0% 14/20|███████████████████████████████████████████████████████████████████████████-------------------------|75.0% 15/20|████████████████████████████████████████████████████████████████████████████████--------------------|80.0% 16/20|█████████████████████████████████████████████████████████████████████████████████████---------------|85.0% 17/20|██████████████████████████████████████████████████████████████████████████████████████████----------|90.0% 18/20|███████████████████████████████████████████████████████████████████████████████████████████████-----|95.0% 19/20|████████████████████████████████████████████████████████████████████████████████████████████████████|100.0% 20/20

/hdd2/kaylee/AutoWS-Bench-101/fwrench/lf_selectors/interactive_multiclass/iws.py:152: SparseEfficiencyWarning: Comparing a sparse matrix with a nonzero scalar using != is inefficient, try using == instead.
  accuracy = evaluate_complex_multiclass(LFs, Ytrue, scoring_fn)
/hdd2/kaylee/AutoWS-Bench-101/fwrench/lf_selectors/interactive_multiclass/utils.py:635: RuntimeWarning: invalid value encountered in true_divide
  accuracy = (tp) / numvotes
[1552, 82, 186, 93, 59, 109, 727, 86, 662, 478, 107, 481, 876, 311, 92, 499, 484, 491, 751, 368, 327, 489, 503, 718, 726, 890, 106, 263, 334, 648, 736, 492, 655, 320, 270, 703, 89, 485, 256, 172, 564, 753, 321, 621, 530, 739, 873, 557, 718]
  0%|          | 0/100 [00:00<?, ?epoch/s] 13%|█▎        | 13/100 [00:00<00:00, 127.80epoch/s] 35%|███▌      | 35/100 [00:00<00:00, 176.72epoch/s] 57%|█████▋    | 57/100 [00:00<00:00, 195.52epoch/s] 79%|███████▉  | 79/100 [00:00<00:00, 202.99epoch/s]100%|██████████| 100/100 [00:00<00:00, 206.26epoch/s]
2022-08-09 05:01:50 - [0.01340996 0.         0.         0.14978054 0.51916111 0.66597896
 0.         0.27182979 0.         0.4811823 ]
2022-08-09 05:01:50 - [train] accuracy: 0.2182, coverage: 0.8890
2022-08-09 05:01:50 - [0.1        0.         0.         0.3        0.75       1.
 0.         0.5        0.         0.71428571]
2022-08-09 05:01:50 - [valid] accuracy: 0.4368, coverage: 0.8700
2022-08-09 05:01:50 - [0.01454139 0.         0.         0.13719185 0.52178533 0.66666667
 0.         0.26949654 0.         0.55797101]
2022-08-09 05:01:50 - [test] accuracy: 0.2255, coverage: 0.8930
2022-08-09 05:01:50 - label model train acc:    0.225531914893617
2022-08-09 05:01:50 - label model coverage:     0.893
0.225531914893617
