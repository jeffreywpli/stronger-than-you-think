2022-05-22 15:33:46 - loading data from datasets/KMNIST_3000/train.json
  0%|          | 0/57000 [00:00<?, ?it/s]  1%|          | 305/57000 [00:00<00:18, 3044.14it/s]  1%|          | 611/57000 [00:00<00:18, 3048.36it/s]  2%|▏         | 918/57000 [00:00<00:18, 3055.42it/s]  2%|▏         | 1225/57000 [00:00<00:18, 3058.66it/s]  3%|▎         | 1532/57000 [00:00<00:18, 3062.20it/s]  3%|▎         | 1839/57000 [00:00<00:18, 3059.09it/s]  4%|▍         | 2145/57000 [00:00<00:17, 3050.57it/s]  4%|▍         | 2451/57000 [00:00<00:17, 3044.95it/s]  5%|▍         | 2758/57000 [00:00<00:17, 3050.86it/s]  5%|▌         | 3064/57000 [00:01<00:17, 3051.68it/s]  6%|▌         | 3371/57000 [00:01<00:17, 3056.36it/s]  6%|▋         | 3678/57000 [00:01<00:17, 3057.74it/s]  7%|▋         | 3984/57000 [00:01<00:17, 3054.04it/s]  8%|▊         | 4291/57000 [00:01<00:17, 3058.68it/s]  8%|▊         | 4597/57000 [00:01<00:17, 3058.51it/s]  9%|▊         | 4903/57000 [00:01<00:17, 3055.50it/s]  9%|▉         | 5209/57000 [00:01<00:16, 3056.77it/s] 10%|▉         | 5516/57000 [00:01<00:16, 3057.76it/s] 10%|█         | 5823/57000 [00:01<00:16, 3059.65it/s] 11%|█         | 6129/57000 [00:02<00:16, 3053.52it/s] 11%|█▏        | 6436/57000 [00:02<00:16, 3057.47it/s] 12%|█▏        | 6743/57000 [00:02<00:16, 3059.34it/s] 12%|█▏        | 7050/57000 [00:02<00:16, 3060.90it/s] 13%|█▎        | 7357/57000 [00:02<00:16, 3060.97it/s] 13%|█▎        | 7664/57000 [00:02<00:16, 3054.72it/s] 14%|█▍        | 7970/57000 [00:02<00:16, 3051.98it/s] 15%|█▍        | 8276/57000 [00:02<00:15, 3053.40it/s] 15%|█▌        | 8583/57000 [00:02<00:15, 3056.67it/s] 16%|█▌        | 8890/57000 [00:02<00:15, 3058.46it/s] 16%|█▌        | 9197/57000 [00:03<00:15, 3060.45it/s] 17%|█▋        | 9504/57000 [00:03<00:15, 3060.27it/s] 17%|█▋        | 9811/57000 [00:03<00:15, 3055.97it/s] 18%|█▊        | 10118/57000 [00:03<00:15, 3058.53it/s] 18%|█▊        | 10424/57000 [00:03<00:15, 3052.26it/s] 19%|█▉        | 10730/57000 [00:03<00:15, 3052.95it/s] 19%|█▉        | 11036/57000 [00:03<00:15, 3052.81it/s] 20%|█▉        | 11343/57000 [00:03<00:14, 3057.18it/s] 20%|██        | 11650/57000 [00:03<00:14, 3059.47it/s] 21%|██        | 11956/57000 [00:03<00:14, 3053.12it/s] 22%|██▏       | 12263/57000 [00:04<00:14, 3055.48it/s] 22%|██▏       | 12569/57000 [00:04<00:14, 3054.97it/s] 23%|██▎       | 12876/57000 [00:04<00:14, 3057.57it/s] 23%|██▎       | 13183/57000 [00:04<00:14, 3059.37it/s] 24%|██▎       | 13489/57000 [00:04<00:14, 3053.29it/s] 24%|██▍       | 13795/57000 [00:04<00:14, 3054.97it/s] 25%|██▍       | 14101/57000 [00:04<00:14, 3051.92it/s] 25%|██▌       | 14408/57000 [00:04<00:13, 3055.41it/s] 26%|██▌       | 14714/57000 [00:04<00:13, 3056.36it/s] 26%|██▋       | 15020/57000 [00:04<00:13, 3054.55it/s] 27%|██▋       | 15327/57000 [00:05<00:13, 3057.73it/s] 27%|██▋       | 15633/57000 [00:05<00:13, 3054.53it/s] 28%|██▊       | 15940/57000 [00:05<00:13, 3057.69it/s] 29%|██▊       | 16246/57000 [00:05<00:13, 3053.40it/s] 29%|██▉       | 16553/57000 [00:05<00:13, 3056.78it/s] 30%|██▉       | 16859/57000 [00:05<00:13, 3056.77it/s] 30%|███       | 17165/57000 [00:05<00:13, 3055.05it/s] 31%|███       | 17472/57000 [00:05<00:12, 3058.46it/s] 31%|███       | 17778/57000 [00:05<00:12, 3058.66it/s] 32%|███▏      | 18085/57000 [00:05<00:12, 3061.14it/s] 32%|███▏      | 18392/57000 [00:06<00:12, 3062.96it/s] 33%|███▎      | 18699/57000 [00:06<00:12, 3061.35it/s] 33%|███▎      | 19006/57000 [00:06<00:12, 3060.07it/s] 34%|███▍      | 19313/57000 [00:06<00:12, 3056.00it/s] 34%|███▍      | 19619/57000 [00:06<00:12, 3055.88it/s] 35%|███▍      | 19925/57000 [00:06<00:12, 3049.58it/s] 35%|███▌      | 20232/57000 [00:06<00:12, 3053.51it/s] 36%|███▌      | 20539/57000 [00:06<00:11, 3056.43it/s] 37%|███▋      | 20845/57000 [00:06<00:11, 3054.12it/s] 37%|███▋      | 21151/57000 [00:06<00:11, 3055.74it/s] 38%|███▊      | 21457/57000 [00:07<00:11, 3052.24it/s] 38%|███▊      | 21764/57000 [00:07<00:11, 3055.24it/s] 39%|███▊      | 22070/57000 [00:07<00:11, 3053.14it/s] 39%|███▉      | 22376/57000 [00:07<00:11, 3045.21it/s] 40%|███▉      | 22681/57000 [00:07<00:11, 3045.61it/s] 40%|████      | 22986/57000 [00:07<00:11, 3035.13it/s] 41%|████      | 23292/57000 [00:07<00:11, 3041.02it/s] 41%|████▏     | 23597/57000 [00:07<00:10, 3039.73it/s] 42%|████▏     | 23903/57000 [00:07<00:10, 3044.76it/s] 42%|████▏     | 24210/57000 [00:07<00:10, 3050.36it/s] 43%|████▎     | 24516/57000 [00:08<00:10, 3050.90it/s] 44%|████▎     | 24822/57000 [00:08<00:10, 3052.87it/s] 44%|████▍     | 25128/57000 [00:08<00:10, 3043.47it/s] 45%|████▍     | 25433/57000 [00:08<00:10, 3044.32it/s] 45%|████▌     | 25738/57000 [00:08<00:10, 3045.79it/s] 46%|████▌     | 26044/57000 [00:08<00:10, 3049.43it/s] 46%|████▌     | 26350/57000 [00:08<00:10, 3052.50it/s] 47%|████▋     | 26656/57000 [00:08<00:09, 3053.54it/s] 47%|████▋     | 26963/57000 [00:08<00:09, 3056.40it/s] 48%|████▊     | 27269/57000 [00:08<00:09, 3052.47it/s] 48%|████▊     | 27576/57000 [00:09<00:09, 3055.14it/s] 49%|████▉     | 27882/57000 [00:09<00:09, 3054.54it/s] 49%|████▉     | 28188/57000 [00:09<00:09, 3040.85it/s] 50%|████▉     | 28494/57000 [00:09<00:09, 3044.17it/s] 51%|█████     | 28800/57000 [00:09<00:09, 3047.49it/s] 51%|█████     | 29106/57000 [00:09<00:09, 3050.13it/s] 52%|█████▏    | 29412/57000 [00:09<00:09, 3048.50it/s] 52%|█████▏    | 29718/57000 [00:09<00:08, 3049.59it/s] 53%|█████▎    | 30025/57000 [00:09<00:08, 3053.08it/s] 53%|█████▎    | 30331/57000 [00:09<00:08, 3052.88it/s] 54%|█████▎    | 30637/57000 [00:10<00:08, 3046.55it/s] 54%|█████▍    | 30942/57000 [00:10<00:08, 3035.75it/s] 55%|█████▍    | 31246/57000 [00:10<00:08, 3032.02it/s] 55%|█████▌    | 31550/57000 [00:10<00:08, 3029.87it/s] 56%|█████▌    | 31853/57000 [00:10<00:08, 3023.71it/s] 56%|█████▋    | 32160/57000 [00:10<00:08, 3035.95it/s] 57%|█████▋    | 32466/57000 [00:10<00:08, 3041.86it/s] 57%|█████▋    | 32773/57000 [00:10<00:07, 3047.71it/s] 58%|█████▊    | 33078/57000 [00:10<00:07, 3045.28it/s] 59%|█████▊    | 33383/57000 [00:10<00:07, 3042.76it/s] 59%|█████▉    | 33688/57000 [00:11<00:07, 3043.75it/s] 60%|█████▉    | 33993/57000 [00:11<00:07, 3044.14it/s] 60%|██████    | 34300/57000 [00:11<00:07, 3049.03it/s] 61%|██████    | 34606/57000 [00:11<00:07, 3050.89it/s] 61%|██████▏   | 34913/57000 [00:11<00:07, 3053.97it/s] 62%|██████▏   | 35220/57000 [00:11<00:07, 3057.55it/s] 62%|██████▏   | 35526/57000 [00:11<00:07, 3052.94it/s] 63%|██████▎   | 35832/57000 [00:11<00:06, 3051.28it/s] 63%|██████▎   | 36139/57000 [00:11<00:06, 3054.76it/s] 64%|██████▍   | 36445/57000 [00:11<00:06, 3055.87it/s] 64%|██████▍   | 36751/57000 [00:12<00:06, 3047.20it/s] 65%|██████▌   | 37057/57000 [00:12<00:06, 3049.02it/s] 66%|██████▌   | 37363/57000 [00:12<00:06, 3049.88it/s] 66%|██████▌   | 37668/57000 [00:12<00:06, 3049.03it/s] 67%|██████▋   | 37975/57000 [00:12<00:06, 3052.56it/s] 67%|██████▋   | 38281/57000 [00:12<00:06, 3054.59it/s] 68%|██████▊   | 38588/57000 [00:12<00:06, 3056.33it/s] 68%|██████▊   | 38894/57000 [00:12<00:05, 3057.34it/s] 69%|██████▉   | 39201/57000 [00:12<00:05, 3058.30it/s] 69%|██████▉   | 39507/57000 [00:12<00:05, 3058.28it/s] 70%|██████▉   | 39813/57000 [00:13<00:05, 3048.99it/s] 70%|███████   | 40119/57000 [00:13<00:05, 3049.73it/s] 71%|███████   | 40424/57000 [00:13<00:05, 3041.67it/s] 71%|███████▏  | 40731/57000 [00:13<00:05, 3048.08it/s] 72%|███████▏  | 41038/57000 [00:13<00:05, 3054.10it/s] 73%|███████▎  | 41344/57000 [00:13<00:05, 3053.90it/s] 73%|███████▎  | 41650/57000 [00:13<00:05, 3055.41it/s] 74%|███████▎  | 41956/57000 [00:13<00:04, 3055.42it/s] 74%|███████▍  | 42262/57000 [00:13<00:04, 3055.56it/s] 75%|███████▍  | 42568/57000 [00:13<00:04, 3053.14it/s] 75%|███████▌  | 42874/57000 [00:14<00:04, 3041.93it/s] 76%|███████▌  | 43180/57000 [00:14<00:04, 3046.39it/s] 76%|███████▋  | 43485/57000 [00:14<00:04, 3047.00it/s] 77%|███████▋  | 43791/57000 [00:14<00:04, 3050.72it/s] 77%|███████▋  | 44097/57000 [00:14<00:04, 3048.31it/s] 78%|███████▊  | 44403/57000 [00:14<00:04, 3050.99it/s] 78%|███████▊  | 44709/57000 [00:14<00:04, 3053.34it/s] 79%|███████▉  | 45015/57000 [00:14<00:03, 3049.29it/s] 80%|███████▉  | 45320/57000 [00:14<00:03, 3045.14it/s] 80%|████████  | 45625/57000 [00:14<00:03, 3044.33it/s] 81%|████████  | 45932/57000 [00:15<00:03, 3049.45it/s] 81%|████████  | 46237/57000 [00:15<00:03, 3048.96it/s] 82%|████████▏ | 46542/57000 [00:15<00:03, 3037.18it/s] 82%|████████▏ | 46847/57000 [00:15<00:03, 3040.93it/s] 83%|████████▎ | 47152/57000 [00:15<00:03, 3037.87it/s] 83%|████████▎ | 47459/57000 [00:15<00:03, 3045.84it/s] 84%|████████▍ | 47765/57000 [00:15<00:03, 3048.22it/s] 84%|████████▍ | 48071/57000 [00:15<00:02, 3050.43it/s] 85%|████████▍ | 48377/57000 [00:15<00:02, 3052.73it/s] 85%|████████▌ | 48683/57000 [00:15<00:02, 3047.49it/s] 86%|████████▌ | 48988/57000 [00:16<00:02, 3044.75it/s] 86%|████████▋ | 49293/57000 [00:16<00:02, 3043.21it/s] 87%|████████▋ | 49599/57000 [00:16<00:02, 3045.43it/s] 88%|████████▊ | 49905/57000 [00:16<00:02, 3048.30it/s] 88%|████████▊ | 50211/57000 [00:16<00:02, 3049.33it/s] 89%|████████▊ | 50517/57000 [00:16<00:02, 3051.83it/s] 89%|████████▉ | 50823/57000 [00:16<00:02, 3040.18it/s] 90%|████████▉ | 51130/57000 [00:16<00:01, 3048.13it/s] 90%|█████████ | 51437/57000 [00:16<00:01, 3051.74it/s] 91%|█████████ | 51744/57000 [00:16<00:01, 3056.24it/s] 91%|█████████▏| 52051/57000 [00:17<00:01, 3057.62it/s] 92%|█████████▏| 52357/57000 [00:17<00:01, 3055.83it/s] 92%|█████████▏| 52664/57000 [00:17<00:01, 3057.21it/s] 93%|█████████▎| 52970/57000 [00:17<00:01, 3054.97it/s] 93%|█████████▎| 53277/57000 [00:17<00:01, 3056.62it/s] 94%|█████████▍| 53583/57000 [00:17<00:01, 3056.66it/s] 95%|█████████▍| 53890/57000 [00:17<00:01, 3059.01it/s] 95%|█████████▌| 54197/57000 [00:17<00:00, 3060.37it/s] 96%|█████████▌| 54504/57000 [00:17<00:00, 3054.87it/s] 96%|█████████▌| 54810/57000 [00:17<00:00, 3053.02it/s] 97%|█████████▋| 55116/57000 [00:18<00:00, 3044.31it/s] 97%|█████████▋| 55423/57000 [00:18<00:00, 3049.49it/s] 98%|█████████▊| 55729/57000 [00:18<00:00, 3051.89it/s] 98%|█████████▊| 56035/57000 [00:18<00:00, 3053.01it/s] 99%|█████████▉| 56342/57000 [00:18<00:00, 3055.11it/s] 99%|█████████▉| 56648/57000 [00:18<00:00, 3055.25it/s]100%|█████████▉| 56954/57000 [00:18<00:00, 3056.34it/s]100%|██████████| 57000/57000 [00:18<00:00, 3051.67it/s]
2022-05-22 15:34:05 - loading data from datasets/KMNIST_3000/valid.json
  0%|          | 0/3000 [00:00<?, ?it/s] 10%|█         | 305/3000 [00:00<00:00, 3043.38it/s] 20%|██        | 610/3000 [00:00<00:00, 3041.19it/s] 30%|███       | 915/3000 [00:00<00:00, 3036.68it/s] 41%|████      | 1219/3000 [00:00<00:00, 3037.44it/s] 51%|█████     | 1524/3000 [00:00<00:00, 3041.83it/s] 61%|██████    | 1830/3000 [00:00<00:00, 3047.60it/s] 71%|███████   | 2136/3000 [00:00<00:00, 3050.10it/s] 81%|████████▏ | 2443/3000 [00:00<00:00, 3053.48it/s] 92%|█████████▏| 2749/3000 [00:00<00:00, 3055.14it/s]100%|██████████| 3000/3000 [00:00<00:00, 3048.26it/s]
2022-05-22 15:34:06 - loading data from datasets/KMNIST_3000/test.json
  0%|          | 0/10000 [00:00<?, ?it/s]  3%|▎         | 305/10000 [00:00<00:03, 3044.28it/s]  6%|▌         | 610/10000 [00:00<00:03, 3045.70it/s]  9%|▉         | 915/10000 [00:00<00:02, 3041.32it/s] 12%|█▏        | 1221/10000 [00:00<00:02, 3044.89it/s] 15%|█▌        | 1527/10000 [00:00<00:02, 3048.68it/s] 18%|█▊        | 1832/10000 [00:00<00:02, 3048.20it/s] 21%|██▏       | 2138/10000 [00:00<00:02, 3049.59it/s] 24%|██▍       | 2444/10000 [00:00<00:02, 3050.46it/s] 28%|██▊       | 2750/10000 [00:00<00:02, 3050.21it/s] 31%|███       | 3056/10000 [00:01<00:02, 3050.92it/s] 34%|███▎      | 3362/10000 [00:01<00:02, 3049.81it/s] 37%|███▋      | 3667/10000 [00:01<00:02, 3048.46it/s] 40%|███▉      | 3972/10000 [00:01<00:01, 3045.03it/s] 43%|████▎     | 4277/10000 [00:01<00:01, 3045.25it/s] 46%|████▌     | 4582/10000 [00:01<00:01, 3045.64it/s] 49%|████▉     | 4887/10000 [00:01<00:01, 3038.19it/s] 52%|█████▏    | 5192/10000 [00:01<00:01, 3041.70it/s] 55%|█████▍    | 5497/10000 [00:01<00:01, 3043.44it/s] 58%|█████▊    | 5802/10000 [00:01<00:01, 3045.35it/s] 61%|██████    | 6107/10000 [00:02<00:01, 3045.89it/s] 64%|██████▍   | 6412/10000 [00:02<00:01, 3045.59it/s] 67%|██████▋   | 6717/10000 [00:02<00:01, 3046.61it/s] 70%|███████   | 7022/10000 [00:02<00:00, 3042.73it/s] 73%|███████▎  | 7327/10000 [00:02<00:00, 3042.65it/s] 76%|███████▋  | 7632/10000 [00:02<00:00, 3043.13it/s] 79%|███████▉  | 7937/10000 [00:02<00:00, 3045.06it/s] 82%|████████▏ | 8243/10000 [00:02<00:00, 3047.68it/s] 85%|████████▌ | 8549/10000 [00:02<00:00, 3048.64it/s] 89%|████████▊ | 8855/10000 [00:02<00:00, 3049.36it/s] 92%|█████████▏| 9161/10000 [00:03<00:00, 3050.56it/s] 95%|█████████▍| 9467/10000 [00:03<00:00, 3046.79it/s] 98%|█████████▊| 9772/10000 [00:03<00:00, 3041.79it/s]100%|██████████| 10000/10000 [00:03<00:00, 3045.62it/s]
2022-05-22 15:34:14 - Using LF classes: [functools.partial(<class 'sklearn.tree._classes.DecisionTreeClassifier'>, max_depth=1), <class 'sklearn.linear_model._logistic.LogisticRegression'>]
Fitting MulticlassAdaptor... Class 0
  0%|          | 0/23 [00:00<?, ?it/s]  0%|          | 0/23 [2:18:35<?, ?it/s]
Traceback (most recent call last):
  File "fwrench/applications/kmnist.py", line 213, in <module>
    fire.Fire(main)
  File "/home/ubuntu/anaconda3/envs/FWRENCH/lib/python3.7/site-packages/fire/core.py", line 141, in Fire
    component_trace = _Fire(component, args, parsed_flag_args, context, name)
  File "/home/ubuntu/anaconda3/envs/FWRENCH/lib/python3.7/site-packages/fire/core.py", line 471, in _Fire
    target=component.__name__)
  File "/home/ubuntu/anaconda3/envs/FWRENCH/lib/python3.7/site-packages/fire/core.py", line 681, in _CallAndUpdateTrace
    component = fn(*varargs, **kwargs)
  File "fwrench/applications/kmnist.py", line 157, in main
    selector.fit(valid_data_embed, train_data_embed)
  File "/home/ubuntu/FWRENCH/fwrench/utils/utils.py", line 132, in fit
    self.lf_selectors[i].fit(labeled_data_i, unlabeled_data_i)
  File "/home/ubuntu/FWRENCH/fwrench/lf_selectors/snuba_lf_selector.py", line 57, in fit
    model=self.lf_generator, scoring_fn=self.scoring_fn)
  File "/home/ubuntu/FWRENCH/fwrench/lf_selectors/snuba/heuristic_generator.py", line 152, in run_synthesizer
    scoring_fn=scoring_fn)
  File "/home/ubuntu/FWRENCH/fwrench/lf_selectors/snuba/heuristic_generator.py", line 81, in prune_heuristics
    L_temp_train = self.apply_heuristics(heuristics[i], self.train_primitive_matrix, feat_combos[i], beta_opt_temp) 
  File "/home/ubuntu/FWRENCH/fwrench/lf_selectors/snuba/heuristic_generator.py", line 53, in apply_heuristics
    L = np.zeros((np.shape(primitive_matrix)[0],len(heuristics)))
numpy.core._exceptions.MemoryError: Unable to allocate 261. GiB for an array with shape (57000, 613872) and data type float64
