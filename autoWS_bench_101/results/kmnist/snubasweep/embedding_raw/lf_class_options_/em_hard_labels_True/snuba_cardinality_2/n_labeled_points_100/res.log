2022-05-22 05:15:39 - loading data from datasets/KMNIST_3000/train.json
  0%|          | 0/57000 [00:00<?, ?it/s]  1%|          | 305/57000 [00:00<00:18, 3048.82it/s]  1%|          | 611/57000 [00:00<00:18, 3054.77it/s]  2%|▏         | 919/57000 [00:00<00:18, 3061.72it/s]  2%|▏         | 1226/57000 [00:00<00:18, 3060.42it/s]  3%|▎         | 1533/57000 [00:00<00:18, 3060.16it/s]  3%|▎         | 1840/57000 [00:00<00:18, 3060.33it/s]  4%|▍         | 2148/57000 [00:00<00:17, 3066.17it/s]  4%|▍         | 2455/57000 [00:00<00:17, 3065.16it/s]  5%|▍         | 2763/57000 [00:00<00:17, 3067.23it/s]  5%|▌         | 3070/57000 [00:01<00:17, 3064.79it/s]  6%|▌         | 3377/57000 [00:01<00:17, 3065.38it/s]  6%|▋         | 3685/57000 [00:01<00:17, 3068.76it/s]  7%|▋         | 3992/57000 [00:01<00:17, 3064.71it/s]  8%|▊         | 4300/57000 [00:01<00:17, 3068.19it/s]  8%|▊         | 4607/57000 [00:01<00:17, 3067.72it/s]  9%|▊         | 4914/57000 [00:01<00:16, 3068.15it/s]  9%|▉         | 5221/57000 [00:01<00:16, 3067.85it/s] 10%|▉         | 5529/57000 [00:01<00:16, 3070.11it/s] 10%|█         | 5837/57000 [00:01<00:16, 3071.04it/s] 11%|█         | 6145/57000 [00:02<00:16, 3064.39it/s] 11%|█▏        | 6453/57000 [00:02<00:16, 3067.52it/s] 12%|█▏        | 6760/57000 [00:02<00:16, 3066.80it/s] 12%|█▏        | 7067/57000 [00:02<00:16, 3064.53it/s] 13%|█▎        | 7374/57000 [00:02<00:16, 3063.25it/s] 13%|█▎        | 7681/57000 [00:02<00:16, 3063.13it/s] 14%|█▍        | 7989/57000 [00:02<00:15, 3065.76it/s] 15%|█▍        | 8297/57000 [00:02<00:15, 3068.40it/s] 15%|█▌        | 8605/57000 [00:02<00:15, 3070.06it/s] 16%|█▌        | 8913/57000 [00:02<00:15, 3069.75it/s] 16%|█▌        | 9222/57000 [00:03<00:15, 3073.09it/s] 17%|█▋        | 9530/57000 [00:03<00:15, 3071.96it/s] 17%|█▋        | 9838/57000 [00:03<00:15, 3063.56it/s] 18%|█▊        | 10146/57000 [00:03<00:15, 3068.24it/s] 18%|█▊        | 10453/57000 [00:03<00:15, 3067.24it/s] 19%|█▉        | 10761/57000 [00:03<00:15, 3068.77it/s] 19%|█▉        | 11068/57000 [00:03<00:14, 3065.71it/s] 20%|█▉        | 11375/57000 [00:03<00:14, 3065.77it/s] 20%|██        | 11683/57000 [00:03<00:14, 3068.95it/s] 21%|██        | 11990/57000 [00:03<00:14, 3061.80it/s] 22%|██▏       | 12298/57000 [00:04<00:14, 3064.77it/s] 22%|██▏       | 12605/57000 [00:04<00:14, 3061.94it/s] 23%|██▎       | 12912/57000 [00:04<00:14, 3055.98it/s] 23%|██▎       | 13220/57000 [00:04<00:14, 3061.85it/s] 24%|██▎       | 13527/57000 [00:04<00:14, 3061.08it/s] 24%|██▍       | 13834/57000 [00:04<00:14, 3063.72it/s] 25%|██▍       | 14141/57000 [00:04<00:14, 3061.19it/s] 25%|██▌       | 14449/57000 [00:04<00:13, 3065.70it/s] 26%|██▌       | 14756/57000 [00:04<00:13, 3064.88it/s] 26%|██▋       | 15064/57000 [00:04<00:13, 3067.81it/s] 27%|██▋       | 15372/57000 [00:05<00:13, 3069.03it/s] 28%|██▊       | 15679/57000 [00:05<00:13, 3056.51it/s] 28%|██▊       | 15986/57000 [00:05<00:13, 3058.90it/s] 29%|██▊       | 16293/57000 [00:05<00:13, 3060.58it/s] 29%|██▉       | 16601/57000 [00:05<00:13, 3064.72it/s] 30%|██▉       | 16909/57000 [00:05<00:13, 3066.66it/s] 30%|███       | 17216/57000 [00:05<00:12, 3066.13it/s] 31%|███       | 17524/57000 [00:05<00:12, 3069.75it/s] 31%|███▏      | 17831/57000 [00:05<00:12, 3066.71it/s] 32%|███▏      | 18139/57000 [00:05<00:12, 3069.89it/s] 32%|███▏      | 18446/57000 [00:06<00:12, 3065.82it/s] 33%|███▎      | 18753/57000 [00:06<00:12, 3065.39it/s] 33%|███▎      | 19060/57000 [00:06<00:12, 3066.11it/s] 34%|███▍      | 19367/57000 [00:06<00:12, 3065.50it/s] 35%|███▍      | 19675/57000 [00:06<00:12, 3067.20it/s] 35%|███▌      | 19982/57000 [00:06<00:12, 3062.66it/s] 36%|███▌      | 20290/57000 [00:06<00:11, 3066.24it/s] 36%|███▌      | 20597/57000 [00:06<00:11, 3062.67it/s] 37%|███▋      | 20904/57000 [00:06<00:11, 3060.13it/s] 37%|███▋      | 21211/57000 [00:06<00:11, 3056.93it/s] 38%|███▊      | 21517/57000 [00:07<00:11, 3056.31it/s] 38%|███▊      | 21824/57000 [00:07<00:11, 3058.90it/s] 39%|███▉      | 22131/57000 [00:07<00:11, 3059.77it/s] 39%|███▉      | 22438/57000 [00:07<00:11, 3059.92it/s] 40%|███▉      | 22746/57000 [00:07<00:11, 3065.00it/s] 40%|████      | 23053/57000 [00:07<00:11, 3063.17it/s] 41%|████      | 23360/57000 [00:07<00:10, 3063.39it/s] 42%|████▏     | 23667/57000 [00:07<00:10, 3065.10it/s] 42%|████▏     | 23974/57000 [00:07<00:10, 3064.94it/s] 43%|████▎     | 24281/57000 [00:07<00:10, 3063.16it/s] 43%|████▎     | 24589/57000 [00:08<00:10, 3066.20it/s] 44%|████▎     | 24896/57000 [00:08<00:10, 3065.73it/s] 44%|████▍     | 25203/57000 [00:08<00:10, 3057.67it/s] 45%|████▍     | 25511/57000 [00:08<00:10, 3062.58it/s] 45%|████▌     | 25818/57000 [00:08<00:10, 3063.53it/s] 46%|████▌     | 26126/57000 [00:08<00:10, 3065.69it/s] 46%|████▋     | 26433/57000 [00:08<00:09, 3064.09it/s] 47%|████▋     | 26740/57000 [00:08<00:09, 3064.76it/s] 47%|████▋     | 27047/57000 [00:08<00:09, 3062.65it/s] 48%|████▊     | 27354/57000 [00:08<00:09, 3057.15it/s] 49%|████▊     | 27661/57000 [00:09<00:09, 3060.26it/s] 49%|████▉     | 27968/57000 [00:09<00:09, 3059.94it/s] 50%|████▉     | 28274/57000 [00:09<00:09, 3057.40it/s] 50%|█████     | 28582/57000 [00:09<00:09, 3063.92it/s] 51%|█████     | 28889/57000 [00:09<00:09, 3061.48it/s] 51%|█████     | 29196/57000 [00:09<00:09, 3063.12it/s] 52%|█████▏    | 29503/57000 [00:09<00:09, 3047.85it/s] 52%|█████▏    | 29808/57000 [00:09<00:08, 3046.01it/s] 53%|█████▎    | 30115/57000 [00:09<00:08, 3051.69it/s] 53%|█████▎    | 30421/57000 [00:09<00:08, 3053.20it/s] 54%|█████▍    | 30727/57000 [00:10<00:08, 3048.08it/s] 54%|█████▍    | 31032/57000 [00:10<00:08, 3044.67it/s] 55%|█████▍    | 31339/57000 [00:10<00:08, 3050.84it/s] 56%|█████▌    | 31646/57000 [00:10<00:08, 3055.57it/s] 56%|█████▌    | 31952/57000 [00:10<00:08, 3055.06it/s] 57%|█████▋    | 32260/57000 [00:10<00:08, 3059.49it/s] 57%|█████▋    | 32566/57000 [00:10<00:07, 3054.44it/s] 58%|█████▊    | 32873/57000 [00:10<00:07, 3058.96it/s] 58%|█████▊    | 33179/57000 [00:10<00:07, 3048.12it/s] 59%|█████▊    | 33486/57000 [00:10<00:07, 3052.47it/s] 59%|█████▉    | 33792/57000 [00:11<00:07, 3053.32it/s] 60%|█████▉    | 34099/57000 [00:11<00:07, 3055.48it/s] 60%|██████    | 34406/57000 [00:11<00:07, 3059.70it/s] 61%|██████    | 34712/57000 [00:11<00:07, 3058.80it/s] 61%|██████▏   | 35019/57000 [00:11<00:07, 3060.40it/s] 62%|██████▏   | 35326/57000 [00:11<00:07, 3059.09it/s] 63%|██████▎   | 35633/57000 [00:11<00:06, 3059.35it/s] 63%|██████▎   | 35939/57000 [00:11<00:06, 3056.21it/s] 64%|██████▎   | 36245/57000 [00:11<00:06, 3056.80it/s] 64%|██████▍   | 36551/57000 [00:11<00:06, 3051.14it/s] 65%|██████▍   | 36857/57000 [00:12<00:06, 3049.48it/s] 65%|██████▌   | 37162/57000 [00:12<00:06, 3047.38it/s] 66%|██████▌   | 37467/57000 [00:12<00:06, 3046.06it/s] 66%|██████▋   | 37774/57000 [00:12<00:06, 3052.53it/s] 67%|██████▋   | 38081/57000 [00:12<00:06, 3056.77it/s] 67%|██████▋   | 38387/57000 [00:12<00:06, 3055.13it/s] 68%|██████▊   | 38694/57000 [00:12<00:05, 3059.15it/s] 68%|██████▊   | 39000/57000 [00:12<00:05, 3058.88it/s] 69%|██████▉   | 39306/57000 [00:12<00:05, 3057.84it/s] 69%|██████▉   | 39613/57000 [00:12<00:05, 3059.65it/s] 70%|███████   | 39919/57000 [00:13<00:05, 3055.52it/s] 71%|███████   | 40225/57000 [00:13<00:05, 3053.20it/s] 71%|███████   | 40533/57000 [00:13<00:05, 3059.06it/s] 72%|███████▏  | 40841/57000 [00:13<00:05, 3065.14it/s] 72%|███████▏  | 41148/57000 [00:13<00:05, 3065.81it/s] 73%|███████▎  | 41455/57000 [00:13<00:05, 3066.63it/s] 73%|███████▎  | 41762/57000 [00:13<00:04, 3061.98it/s] 74%|███████▍  | 42069/57000 [00:13<00:04, 3058.74it/s] 74%|███████▍  | 42377/57000 [00:13<00:04, 3062.50it/s] 75%|███████▍  | 42684/57000 [00:13<00:04, 3063.60it/s] 75%|███████▌  | 42991/57000 [00:14<00:04, 3065.28it/s] 76%|███████▌  | 43298/57000 [00:14<00:04, 3066.65it/s] 76%|███████▋  | 43605/57000 [00:14<00:04, 3065.33it/s] 77%|███████▋  | 43913/57000 [00:14<00:04, 3067.00it/s] 78%|███████▊  | 44220/57000 [00:14<00:04, 3061.00it/s] 78%|███████▊  | 44527/57000 [00:14<00:04, 3052.39it/s] 79%|███████▊  | 44833/57000 [00:14<00:03, 3053.59it/s] 79%|███████▉  | 45140/57000 [00:14<00:03, 3056.05it/s] 80%|███████▉  | 45446/57000 [00:14<00:03, 3053.77it/s] 80%|████████  | 45753/57000 [00:14<00:03, 3057.97it/s] 81%|████████  | 46060/57000 [00:15<00:03, 3060.11it/s] 81%|████████▏ | 46367/57000 [00:15<00:03, 3058.13it/s] 82%|████████▏ | 46675/57000 [00:15<00:03, 3062.39it/s] 82%|████████▏ | 46982/57000 [00:15<00:03, 3062.00it/s] 83%|████████▎ | 47289/57000 [00:15<00:03, 3057.75it/s] 84%|████████▎ | 47596/57000 [00:15<00:03, 3060.02it/s] 84%|████████▍ | 47903/57000 [00:15<00:02, 3060.20it/s] 85%|████████▍ | 48211/57000 [00:15<00:02, 3063.88it/s] 85%|████████▌ | 48518/57000 [00:15<00:02, 3057.82it/s] 86%|████████▌ | 48826/57000 [00:15<00:02, 3061.97it/s] 86%|████████▌ | 49133/57000 [00:16<00:02, 3063.87it/s] 87%|████████▋ | 49440/57000 [00:16<00:02, 3064.31it/s] 87%|████████▋ | 49747/57000 [00:16<00:02, 3064.73it/s] 88%|████████▊ | 50054/57000 [00:16<00:02, 3058.46it/s] 88%|████████▊ | 50362/57000 [00:16<00:02, 3063.12it/s] 89%|████████▉ | 50669/57000 [00:16<00:02, 3060.22it/s] 89%|████████▉ | 50976/57000 [00:16<00:01, 3052.30it/s] 90%|████████▉ | 51284/57000 [00:16<00:01, 3060.41it/s] 91%|█████████ | 51592/57000 [00:16<00:01, 3064.73it/s] 91%|█████████ | 51900/57000 [00:16<00:01, 3069.24it/s] 92%|█████████▏| 52207/57000 [00:17<00:01, 3064.63it/s] 92%|█████████▏| 52514/57000 [00:17<00:01, 3064.22it/s] 93%|█████████▎| 52822/57000 [00:17<00:01, 3065.88it/s] 93%|█████████▎| 53129/57000 [00:17<00:01, 3059.81it/s] 94%|█████████▎| 53436/57000 [00:17<00:01, 3061.14it/s] 94%|█████████▍| 53743/57000 [00:17<00:01, 3060.11it/s] 95%|█████████▍| 54050/57000 [00:17<00:00, 3060.44it/s] 95%|█████████▌| 54357/57000 [00:17<00:00, 3056.24it/s] 96%|█████████▌| 54664/57000 [00:17<00:00, 3060.01it/s] 96%|█████████▋| 54971/57000 [00:17<00:00, 3062.24it/s] 97%|█████████▋| 55278/57000 [00:18<00:00, 3062.52it/s] 98%|█████████▊| 55585/57000 [00:18<00:00, 3063.43it/s] 98%|█████████▊| 55892/57000 [00:18<00:00, 3057.20it/s] 99%|█████████▊| 56198/57000 [00:18<00:00, 3054.79it/s] 99%|█████████▉| 56504/57000 [00:18<00:00, 3052.52it/s]100%|█████████▉| 56811/57000 [00:18<00:00, 3056.97it/s]100%|██████████| 57000/57000 [00:18<00:00, 3061.18it/s]
2022-05-22 05:15:57 - loading data from datasets/KMNIST_3000/valid.json
  0%|          | 0/3000 [00:00<?, ?it/s] 10%|█         | 306/3000 [00:00<00:00, 3057.31it/s] 20%|██        | 614/3000 [00:00<00:00, 3068.50it/s] 31%|███       | 922/3000 [00:00<00:00, 3071.92it/s] 41%|████      | 1230/3000 [00:00<00:00, 3068.63it/s] 51%|█████     | 1537/3000 [00:00<00:00, 3063.86it/s] 61%|██████▏   | 1844/3000 [00:00<00:00, 3063.18it/s] 72%|███████▏  | 2151/3000 [00:00<00:00, 3053.31it/s] 82%|████████▏ | 2457/3000 [00:00<00:00, 3055.15it/s] 92%|█████████▏| 2764/3000 [00:00<00:00, 3056.69it/s]100%|██████████| 3000/3000 [00:00<00:00, 3059.36it/s]
2022-05-22 05:15:58 - loading data from datasets/KMNIST_3000/test.json
  0%|          | 0/10000 [00:00<?, ?it/s]  3%|▎         | 306/10000 [00:00<00:03, 3055.06it/s]  6%|▌         | 613/10000 [00:00<00:03, 3060.36it/s]  9%|▉         | 921/10000 [00:00<00:02, 3065.37it/s] 12%|█▏        | 1228/10000 [00:00<00:02, 3065.58it/s] 15%|█▌        | 1535/10000 [00:00<00:02, 3059.63it/s] 18%|█▊        | 1842/10000 [00:00<00:02, 3060.57it/s] 21%|██▏       | 2149/10000 [00:00<00:02, 3062.14it/s] 25%|██▍       | 2456/10000 [00:00<00:02, 3064.22it/s] 28%|██▊       | 2763/10000 [00:00<00:02, 3062.43it/s] 31%|███       | 3070/10000 [00:01<00:02, 3058.22it/s] 34%|███▍      | 3376/10000 [00:01<00:02, 3055.58it/s] 37%|███▋      | 3682/10000 [00:01<00:02, 3047.20it/s] 40%|███▉      | 3987/10000 [00:01<00:01, 3047.84it/s] 43%|████▎     | 4293/10000 [00:01<00:01, 3049.16it/s] 46%|████▌     | 4599/10000 [00:01<00:01, 3049.79it/s] 49%|████▉     | 4905/10000 [00:01<00:01, 3052.54it/s] 52%|█████▏    | 5212/10000 [00:01<00:01, 3054.92it/s] 55%|█████▌    | 5518/10000 [00:01<00:01, 3056.24it/s] 58%|█████▊    | 5824/10000 [00:01<00:01, 3056.19it/s] 61%|██████▏   | 6131/10000 [00:02<00:01, 3057.49it/s] 64%|██████▍   | 6438/10000 [00:02<00:01, 3058.22it/s] 67%|██████▋   | 6744/10000 [00:02<00:01, 3050.36it/s] 70%|███████   | 7050/10000 [00:02<00:00, 3052.08it/s] 74%|███████▎  | 7356/10000 [00:02<00:00, 3052.69it/s] 77%|███████▋  | 7662/10000 [00:02<00:00, 3052.65it/s] 80%|███████▉  | 7968/10000 [00:02<00:00, 3054.09it/s] 83%|████████▎ | 8275/10000 [00:02<00:00, 3056.12it/s] 86%|████████▌ | 8582/10000 [00:02<00:00, 3057.46it/s] 89%|████████▉ | 8888/10000 [00:02<00:00, 3054.51it/s] 92%|█████████▏| 9194/10000 [00:03<00:00, 3044.62it/s] 95%|█████████▌| 9500/10000 [00:03<00:00, 3047.89it/s] 98%|█████████▊| 9805/10000 [00:03<00:00, 3048.18it/s]100%|██████████| 10000/10000 [00:03<00:00, 3054.47it/s]
2022-05-22 05:16:07 - Using LF classes: [functools.partial(<class 'sklearn.tree._classes.DecisionTreeClassifier'>, max_depth=1), <class 'sklearn.linear_model._logistic.LogisticRegression'>]
Fitting MulticlassAdaptor... Class 0
  0%|          | 0/23 [00:00<?, ?it/s]  0%|          | 0/23 [2:17:47<?, ?it/s]
Traceback (most recent call last):
  File "fwrench/applications/kmnist.py", line 213, in <module>
    fire.Fire(main)
  File "/home/ubuntu/anaconda3/envs/FWRENCH/lib/python3.7/site-packages/fire/core.py", line 141, in Fire
    component_trace = _Fire(component, args, parsed_flag_args, context, name)
  File "/home/ubuntu/anaconda3/envs/FWRENCH/lib/python3.7/site-packages/fire/core.py", line 471, in _Fire
    target=component.__name__)
  File "/home/ubuntu/anaconda3/envs/FWRENCH/lib/python3.7/site-packages/fire/core.py", line 681, in _CallAndUpdateTrace
    component = fn(*varargs, **kwargs)
  File "fwrench/applications/kmnist.py", line 157, in main
    selector.fit(valid_data_embed, train_data_embed)
  File "/home/ubuntu/FWRENCH/fwrench/utils/utils.py", line 132, in fit
    self.lf_selectors[i].fit(labeled_data_i, unlabeled_data_i)
  File "/home/ubuntu/FWRENCH/fwrench/lf_selectors/snuba_lf_selector.py", line 57, in fit
    model=self.lf_generator, scoring_fn=self.scoring_fn)
  File "/home/ubuntu/FWRENCH/fwrench/lf_selectors/snuba/heuristic_generator.py", line 152, in run_synthesizer
    scoring_fn=scoring_fn)
  File "/home/ubuntu/FWRENCH/fwrench/lf_selectors/snuba/heuristic_generator.py", line 81, in prune_heuristics
    L_temp_train = self.apply_heuristics(heuristics[i], self.train_primitive_matrix, feat_combos[i], beta_opt_temp) 
  File "/home/ubuntu/FWRENCH/fwrench/lf_selectors/snuba/heuristic_generator.py", line 53, in apply_heuristics
    L = np.zeros((np.shape(primitive_matrix)[0],len(heuristics)))
numpy.core._exceptions.MemoryError: Unable to allocate 261. GiB for an array with shape (57000, 613872) and data type float64
