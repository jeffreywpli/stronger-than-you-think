2022-05-22 18:16:24 - loading data from datasets/FashionMNIST_3000/train.json
  0%|          | 0/57000 [00:00<?, ?it/s]  1%|          | 289/57000 [00:00<00:19, 2889.54it/s]  1%|          | 579/57000 [00:00<00:19, 2895.63it/s]  2%|▏         | 871/57000 [00:00<00:19, 2903.76it/s]  2%|▏         | 1162/57000 [00:00<00:19, 2903.08it/s]  3%|▎         | 1455/57000 [00:00<00:19, 2909.30it/s]  3%|▎         | 1747/57000 [00:00<00:18, 2910.99it/s]  4%|▎         | 2039/57000 [00:00<00:18, 2911.84it/s]  4%|▍         | 2331/57000 [00:00<00:18, 2909.36it/s]  5%|▍         | 2623/57000 [00:00<00:18, 2911.93it/s]  5%|▌         | 2915/57000 [00:01<00:18, 2912.95it/s]  6%|▌         | 3207/57000 [00:01<00:18, 2897.36it/s]  6%|▌         | 3499/57000 [00:01<00:18, 2902.10it/s]  7%|▋         | 3790/57000 [00:01<00:18, 2900.69it/s]  7%|▋         | 4082/57000 [00:01<00:18, 2904.61it/s]  8%|▊         | 4374/57000 [00:01<00:18, 2906.89it/s]  8%|▊         | 4666/57000 [00:01<00:17, 2908.54it/s]  9%|▊         | 4958/57000 [00:01<00:17, 2910.80it/s]  9%|▉         | 5250/57000 [00:01<00:17, 2906.30it/s] 10%|▉         | 5542/57000 [00:01<00:17, 2910.26it/s] 10%|█         | 5834/57000 [00:02<00:17, 2912.70it/s] 11%|█         | 6126/57000 [00:02<00:17, 2914.69it/s] 11%|█▏        | 6418/57000 [00:02<00:17, 2913.38it/s] 12%|█▏        | 6710/57000 [00:02<00:17, 2912.57it/s] 12%|█▏        | 7002/57000 [00:02<00:17, 2911.66it/s] 13%|█▎        | 7294/57000 [00:02<00:17, 2911.84it/s] 13%|█▎        | 7586/57000 [00:02<00:17, 2905.14it/s] 14%|█▍        | 7878/57000 [00:02<00:16, 2908.52it/s] 14%|█▍        | 8170/57000 [00:02<00:16, 2909.47it/s] 15%|█▍        | 8462/57000 [00:02<00:16, 2910.52it/s] 15%|█▌        | 8754/57000 [00:03<00:16, 2911.36it/s] 16%|█▌        | 9046/57000 [00:03<00:16, 2908.05it/s] 16%|█▋        | 9338/57000 [00:03<00:16, 2910.38it/s] 17%|█▋        | 9630/57000 [00:03<00:16, 2906.58it/s] 17%|█▋        | 9921/57000 [00:03<00:16, 2904.75it/s] 18%|█▊        | 10213/57000 [00:03<00:16, 2906.38it/s] 18%|█▊        | 10504/57000 [00:03<00:16, 2905.85it/s] 19%|█▉        | 10795/57000 [00:03<00:15, 2906.64it/s] 19%|█▉        | 11086/57000 [00:03<00:15, 2904.38it/s] 20%|█▉        | 11377/57000 [00:03<00:15, 2906.02it/s] 20%|██        | 11668/57000 [00:04<00:15, 2906.50it/s] 21%|██        | 11959/57000 [00:04<00:15, 2901.95it/s] 21%|██▏       | 12251/57000 [00:04<00:15, 2905.19it/s] 22%|██▏       | 12542/57000 [00:04<00:15, 2895.14it/s] 23%|██▎       | 12833/57000 [00:04<00:15, 2899.23it/s] 23%|██▎       | 13125/57000 [00:04<00:15, 2902.96it/s] 24%|██▎       | 13416/57000 [00:04<00:15, 2895.88it/s] 24%|██▍       | 13708/57000 [00:04<00:14, 2902.36it/s] 25%|██▍       | 13999/57000 [00:04<00:14, 2902.52it/s] 25%|██▌       | 14292/57000 [00:04<00:14, 2908.31it/s] 26%|██▌       | 14585/57000 [00:05<00:14, 2912.69it/s] 26%|██▌       | 14877/57000 [00:05<00:14, 2892.81it/s] 27%|██▋       | 15169/57000 [00:05<00:14, 2900.06it/s] 27%|██▋       | 15460/57000 [00:05<00:14, 2899.60it/s] 28%|██▊       | 15751/57000 [00:05<00:14, 2901.68it/s] 28%|██▊       | 16043/57000 [00:05<00:14, 2906.69it/s] 29%|██▊       | 16335/57000 [00:05<00:13, 2909.01it/s] 29%|██▉       | 16627/57000 [00:05<00:13, 2911.43it/s] 30%|██▉       | 16919/57000 [00:05<00:13, 2910.59it/s] 30%|███       | 17211/57000 [00:05<00:13, 2910.58it/s] 31%|███       | 17503/57000 [00:06<00:13, 2911.91it/s] 31%|███       | 17795/57000 [00:06<00:13, 2883.86it/s] 32%|███▏      | 18087/57000 [00:06<00:13, 2892.83it/s] 32%|███▏      | 18379/57000 [00:06<00:13, 2898.91it/s] 33%|███▎      | 18670/57000 [00:06<00:13, 2899.03it/s] 33%|███▎      | 18961/57000 [00:06<00:13, 2901.11it/s] 34%|███▍      | 19252/57000 [00:06<00:13, 2900.92it/s] 34%|███▍      | 19543/57000 [00:06<00:12, 2901.53it/s] 35%|███▍      | 19834/57000 [00:06<00:12, 2901.57it/s] 35%|███▌      | 20125/57000 [00:06<00:12, 2901.33it/s] 36%|███▌      | 20417/57000 [00:07<00:12, 2905.17it/s] 36%|███▋      | 20708/57000 [00:07<00:12, 2886.49it/s] 37%|███▋      | 20999/57000 [00:07<00:12, 2892.33it/s] 37%|███▋      | 21290/57000 [00:07<00:12, 2896.01it/s] 38%|███▊      | 21580/57000 [00:07<00:12, 2897.06it/s] 38%|███▊      | 21872/57000 [00:07<00:12, 2902.09it/s] 39%|███▉      | 22163/57000 [00:07<00:12, 2902.53it/s] 39%|███▉      | 22454/57000 [00:07<00:11, 2902.33it/s] 40%|███▉      | 22746/57000 [00:07<00:11, 2904.91it/s] 40%|████      | 23037/57000 [00:07<00:11, 2899.32it/s] 41%|████      | 23328/57000 [00:08<00:11, 2901.15it/s] 41%|████▏     | 23619/57000 [00:08<00:11, 2901.00it/s] 42%|████▏     | 23910/57000 [00:08<00:11, 2902.39it/s] 42%|████▏     | 24201/57000 [00:08<00:11, 2900.81it/s] 43%|████▎     | 24492/57000 [00:08<00:11, 2899.59it/s] 43%|████▎     | 24783/57000 [00:08<00:11, 2901.80it/s] 44%|████▍     | 25074/57000 [00:08<00:11, 2892.47it/s] 45%|████▍     | 25366/57000 [00:08<00:10, 2898.54it/s] 45%|████▌     | 25658/57000 [00:08<00:10, 2903.91it/s] 46%|████▌     | 25949/57000 [00:08<00:10, 2904.64it/s] 46%|████▌     | 26240/57000 [00:09<00:10, 2904.43it/s] 47%|████▋     | 26531/57000 [00:09<00:10, 2890.06it/s] 47%|████▋     | 26823/57000 [00:09<00:10, 2896.80it/s] 48%|████▊     | 27114/57000 [00:09<00:10, 2900.64it/s] 48%|████▊     | 27405/57000 [00:09<00:10, 2899.42it/s] 49%|████▊     | 27696/57000 [00:09<00:10, 2902.34it/s] 49%|████▉     | 27988/57000 [00:09<00:09, 2905.12it/s] 50%|████▉     | 28279/57000 [00:09<00:09, 2901.33it/s] 50%|█████     | 28571/57000 [00:09<00:09, 2906.23it/s] 51%|█████     | 28862/57000 [00:09<00:09, 2900.62it/s] 51%|█████     | 29153/57000 [00:10<00:09, 2900.71it/s] 52%|█████▏    | 29444/57000 [00:10<00:09, 2901.02it/s] 52%|█████▏    | 29735/57000 [00:10<00:09, 2903.43it/s] 53%|█████▎    | 30026/57000 [00:10<00:09, 2903.54it/s] 53%|█████▎    | 30317/57000 [00:10<00:09, 2898.79it/s] 54%|█████▎    | 30609/57000 [00:10<00:09, 2903.63it/s] 54%|█████▍    | 30900/57000 [00:10<00:08, 2900.10it/s] 55%|█████▍    | 31191/57000 [00:10<00:08, 2902.51it/s] 55%|█████▌    | 31482/57000 [00:10<00:08, 2904.52it/s] 56%|█████▌    | 31773/57000 [00:10<00:08, 2899.83it/s] 56%|█████▋    | 32065/57000 [00:11<00:08, 2904.75it/s] 57%|█████▋    | 32356/57000 [00:11<00:08, 2903.31it/s] 57%|█████▋    | 32647/57000 [00:11<00:08, 2904.77it/s] 58%|█████▊    | 32938/57000 [00:11<00:08, 2904.92it/s] 58%|█████▊    | 33229/57000 [00:11<00:08, 2898.46it/s] 59%|█████▉    | 33520/57000 [00:11<00:08, 2900.96it/s] 59%|█████▉    | 33811/57000 [00:11<00:08, 2894.05it/s] 60%|█████▉    | 34102/57000 [00:11<00:07, 2898.62it/s] 60%|██████    | 34393/57000 [00:11<00:07, 2899.74it/s] 61%|██████    | 34683/57000 [00:11<00:07, 2891.54it/s] 61%|██████▏   | 34975/57000 [00:12<00:07, 2898.09it/s] 62%|██████▏   | 35265/57000 [00:12<00:07, 2898.00it/s] 62%|██████▏   | 35555/57000 [00:12<00:07, 2898.56it/s] 63%|██████▎   | 35845/57000 [00:12<00:07, 2895.21it/s] 63%|██████▎   | 36135/57000 [00:12<00:07, 2888.78it/s] 64%|██████▍   | 36427/57000 [00:12<00:07, 2895.70it/s] 64%|██████▍   | 36717/57000 [00:12<00:07, 2895.25it/s] 65%|██████▍   | 37008/57000 [00:12<00:06, 2897.45it/s] 65%|██████▌   | 37298/57000 [00:12<00:06, 2898.16it/s] 66%|██████▌   | 37590/57000 [00:12<00:06, 2901.79it/s] 66%|██████▋   | 37881/57000 [00:13<00:06, 2902.11it/s] 67%|██████▋   | 38172/57000 [00:13<00:06, 2900.82it/s] 67%|██████▋   | 38463/57000 [00:13<00:06, 2899.88it/s] 68%|██████▊   | 38753/57000 [00:13<00:06, 2898.58it/s] 68%|██████▊   | 39043/57000 [00:13<00:06, 2886.12it/s] 69%|██████▉   | 39334/57000 [00:13<00:06, 2891.44it/s] 70%|██████▉   | 39625/57000 [00:13<00:05, 2896.34it/s] 70%|███████   | 39916/57000 [00:13<00:05, 2897.40it/s] 71%|███████   | 40206/57000 [00:13<00:05, 2894.70it/s] 71%|███████   | 40497/57000 [00:13<00:05, 2898.59it/s] 72%|███████▏  | 40788/57000 [00:14<00:05, 2901.69it/s] 72%|███████▏  | 41081/57000 [00:14<00:05, 2907.89it/s] 73%|███████▎  | 41372/57000 [00:14<00:05, 2903.11it/s] 73%|███████▎  | 41663/57000 [00:14<00:05, 2903.38it/s] 74%|███████▎  | 41954/57000 [00:14<00:05, 2892.85it/s] 74%|███████▍  | 42245/57000 [00:14<00:05, 2896.03it/s] 75%|███████▍  | 42536/57000 [00:14<00:04, 2900.13it/s] 75%|███████▌  | 42827/57000 [00:14<00:04, 2899.97it/s] 76%|███████▌  | 43118/57000 [00:14<00:04, 2902.80it/s] 76%|███████▌  | 43409/57000 [00:14<00:04, 2887.54it/s] 77%|███████▋  | 43701/57000 [00:15<00:04, 2894.87it/s] 77%|███████▋  | 43993/57000 [00:15<00:04, 2900.21it/s] 78%|███████▊  | 44284/57000 [00:15<00:04, 2895.42it/s] 78%|███████▊  | 44575/57000 [00:15<00:04, 2897.43it/s] 79%|███████▊  | 44866/57000 [00:15<00:04, 2898.70it/s] 79%|███████▉  | 45156/57000 [00:15<00:04, 2893.51it/s] 80%|███████▉  | 45448/57000 [00:15<00:03, 2899.23it/s] 80%|████████  | 45739/57000 [00:15<00:03, 2901.31it/s] 81%|████████  | 46031/57000 [00:15<00:03, 2904.18it/s] 81%|████████▏ | 46322/57000 [00:15<00:03, 2902.51it/s] 82%|████████▏ | 46614/57000 [00:16<00:03, 2904.68it/s] 82%|████████▏ | 46905/57000 [00:16<00:03, 2905.98it/s] 83%|████████▎ | 47196/57000 [00:16<00:03, 2905.11it/s] 83%|████████▎ | 47487/57000 [00:16<00:03, 2902.24it/s] 84%|████████▍ | 47778/57000 [00:16<00:03, 2895.74it/s] 84%|████████▍ | 48069/57000 [00:16<00:03, 2899.97it/s] 85%|████████▍ | 48360/57000 [00:16<00:02, 2902.08it/s] 85%|████████▌ | 48651/57000 [00:16<00:02, 2886.52it/s] 86%|████████▌ | 48942/57000 [00:16<00:02, 2892.50it/s] 86%|████████▋ | 49233/57000 [00:16<00:02, 2896.10it/s] 87%|████████▋ | 49524/57000 [00:17<00:02, 2897.66it/s] 87%|████████▋ | 49816/57000 [00:17<00:02, 2901.83it/s] 88%|████████▊ | 50107/57000 [00:17<00:02, 2895.57it/s] 88%|████████▊ | 50398/57000 [00:17<00:02, 2898.03it/s] 89%|████████▉ | 50688/57000 [00:17<00:02, 2895.87it/s] 89%|████████▉ | 50978/57000 [00:17<00:02, 2890.92it/s] 90%|████████▉ | 51270/57000 [00:17<00:01, 2898.76it/s] 90%|█████████ | 51560/57000 [00:17<00:01, 2898.55it/s] 91%|█████████ | 51852/57000 [00:17<00:01, 2904.15it/s] 91%|█████████▏| 52143/57000 [00:17<00:01, 2902.06it/s] 92%|█████████▏| 52434/57000 [00:18<00:01, 2904.27it/s] 93%|█████████▎| 52726/57000 [00:18<00:01, 2907.41it/s] 93%|█████████▎| 53017/57000 [00:18<00:01, 2888.66it/s] 94%|█████████▎| 53308/57000 [00:18<00:01, 2893.82it/s] 94%|█████████▍| 53598/57000 [00:18<00:01, 2887.38it/s] 95%|█████████▍| 53890/57000 [00:18<00:01, 2894.58it/s] 95%|█████████▌| 54182/57000 [00:18<00:00, 2900.58it/s] 96%|█████████▌| 54473/57000 [00:18<00:00, 2898.28it/s] 96%|█████████▌| 54765/57000 [00:18<00:00, 2903.01it/s] 97%|█████████▋| 55056/57000 [00:18<00:00, 2902.97it/s] 97%|█████████▋| 55348/57000 [00:19<00:00, 2906.34it/s] 98%|█████████▊| 55640/57000 [00:19<00:00, 2908.30it/s] 98%|█████████▊| 55931/57000 [00:19<00:00, 2904.68it/s] 99%|█████████▊| 56222/57000 [00:19<00:00, 2905.11it/s] 99%|█████████▉| 56513/57000 [00:19<00:00, 2895.40it/s]100%|█████████▉| 56805/57000 [00:19<00:00, 2900.12it/s]100%|██████████| 57000/57000 [00:19<00:00, 2901.31it/s]
2022-05-22 18:16:44 - loading data from datasets/FashionMNIST_3000/valid.json
  0%|          | 0/3000 [00:00<?, ?it/s] 10%|▉         | 290/3000 [00:00<00:00, 2899.17it/s] 19%|█▉        | 580/3000 [00:00<00:00, 2852.73it/s] 29%|██▉       | 868/3000 [00:00<00:00, 2862.30it/s] 39%|███▊      | 1160/3000 [00:00<00:00, 2882.77it/s] 48%|████▊     | 1452/3000 [00:00<00:00, 2893.49it/s] 58%|█████▊    | 1744/3000 [00:00<00:00, 2902.38it/s] 68%|██████▊   | 2036/3000 [00:00<00:00, 2905.69it/s] 78%|███████▊  | 2328/3000 [00:00<00:00, 2908.41it/s] 87%|████████▋ | 2620/3000 [00:00<00:00, 2909.74it/s] 97%|█████████▋| 2911/3000 [00:01<00:00, 2908.67it/s]100%|██████████| 3000/3000 [00:01<00:00, 2898.05it/s]
2022-05-22 18:16:45 - loading data from datasets/FashionMNIST_3000/test.json
  0%|          | 0/10000 [00:00<?, ?it/s]  3%|▎         | 291/10000 [00:00<00:03, 2904.01it/s]  6%|▌         | 582/10000 [00:00<00:03, 2905.93it/s]  9%|▊         | 873/10000 [00:00<00:03, 2907.61it/s] 12%|█▏        | 1165/10000 [00:00<00:03, 2908.99it/s] 15%|█▍        | 1456/10000 [00:00<00:02, 2909.05it/s] 17%|█▋        | 1748/10000 [00:00<00:02, 2910.47it/s] 20%|██        | 2040/10000 [00:00<00:02, 2908.52it/s] 23%|██▎       | 2331/10000 [00:00<00:02, 2907.31it/s] 26%|██▌       | 2622/10000 [00:00<00:02, 2906.14it/s] 29%|██▉       | 2913/10000 [00:01<00:02, 2904.28it/s] 32%|███▏      | 3204/10000 [00:01<00:02, 2904.71it/s] 35%|███▍      | 3495/10000 [00:01<00:02, 2904.01it/s] 38%|███▊      | 3786/10000 [00:01<00:02, 2903.36it/s] 41%|████      | 4077/10000 [00:01<00:02, 2903.79it/s] 44%|████▎     | 4368/10000 [00:01<00:01, 2902.29it/s] 47%|████▋     | 4659/10000 [00:01<00:01, 2901.67it/s] 50%|████▉     | 4950/10000 [00:01<00:01, 2901.13it/s] 52%|█████▏    | 5241/10000 [00:01<00:01, 2902.04it/s] 55%|█████▌    | 5532/10000 [00:01<00:01, 2902.61it/s] 58%|█████▊    | 5823/10000 [00:02<00:01, 2902.09it/s] 61%|██████    | 6114/10000 [00:02<00:01, 2902.18it/s] 64%|██████▍   | 6405/10000 [00:02<00:01, 2901.39it/s] 67%|██████▋   | 6696/10000 [00:02<00:01, 2901.93it/s] 70%|██████▉   | 6987/10000 [00:02<00:01, 2901.99it/s] 73%|███████▎  | 7278/10000 [00:02<00:00, 2902.33it/s] 76%|███████▌  | 7569/10000 [00:02<00:00, 2902.38it/s] 79%|███████▊  | 7860/10000 [00:02<00:00, 2899.26it/s] 82%|████████▏ | 8151/10000 [00:02<00:00, 2900.64it/s] 84%|████████▍ | 8442/10000 [00:02<00:00, 2901.68it/s] 87%|████████▋ | 8733/10000 [00:03<00:00, 2900.30it/s] 90%|█████████ | 9024/10000 [00:03<00:00, 2900.83it/s] 93%|█████████▎| 9315/10000 [00:03<00:00, 2902.83it/s] 96%|█████████▌| 9607/10000 [00:03<00:00, 2905.36it/s] 99%|█████████▉| 9898/10000 [00:03<00:00, 2903.35it/s]100%|██████████| 10000/10000 [00:03<00:00, 2903.38it/s]
2022-05-22 18:16:54 - Using LF classes: [functools.partial(<class 'sklearn.tree._classes.DecisionTreeClassifier'>, max_depth=1), <class 'sklearn.linear_model._logistic.LogisticRegression'>]
Fitting MulticlassAdaptor... Class 0
  0%|          | 0/23 [00:00<?, ?it/s]  0%|          | 0/23 [2:51:17<?, ?it/s]
Traceback (most recent call last):
  File "fwrench/applications/fashion_mnist.py", line 213, in <module>
    fire.Fire(main)
  File "/home/ubuntu/anaconda3/envs/FWRENCH/lib/python3.7/site-packages/fire/core.py", line 141, in Fire
    component_trace = _Fire(component, args, parsed_flag_args, context, name)
  File "/home/ubuntu/anaconda3/envs/FWRENCH/lib/python3.7/site-packages/fire/core.py", line 471, in _Fire
    target=component.__name__)
  File "/home/ubuntu/anaconda3/envs/FWRENCH/lib/python3.7/site-packages/fire/core.py", line 681, in _CallAndUpdateTrace
    component = fn(*varargs, **kwargs)
  File "fwrench/applications/fashion_mnist.py", line 157, in main
    selector.fit(valid_data_embed, train_data_embed)
  File "/home/ubuntu/FWRENCH/fwrench/utils/utils.py", line 132, in fit
    self.lf_selectors[i].fit(labeled_data_i, unlabeled_data_i)
  File "/home/ubuntu/FWRENCH/fwrench/lf_selectors/snuba_lf_selector.py", line 57, in fit
    model=self.lf_generator, scoring_fn=self.scoring_fn)
  File "/home/ubuntu/FWRENCH/fwrench/lf_selectors/snuba/heuristic_generator.py", line 152, in run_synthesizer
    scoring_fn=scoring_fn)
  File "/home/ubuntu/FWRENCH/fwrench/lf_selectors/snuba/heuristic_generator.py", line 81, in prune_heuristics
    L_temp_train = self.apply_heuristics(heuristics[i], self.train_primitive_matrix, feat_combos[i], beta_opt_temp) 
  File "/home/ubuntu/FWRENCH/fwrench/lf_selectors/snuba/heuristic_generator.py", line 53, in apply_heuristics
    L = np.zeros((np.shape(primitive_matrix)[0],len(heuristics)))
numpy.core._exceptions.MemoryError: Unable to allocate 261. GiB for an array with shape (57000, 613872) and data type float64
